/*! soon-ui 2021-11-07 */

!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("SOONUI requires a window with a document");return b(a)}:b(a,!0)}("undefined"!=typeof window?window:this,function(window,noGlobal){"use strict";function init_$(){$=ui.$}var ui={};noGlobal&&(window.ui=ui,window.SOONUI=ui);var $=ui.$=window.$;return ui.version="3.5.0",function(a,b){function c(a){return m.test(l.call(a))}a.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},a.core={};var d,e,f=a.core,g=document,h=/[^, ]+/g,i={},j=Object.prototype,k=j.hasOwnProperty,l=(window.dispatchEvent,g.documentElement,j.toString),m=(g.head||g.getElementsByTagName("head")[0],/^[\[]object (Window|DOMWindow|global)[\]]$/),n="Boolean Number String Function Array Date RegExp Object Error";f.global=function(){if("undefined"!=typeof self)return self;if(void 0!==window)return window;if("undefined"!=typeof global)return global;throw new TypeError("unable to locate global object")},f.each=function(a,b){a.replace(h,b)},f.each(n,function(a){i["[object "+a+"]"]=a.toLowerCase()}),f.type=function(a){return null===a?String(a):"object"==typeof a||"function"==typeof a?i[l.call(a)]||"object":typeof a},f.each(n,function(a){var b=a.toLowerCase();f["is"+a]=function(){return f.type.apply(f,arguments)===b}}),f.isNumber=function(a){var b=f.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},f.isNumeric=f.isNumber,f.isNull=function(a){var b=this.type(a);return"undefined"===b||"null"===b},f.isWindow=function(a){return!!a&&(a===window||a==a.document&&a.document!=a)},c(window)||(f.isWindow=c),f.isPlainObject=function(a){if("object"!==this.type(a)||a.nodeType||this.isWindow(a))return!1;try{if(a.constructor&&!k.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}return!0},/\[native code\]/.test(Object.getPrototypeOf)&&(f.isPlainObject=function(a){return a&&"object"==typeof a&&Object.getPrototypeOf(a)===j}),f.isEmptyObject=function(a){var b;for(b in a)return!1;return!0},f.isDomObject=function(a){return!!a&&!!a.nodeType&&1==a.nodeType},f.isJQueryObject=function(a){return"object"===this.type(a)&&"string"===this.type(a.jquery)},f.isNative=function(a){return"function"===this.type(a)&&/native code/.test(a.toString())},f.isSupportCanvas=function(){return"boolean"!==f.type(e)&&(e=!!document.createElement("canvas").getContext),e},f.isTouchAvailable=function(){return"boolean"!==f.type(d)&&(d="ontouchstart"in window),d}}(ui,ui.$),function(a,b){var c={};a.i18n=function(){var a,b,d,e,f;if(0===(b=arguments.length))return c.common;for(d=1===b?[arguments[0]]:Array.from(arguments),f=c[d[0]]||c.common,a=1,b=d.length;a<b&&(e=d[a]||"",f=f[e]);a++);return f!==c&&f?f:null},a.i18n.locale="zh-CN",a.i18n.language=c,a.i18n.language.common={},a.i18n.language.control={},a.i18n.language.control["ui.ctrls.DateChooser"]={dateFormat:"yyyy-mm-dd",year:"年份",month:"月份",weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},a.i18n.language.control["ui.ctrls.CalendarView"]={sundayFirstWeek:["日","一","二","三","四","五","六"],mondayFirstWeek:["一","二","三","四","五","六","日"],yearUnit:"年",monthUnit:"月"}}(ui,ui.$),function(a,b){function c(b){return a.core.isFunction(b)}c(Array.isArray)||(Array.isArray=function(b){return"array"===a.core.type(b)}),c(Array.prototype.forEach)||(Array.prototype.forEach=function(a,b){var d,e;if(c(a))for(d=0,e=this.length;d<e;d++)d in this&&a.call(b,this[d],d,this)}),c(Array.prototype.map)||(Array.prototype.map=function(a,b){var d,e,f;if(c(a)){for(f=new Array(this.length),d=0,e=this.length;d<e;d++)d in this&&(f[d]=a.call(b,this[d],d,this));return f}}),c(Array.prototype.filter)||(Array.prototype.filter=function(a,b){var d,e,f;if(c(a)){for(f=[],d=0,e=this.length;d<e;d++)d in this&&a.call(b,this[d],d,this)&&f.push(this[d]);return f}}),c(Array.prototype.every)||(Array.prototype.every=function(a,b){var d,e;if(c(a)){for(d=0,e=this.length;d<e;d++)if(d in this&&!a.call(b,this[d],d,this))return!1;return!0}}),c(Array.prototype.some)||(Array.prototype.some=function(a,b){var d,e;if(c(a)){for(d=0,e=this.length;d<e;d++)if(d in this&&a.call(b,this[d],d,this))return!0;return!1}}),c(Array.prototype.reduce)||(Array.prototype.reduce=function(a,b){var d,e,f;if(c(a)){if(d=0,e=this.length,arguments.length<2){if(0===e)throw new TypeError("Reduce of empty array with no initial value");f=this[d],d++}else f=b;for(;d<e;d++)d in this&&(f=a.call(null,f,this[d],d,this));return f}}),c(Array.prototype.reduceRight)||(Array.prototype.reduceRight=function(a,b){var d,e,f;if(c(a)){if(e=this.length,d=e-1,arguments.length<2){if(0===e)throw new TypeError("Reduce of empty array with no initial value");f=this[d],d--}else f=b;for(;d>=0;d--)d in this&&(f=a.call(null,f,this[d],d,this));return f}}),c(Array.prototype.indexOf)||(Array.prototype.indexOf=function(a,b){var c,d,e;if(b||(b=0),d=this.length,e=-1,d>0){for(;b<0;)b=d+b;for(c=b;c<d;c++)if(this[c]===a){e=c;break}}return e}),c(Array.prototype.lastIndexOf)||(Array.prototype.lastIndexOf=function(a,b){var c,d,e;if(b||(b=0),d=this.length,c=d-1,e=-1,d>0){for(;b<0;)b=d+b;for(c=b;c>=0;c--)if(this[c]===a){e=c;break}}return e})}(ui,ui.$),function(a,b){function c(b){return a.core.isFunction(b)}c(Array.prototype.find)||(Array.prototype.find=function(a,b){var d,e;if(c(a))for(d=0,e=this.length;d<e;d++)if(d in this&&a.call(b,this[d],d,this))return this[d]}),c(Array.prototype.findIndex)||(Array.prototype.findIndex=function(a,b){var d,e;if(!c(a))return-1;for(d=0,e=this.length;d<e;d++)if(d in this&&a.call(b,this[d],d,this))return d;return-1}),c(Array.prototype.fill)||(Array.prototype.fill=function(a){var b,c;for(b=0,c=this.length;b<c;b++)this[b]=a}),c(Array.prototype.includes)||(Array.prototype.includes=function(a){return this.some(function(b){return b===a})}),c(Array.from)||(Array.from=function(a,b){var d,e,f,g=[];if(a&&a.length)for(f=b,c(f)||(f=function(a){return a}),d=0,e=a.length;d<e;d++)g.push(f.call(null,a[d],d));return g}),c(Array.of)||(Array.of=function(){return[].slice.call(arguments)})}(ui,ui.$),function(a,b){var c;(function(b){return a.core.isFunction(b)})(String.prototype.trim)||(c=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,String.protocol.trim=function(){return null==text?"":(text+"").replace(c,"")})}(ui,ui.$),function(a,b){function c(b){return a.core.isFunction(b)}function d(a){var b=a?Number(a):0;return isNaN(b)&&(b=0),b}var e=Object.prototype.toString;c(String.prototype.at)||(String.prototype.at=function(a){var b,c,f,g,h,i;if(null===this||void 0===this)throw new TypeError("String.prototype.indexOf called on null or undefined");return c=d(a),c=Math.max(c,0),b=e.call(this),g=b.length,c<=-1||c>=g?"":(h=b.charCodeAt(c),f=c+1,h>=55296&&h<=56319&&f<g&&(i=b.charCodeAt(f))>=56320&&i<=57343&&(f=c+2),b.slice(c,f))}),c(String.prototype.includes)||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),c(String.prototype.startsWith)||(String.prototype.startsWith=function(b){var c,f,g;if(a.core.isRegExp(b))throw new TypeError('Cannot call method "startsWith" with a regex');if(null===this||void 0===this)throw new TypeError("String.prototype.indexOf called on null or undefined");return c=e.call(this),f=e.call(b),g=arguments.length>1?d(arguments[1]):0,g=Math.max(g,0),c.slice(g,g+f.length)===f}),c(String.prototype.endsWith)||(String.prototype.endsWith=function(b){var c,f,g;if(a.core.isRegExp(b))throw new TypeError('Cannot call method "startsWith" with a regex');if(null===this||void 0===this)throw new TypeError("String.prototype.indexOf called on null or undefined");return c=e.call(this),f=e.call(b),g=arguments.length>1?d(arguments[1]):c.length,g=Math.min(Math.max(g,0),c.length),c.slice(g-f.length,g)===f})}(ui,ui.$),function(a,b){(function(b){return a.core.isFunction(b)})(Function.prototype.bind)||(Function.prototype.bind=function(a){var b=this,c=arguments;return function(){var d,e=[];for(d=1;d<c.length;d++)e.push(c[d]);for(d=0;d<arguments.length;d++)e.push(arguments[d]);return b.apply(a,e)}})}(ui,ui.$),function(ui,$){function f(a){return a<10?"0"+a:a}function this_value(){return this.valueOf()}function quote(a){return rx_escapable.lastIndex=0,rx_escapable.test(a)?'"'+a.replace(rx_escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;c<f;c+=1)g[c]=str(c,i)||"null";return e=(0===g.length?"[]":gap)?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;c<f;c+=1)"string"==typeof rep[c]&&(d=rep[c],(e=str(d,i))&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i))&&g.push(quote(d)+(gap?": ":":")+e);return e=(0===g.length?"{}":gap)?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}var hasJSON="[object JSON]"===Object.prototype.toString.call(window.JSON)&&ui.core.isFunction(window.JSON.parse)&&ui.core.isFunction(window.JSON.stringify);if(!hasJSON){var JSON={fake:!0},rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;d<c;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})},JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}}(ui,ui.$),function(a,b){function c(b){return a.core.isFunction(b)}function d(b){return"number"===a.core.type(b)}c(Number.isFinite)||(Number.isFinite=function(a){return d(a)&&a>-1/0&&a<1/0}),c(Number.isNaN)||(Number.isNaN=isNaN),c(Number.parseInt)||(Number.parseInt=parseInt),c(Number.parseFloat)||(Number.parseFloat=parseFloat)}(ui,ui.$),function(a,b){function c(b){return a.core.isFunction(b)}function d(a){return"object"!=typeof a&&"function"!=typeof a||null===a}function e(a){try{return object.sentinel=0,0===Object.getOwnPropertyDescriptor(object,"sentinel").value}catch(a){return!1}}function f(a){try{return Object.defineProperty(a,"sentinel",{}),"sentinel"in a}catch(a){return!1}}var g,h,i,j,k,l=Object.prototype,m=l.hasOwnProperty,n=l.propertyIsEnumerable;g=m.call(l,"__defineGetter__"),g&&(h=l.__defineGetter__,i=l.__defineSetter__,j=l.__lookupGetter__,k=l.__lookupSetter__),c(Object.keys)||(Object.keys=function(a){var b,c;if(d(a))throw new TypeError("Object.keys called on non-object");b=[];for(c in a)m.call(a,c)&&b.push(c);return b}),c(Object.getPrototypeOf)||(Object.getPrototypeOf=function(b){var d,e;if("null"===(d=a.core.type(b))||"undefined"===d)throw new TypeError("Cannot convert undefined or null to object");return e=b.__proto__,e||null===e?e:c(b.constructor)?b.constructor.prototype:b instanceof Object?l:null}),c(Object.getOwnPropertyNames)||(Object.getOwnPropertyNames=function(a){return Object.keys(a)});var o=null;Object.getOwnPropertyDescriptor&&(e({})&&("undefined"==typeof document||e(document.createElement("div")))||(o=Object.getOwnPropertyDescriptor)),c(Object.getOwnPropertyDescriptor)&&!o||(Object.getOwnPropertyDescriptor=function(a,b){var c,e,f,h,i;if(d(a))throw new TypeError("Object.getOwnPropertyDescriptor called on non-object");if(o)try{return o.call(Object,a,b)}catch(a){}return m.call(a,b)?(c={enumerable:n.call(a,b),value:a[b],configurable:!0,writable:!0},g&&(e=a.__proto__,f=e!==l,f&&(a.__proto__=l),h=k.call(a,b),i=k.call(a,b),f&&(a.__proto__=e),(h||i)&&(h&&(c.get=h),i&&(c.set=i))),c):c});var p=null,q=null;Object.defineProperty&&(f({})&&("undefined"==typeof document||f(document.createElement("div")))||(p=Object.defineProperty,q=Object.defineProperties)),c(Object.defineProperty)&&!p||(Object.defineProperty=function(a,b,e){var f,m,n;if(d(a)||d(b))throw new TypeError("Object.defineProperty called on non-object");if(p)try{return p.call(Object,a,b,e)}catch(a){}if("value"in e)g&&(j.call(a,b)||k.call(a,b))?(f=a.__proto__,a.__proto__=l,delete a[prototype],a[prototype]=e.value,a.__proto__=f):a[prototype]=e.value;else{if(m="get"in e&&c(e.get),n="set"in e&&c(e.set),!g&&(m||n))throw new TypeError("getters & setters can not be defined on this javascript engine");m&&h.call(a,b,e.get),n&&i.call(a,b,e.set)}}),c(Object.defineProperties)&&!q||(Object.defineProperties=function(a,b){if(q)try{return q.call(a,b)}catch(a){}return Object.keys(a).forEach(function(b){"__proto__"!==b&&Object.defineProperty(a,b)}),a}),c(Object.isExtensible)||(Object.isExtensible=function(b){var c,d;if(a.core.isObject(b))throw new TypeError("Object.isExtensible can only be called on Objects.");for(c="_tmp";m(b,c);)c+="_";return b[c]=!0,d=m(b,c),delete b[c],d}),c(Object.getPrototypeOf)||(Object.getPrototypeOf=function(b){var c,d;if("null"===(c=a.core.type(b))||"undefined"===c)throw new TypeError("Cannot convert undefined or null to object");return d=b.__proto__,property||null===d?d:a.core.isFunction(property.constructor)?d.constructor.prototype:b instanceof Object?l:null});var r,s,t,u,v;c(Object.create)||(s=!({__proto__:null}instanceof Object),t=function(){if(!document.domain)return!1;try{return!!new ActiveXObject("htmlfile")}catch(a){return!1}},u=function(){var a,b,c;return c=new ActiveXObject("htmlfile"),b="script",c.write("<"+b+"></"+b+">"),c.close(),a=c.parentWindow.Object.prototype,c=null,a},v=function(){var a,b=document.createElement("iframe"),c=document.body||document.documentElement;return b.style.display="none",c.appendChild(b),b.src="javascript:",a=b.contentWindow.Object.prototype,c.removeChild(b),b=null,a},r=s||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function a(){}var b=t()?u():v();return delete b.constructor,delete b.hasOwnProperty,delete b.propertyIsEnumerable,delete b.isPrototypeOf,delete b.toLocalString,delete b.toString,delete b.valueOf,a.prototype=empty,function(){return new a}}(),Object.create=function(a,b){function c(){}var e;if(null===a)return r();if(d(a))throw TypeError("Object prototype may only be an Object or null");return c.prototype=a,e=new c,e.__proto__=a,void 0!==b&&Object.defineProperties(e,b),e})}(ui,ui.$),function(a,b){function c(){}function d(a){var b;return a=j(a)?a:c,b=this.constructor,this.then(function(c){b.resolve(a()).then(function(){return c})},function(c){b.resolve(a()).then(function(){throw c})})}function e(){}function f(b,c,d){b._result=c,b._state=d?"resolved":"rejected",a.setMicroTask(function(){var a,c,d;for(c=0,d=b._callbacks.length;c<d;c++)a=b._callbacks[c],b._fire(a.onSuccess,a.onFail)})}function g(b,c){var d,e,f,g=0,h=[];return c="array"===a.core.type(c)?c:[],new l(function(a,i){for(c.length||a(),e=0,f=c.length;e<f;e++)!function(e,f){e.then(function(e){d||(h[f]=e,g++,(b||g>=c.length)&&(a(b?e:h),d=!0))},function(a){d=!0,i(a)})}(c[e],e)})}function h(a){return a}function i(a){throw a}var j,k,l=null;if(j=a.core.isFunction,a.PromiseEmpty={then:c,catch:c},"undefined"!=typeof Promise&&a.core.isNative(Promise))return j(Promise.prototype.finally)||(Promise.prototype.finally=d),void(j(Promise.prototype.try)||(Promise.prototype.try=e));l=function(a){var b;if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if(!j(a))throw new TypeError("the executor is not a function");this._state="pending",this._callbacks=[],b=this,a(function(a){var c;"pending"===b._state&&(a&&j(a.then)?(c=a instanceof l?"_then":"then",a[c](function(a){f(b,a,!0)},function(a){f(b,a,!1)})):f(b,a,!0))},function(a){"pending"===b._state&&f(b,a,!1)})},l.prototype={constructor:l,_then:function(b,c){var d=this;"pending"!==this._state?a.setMicroTask(function(){d._fire(b,c)}):this._callbacks.push({onSuccess:b,onFail:c})},_fire:function(a,b){if("rejected"===this._state){if("function"!=typeof b)throw this._result;b(this._result)}else"function"==typeof a&&a(this._result)},then:function(a,b){var c=this;return a=j(a)?a:h,b=j(b)?b:i,new l(function(d,e){c._then(function(b){try{b=a(b)}catch(a){return void e(a)}d(b)},function(a){try{a=b(a)}catch(a){return void e(a)}d(a)})})},catch:function(a){return this.then(h,a)},finally:d,try:e},l.all=function(a){return g(!1,a)},l.race=function(a){return g(!0,a)},l.resolve=function(a){return new l(function(b){b(a)})},l.reject=function(a){return new l(function(b,c){c(a)})},k=a.core.global(),k.Promise=l}(ui,ui.$),function(a,b){function c(){this.setArray(this.makeArray(arguments))}var d=[];c.prototype={constructor:c,setArray:function(a){return this.length=0,Array.prototype.push.apply(this,a),this},makeArray:function(a){var b,c=[];if(null!==a)if(null===(b=a.length)||a.split||a.setInterval||a.call)c[0]=a;else try{c=Array.prototype.slice.call(a)}catch(d){for(;b;)c[--b]=a[b]}return c},toArray:function(){return Array.from(this)},toString:function(){return Array.prototype.slice.call(this).toString()},valueOf:function(){return Array.prototype.slice.call(this)},get:function(a){return void 0===a?Array.prototype.slice.call(this):this[a]},shift:d.shift,push:d.push,sort:d.sort,pop:d.pop,splice:d.splice,concat:d.concat,slice:d.slice,forEach:d.forEach,map:d.map,filter:d.filter,every:d.every,some:d.some,reduce:d.reduce,reduceRight:d.reduceRight,indexOf:d.indexOf,lastIndexOf:d.lastIndexOf,find:d.find,findIndex:d.findIndex,fill:d.fill,includes:d.includes},a.ArrayLike=c}(ui,ui.$),function(a,b){function c(a,b){var c=!1;for(var d in a)d!==b?c&&(a[d]=--a[d]):c=!0}function d(){if(!(this instanceof d))return new d;this.initialize()}var e=[],f=a.ArrayLike.prototype;d.prototype={constructor:d,isArray:f.isArray,setArray:f.setArray,makeArray:f.makeArray,forEach:f.forEach,filter:f.filter,toArray:f.toArray,toString:f.toString,valueOf:f.valueOf},d.prototype.initialize=function(){a.ArrayLike.apply(this),this._keys={}},d.prototype.containsKey=function(a){return this._keys.hasOwnProperty(a)},d.prototype.containsValue=function(a){var b,c=this.length;for(b=0;b<c;b++)if(this[b]===a)return!0;return!1},d.prototype.set=function(a,b){if("string"!=typeof a)throw new TypeError("the key must be string");this.containsKey(a)?this[this._keys[a]]=b:(e.push.apply(this,[b]),this._keys[a]=this.length-1)},d.prototype.get=function(a){return this.containsKey(a)?this[this._keys[a]]:null},d.prototype.remove=function(a){var b;this.containsKey(a)&&(b=this._keys[a],e.splice.call(this,b,1),c(this._keys,a),delete this._keys[a])},d.prototype.removeAt=function(a){var b,c,d;if(a>=0&&a<this.length){c=!1;for(d in this._keys)this._keys[d]===a&&(c=!0,b=d),c&&(this._keys[d]=--this._keys[d]);delete this._keys[b],e.splice.apply(this,[a,1])}},d.prototype.keys=function(){return Object.keys(this._keys)},d.prototype.clear=function(){e.splice.apply(this,[0,this.length]),this._keys={}},a.KeyArray=d}(ui,ui.$),function(a,b){function c(a){if(!(this instanceof c))return new c(a);this.initialize(a)}function d(){if(!(this instanceof d))return new d;this.initialize()}function e(a,b){var d,e,f=new c(a);this.isEmpty()?(this._first=f,this._last=f):b?(e=this._last,this._last=f,f.previous=e,e.next=f):(d=this._first,this._first=f,f.next=d,d.previous=f)}function f(a){var b,c;return this.isEmpty()?null:a?(c=this._last,this._last=this._last.previous,c):(b=this._first,this._first=this._first.next,b)}c.prototype={constructor:c,initialize:function(a){this.element=a,this.next=null,this.previous=null},hasNext:function(){return!!this.next},hasProvious:function(){return!!this.previous}},d.prototype={constructor:d,initialize:function(){this._first=null,this._last=null},isEmpty:function(){return!this._first},clear:function(){this._first=null,this._last=null},pop:function(){return f.call(this,!0)},push:function(a){e.call(this,a,!0)},shift:function(a){return f.call(this,!1)},unshift:function(){e.call(this,element,!1)},remove:function(a){var b,d;for(d=this._first;d instanceof c;d=d.next)d.element===a&&(d.prev&&d.next?(b=d.prev,b.next=d.next,d.next.prev=b):d.prev||d.next?d.next?d.prev||(this._first=this._first.next,this._first.prev=null):(this._last=this._last.prev,this._last.next=null):(this._first=null,this._last=null))},forEach:function(b,d){var e,f;if(a.core.isFunction(b))for(f=0,e=this._first;e instanceof c;e=e.next,f++)b.call(d,e.element,f,this)},toArray:function(){var a=[];return this.forEach(function(b){a.push(b)}),a}},a.LinkedList=d}(ui,ui.$),function(a,b){var c=function(){function a(a){return null==a?String(a):V[W.call(a)]||"object"}function b(b){return"function"==a(b)}function c(a){return null!=a&&a==a.window}function d(a){return null!=a&&a.nodeType==a.DOCUMENT_NODE}function e(b){return"object"==a(b)}function f(a){return e(a)&&!c(a)&&Object.getPrototypeOf(a)==Object.prototype}function g(a){var b=!!a&&"length"in a&&a.length,d=y.type(a);return"function"!=d&&!c(a)&&("array"==d||0===b||"number"==typeof b&&b>0&&b-1 in a)}function h(a){return E.call(a,function(a){return null!=a})}function i(a){return a.length>0?y.fn.concat.apply([],a):a}function j(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function k(a){return a in I?I[a]:I[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function l(a,b){return"number"!=typeof b||J[j(a)]?b:b+"px"}function m(a){var b,c;return H[a]||(b=G.createElement(a),G.body.appendChild(b),c=getComputedStyle(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),"none"==c&&(c="block"),H[a]=c),H[a]}function n(a){return"children"in a?F.call(a.children):y.map(a.childNodes,function(a){if(1==a.nodeType)return a})}function o(a,b){var c,d=a?a.length:0;for(c=0;c<d;c++)this[c]=a[c];this.length=d,this.selector=b||""}function p(a,b,c){for(x in b)c&&(f(b[x])||$(b[x]))?(f(b[x])&&!f(a[x])&&(a[x]={}),$(b[x])&&!$(a[x])&&(a[x]=[]),p(a[x],b[x],c)):b[x]!==w&&(a[x]=b[x])}function q(a,b){return null==b?y(a):y(a).filter(b)}function r(a,c,d,e){return b(c)?c.call(a,d,e):c}function s(a,b,c){null==c?a.removeAttribute(b):a.setAttribute(b,c)}function t(a,b){var c=a.className||"",d=c&&c.baseVal!==w;if(b===w)return d?c.baseVal:c;d?c.baseVal=b:a.className=b}function u(a){try{return a?"true"==a||"false"!=a&&("null"==a?null:+a+""==a?+a:/^[\[\{]/.test(a)?y.parseJSON(a):a):a}catch(b){return a}}function v(a,b){b(a);for(var c=0,d=a.childNodes.length;c<d;c++)v(a.childNodes[c],b)}var w,x,y,z,A,B,C=[],D=C.concat,E=C.filter,F=C.slice,G=window.document,H={},I={},J={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},K=/^\s*<(\w+|!)[^>]*>/,L=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,M=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,N=/^(?:body|html)$/i,O=/([A-Z])/g,P=["val","css","html","text","data","width","height","offset"],Q=["after","prepend","before","append"],R=G.createElement("table"),S=G.createElement("tr"),T={tr:G.createElement("tbody"),tbody:R,thead:R,tfoot:R,td:S,th:S,"*":G.createElement("div")},U=/^[\w-]*$/,V={},W=V.toString,X={},Y=G.createElement("div"),Z={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},$=Array.isArray||function(a){return a instanceof Array};return X.matches=function(a,b){if(!b||!a||1!==a.nodeType)return!1;var c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(c)return c.call(a,b);var d,e=a.parentNode,f=!e;return f&&(e=Y).appendChild(a),d=~X.qsa(e,b).indexOf(a),f&&Y.removeChild(a),d},A=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},B=function(a){return E.call(a,function(b,c){return a.indexOf(b)==c})},X.fragment=function(a,b,c){var d,e,g;return L.test(a)&&(d=y(G.createElement(RegExp.$1))),d||(a.replace&&(a=a.replace(M,"<$1></$2>")),b===w&&(b=K.test(a)&&RegExp.$1),b in T||(b="*"),g=T[b],g.innerHTML=""+a,d=y.each(F.call(g.childNodes),function(){g.removeChild(this)})),f(c)&&(e=y(d),y.each(c,function(a,b){P.indexOf(a)>-1?e[a](b):e.attr(a,b)})),d},X.Z=function(a,b){return new o(a,b)},X.isZ=function(a){return a instanceof X.Z},X.init=function(a,c){var d;if(!a)return X.Z();if("string"==typeof a)if(a=a.trim(),"<"==a[0]&&K.test(a))d=X.fragment(a,RegExp.$1,c),a=null;else{if(c!==w)return y(c).find(a);d=X.qsa(G,a)}else{if(b(a))return y(G).ready(a);if(X.isZ(a))return a;if($(a))d=h(a);else if(e(a))d=[a],a=null;else if(K.test(a))d=X.fragment(a.trim(),RegExp.$1,c),a=null;else{if(c!==w)return y(c).find(a);d=X.qsa(G,a)}}return X.Z(d,a)},y=function(a,b){return X.init(a,b)},y.extend=function(a){var b,c=F.call(arguments,1);return"boolean"==typeof a&&(b=a,a=c.shift()),c.forEach(function(c){p(a,c,b)}),a},X.qsa=function(a,b){var c,d="#"==b[0],e=!d&&"."==b[0],f=d||e?b.slice(1):b,g=U.test(f);return a.getElementById&&g&&d?(c=a.getElementById(f))?[c]:[]:1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType?[]:F.call(g&&!d&&a.getElementsByClassName?e?a.getElementsByClassName(f):a.getElementsByTagName(b):a.querySelectorAll(b))},y.contains=G.documentElement.contains?function(a,b){return a!==b&&a.contains(b)}:function(a,b){for(;b&&(b=b.parentNode);)if(b===a)return!0;return!1},y.type=a,y.isFunction=b,y.isWindow=c,y.isArray=$,y.isPlainObject=f,y.isEmptyObject=function(a){var b;for(b in a)return!1;return!0},y.isNumeric=function(a){var b=Number(a),c=typeof a;return null!=a&&"boolean"!=c&&("string"!=c||a.length)&&!isNaN(b)&&isFinite(b)||!1},y.inArray=function(a,b,c){return C.indexOf.call(b,a,c)},y.camelCase=A,y.trim=function(a){return null==a?"":String.prototype.trim.call(a)},y.uuid=0,y.support={},y.expr={},y.noop=function(){},y.map=function(a,b){var c,d,e,f=[];if(g(a))for(d=0;d<a.length;d++)null!=(c=b(a[d],d))&&f.push(c);else for(e in a)null!=(c=b(a[e],e))&&f.push(c);return i(f)},y.each=function(a,b){var c,d;if(g(a)){for(c=0;c<a.length;c++)if(!1===b.call(a[c],c,a[c]))return a}else for(d in a)if(!1===b.call(a[d],d,a[d]))return a;return a},y.grep=function(a,b){return E.call(a,b)},window.JSON&&(y.parseJSON=JSON.parse),y.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()}),y.fn={constructor:X.Z,length:0,forEach:C.forEach,reduce:C.reduce,push:C.push,sort:C.sort,splice:C.splice,indexOf:C.indexOf,concat:function(){var a,b,c=[];for(a=0;a<arguments.length;a++)b=arguments[a],c[a]=X.isZ(b)?b.toArray():b;return D.apply(X.isZ(this)?this.toArray():this,c)},map:function(a){return y(y.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return y(F.apply(this,arguments))},ready:function(a){if("complete"===G.readyState||"loading"!==G.readyState&&!G.documentElement.doScroll)setTimeout(function(){a(y)},0);else{var b=function(){G.removeEventListener("DOMContentLoaded",b,!1),window.removeEventListener("load",b,!1),a(y)};G.addEventListener("DOMContentLoaded",b,!1),window.addEventListener("load",b,!1)}return this},get:function(a){return a===w?F.call(this):this[a>=0?a:a+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){return C.every.call(this,function(b,c){return!1!==a.call(b,c,b)}),this},filter:function(a){return b(a)?this.not(this.not(a)):y(E.call(this,function(b){return X.matches(b,a)}))},add:function(a,b){return y(B(this.concat(y(a,b))))},is:function(a){return"string"==typeof a?this.length>0&&X.matches(this[0],a):a&&this.selector==a.selector},not:function(a){var c=[];if(b(a)&&a.call!==w)this.each(function(b){a.call(this,b)||c.push(this)});else{var d="string"==typeof a?this.filter(a):g(a)&&b(a.item)?F.call(a):y(a);this.forEach(function(a){d.indexOf(a)<0&&c.push(a)})}return y(c)},has:function(a){return this.filter(function(){return e(a)?y.contains(this,a):y(this).find(a).size()})},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!e(a)?a:y(a)},last:function(){var a=this[this.length-1];return a&&!e(a)?a:y(a)},find:function(a){var b=this;return a?"object"==typeof a?y(a).filter(function(){var a=this;return C.some.call(b,function(b){return y.contains(b,a)})}):1==this.length?y(X.qsa(this[0],a)):this.map(function(){return X.qsa(this,a)}):y()},closest:function(a,b){var c=[],e="object"==typeof a&&y(a);return this.each(function(f,g){for(;g&&!(e?e.indexOf(g)>=0:X.matches(g,a));)g=g!==b&&!d(g)&&g.parentNode;g&&c.indexOf(g)<0&&c.push(g)}),y(c)},parents:function(a){for(var b=[],c=this;c.length>0;)c=y.map(c,function(a){if((a=a.parentNode)&&!d(a)&&b.indexOf(a)<0)return b.push(a),a});return q(b,a)},parent:function(a){return q(B(this.pluck("parentNode")),a)},children:function(a){return q(this.map(function(){return n(this)}),a)},contents:function(){return this.map(function(){return this.contentDocument||F.call(this.childNodes)})},siblings:function(a){return q(this.map(function(a,b){return E.call(n(b.parentNode),function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return y.map(this,function(b){return b[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=m(this.nodeName))})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var c=b(a);if(this[0]&&!c)var d=y(a).get(0),e=d.parentNode||this.length>1;return this.each(function(b){y(this).wrapAll(c?a.call(this,b):e?d.cloneNode(!0):d)})},wrapAll:function(a){if(this[0]){y(this[0]).before(a=y(a));for(var b;(b=a.children()).length;)a=b.first();y(a).append(this)}return this},wrapInner:function(a){var c=b(a);return this.each(function(b){var d=y(this),e=d.contents(),f=c?a.call(this,b):a;e.length?e.wrapAll(f):d.append(f)})},unwrap:function(){return this.parent().each(function(){y(this).replaceWith(y(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(a){return this.each(function(){var b=y(this);(a===w?"none"==b.css("display"):a)?b.show():b.hide()})},
prev:function(a){return y(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return y(this.pluck("nextElementSibling")).filter(a||"*")},html:function(a){return 0 in arguments?this.each(function(b){var c=this.innerHTML;y(this).empty().append(r(this,a,b,c))}):0 in this?this[0].innerHTML:null},text:function(a){return 0 in arguments?this.each(function(b){var c=r(this,a,b,this.textContent);this.textContent=null==c?"":""+c}):0 in this?this.pluck("textContent").join(""):null},attr:function(a,b){var c;return"string"!=typeof a||1 in arguments?this.each(function(c){if(1===this.nodeType)if(e(a))for(x in a)s(this,x,a[x]);else s(this,a,r(this,b,c,this.getAttribute(a)))}):0 in this&&1==this[0].nodeType&&null!=(c=this[0].getAttribute(a))?c:w},removeAttr:function(a){return this.each(function(){1===this.nodeType&&a.split(" ").forEach(function(a){s(this,a)},this)})},prop:function(a,b){return a=Z[a]||a,"string"!=typeof a||1 in arguments?this.each(function(c){if(e(a))for(x in a)this[Z[x]||x]=a[x];else this[a]=r(this,b,c,this[a])}):this[0]&&this[0][a]},removeProp:function(a){return a=Z[a]||a,this.each(function(){delete this[a]})},data:function(a,b){var c="data-"+a.replace(O,"-$1").toLowerCase(),d=1 in arguments?this.attr(c,b):this.attr(c);return null!==d?u(d):w},val:function(a){return 0 in arguments?(null==a&&(a=""),this.each(function(b){this.value=r(this,a,b,this.value)})):this[0]&&(this[0].multiple?y(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(a){if(a)return this.each(function(b){var c=y(this),d=r(this,a,b,c.offset()),e=c.offsetParent().offset(),f={top:d.top-e.top,left:d.left-e.left};"static"==c.css("position")&&(f.position="relative"),c.css(f)});if(!this.length)return null;if(G.documentElement!==this[0]&&!y.contains(G.documentElement,this[0]))return{top:0,left:0};var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:Math.round(b.width),height:Math.round(b.height)}},css:function(b,c){if(arguments.length<2){var d=this[0];if("string"==typeof b){if(!d)return;return d.style[A(b)]||getComputedStyle(d,"").getPropertyValue(b)}if($(b)){if(!d)return;var e={},f=getComputedStyle(d,"");return y.each(b,function(a,b){e[b]=d.style[A(b)]||f.getPropertyValue(b)}),e}}var g="";if("string"==a(b))c||0===c?g=j(b)+":"+l(b,c):this.each(function(){this.style.removeProperty(j(b))});else for(x in b)b[x]||0===b[x]?g+=j(x)+":"+l(x,b[x])+";":this.each(function(){this.style.removeProperty(j(x))});return this.each(function(){this.style.cssText+=";"+g})},index:function(a){return a?this.indexOf(y(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return!!a&&C.some.call(this,function(a){return this.test(t(a))},k(a))},addClass:function(a){return a?this.each(function(b){if("className"in this){z=[];var c=t(this);r(this,a,b,c).split(/\s+/g).forEach(function(a){y(this).hasClass(a)||z.push(a)},this),z.length&&t(this,c+(c?" ":"")+z.join(" "))}}):this},removeClass:function(a){return this.each(function(b){if("className"in this){if(a===w)return t(this,"");z=t(this),r(this,a,b,z).split(/\s+/g).forEach(function(a){z=z.replace(k(a)," ")}),t(this,z.trim())}})},toggleClass:function(a,b){return a?this.each(function(c){var d=y(this);r(this,a,c,t(this)).split(/\s+/g).forEach(function(a){(b===w?!d.hasClass(a):b)?d.addClass(a):d.removeClass(a)})}):this},scrollTop:function(a){if(this.length){var b="scrollTop"in this[0];return a===w?b?this[0].scrollTop:this[0].pageYOffset:this.each(b?function(){this.scrollTop=a}:function(){this.scrollTo(this.scrollX,a)})}},scrollLeft:function(a){if(this.length){var b="scrollLeft"in this[0];return a===w?b?this[0].scrollLeft:this[0].pageXOffset:this.each(b?function(){this.scrollLeft=a}:function(){this.scrollTo(a,this.scrollY)})}},position:function(){if(this.length){var a=this[0],b=this.offsetParent(),c=this.offset(),d=N.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(y(a).css("margin-top"))||0,c.left-=parseFloat(y(a).css("margin-left"))||0,d.top+=parseFloat(y(b[0]).css("border-top-width"))||0,d.left+=parseFloat(y(b[0]).css("border-left-width"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||G.body;a&&!N.test(a.nodeName)&&"static"==y(a).css("position");)a=a.offsetParent;return a})}},y.fn.detach=y.fn.remove,["width","height"].forEach(function(a){var b=a.replace(/./,function(a){return a[0].toUpperCase()});y.fn[a]=function(e){var f,g=this[0];return e===w?c(g)?g["inner"+b]:d(g)?g.documentElement["scroll"+b]:(f=this.offset())&&f[a]:this.each(function(b){g=y(this),g.css(a,r(this,e,b,g[a]()))})}}),Q.forEach(function(b,c){var d=c%2;y.fn[b]=function(){var b,e,f=y.map(arguments,function(c){var d=[];return b=a(c),"array"==b?(c.forEach(function(a){return a.nodeType!==w?d.push(a):y.zepto.isZ(a)?d=d.concat(a.get()):void(d=d.concat(X.fragment(a)))}),d):"object"==b||null==c?c:X.fragment(c)}),g=this.length>1;return f.length<1?this:this.each(function(a,b){e=d?b:b.parentNode,b=0==c?b.nextSibling:1==c?b.firstChild:2==c?b:null;var h=y.contains(G.documentElement,e);f.forEach(function(a){if(g)a=a.cloneNode(!0);else if(!e)return y(a).remove();e.insertBefore(a,b),h&&v(a,function(a){if(!(null==a.nodeName||"SCRIPT"!==a.nodeName.toUpperCase()||a.type&&"text/javascript"!==a.type||a.src)){var b=a.ownerDocument?a.ownerDocument.defaultView:window;b.eval.call(b,a.innerHTML)}})})})},y.fn[d?b+"To":"insert"+(c?"Before":"After")]=function(a){return y(a)[b](this),this}}),X.Z.prototype=o.prototype=y.fn,X.uniq=B,X.deserializeValue=u,y.zepto=X,y}();window.Zepto=c,a.$=c,a.$.fn.jquery="zepto",init_$(a.$)}(ui,ui.$),function(a,b){b.fn.getBoundingClientRect=function(){if(0!==this.length)return this[0].getBoundingClientRect()},a.core.each("Width, Height",function(c){b.fn["outer"+c]=function(){var b,d;return 0===this.length?0:(b=this[0],a.core.isWindow(b)?b["inner"+c]:9===b.nodeType?(d=b.documentElement,Math.max(b.body["scroll"+c],d["scroll"+c],b.body["offset"+c],d["offset"+c],d["client"+c])):this.getBoundingClientRect()[c.toLowerCase()])}})}(ui,ui.$),function(a,b){function c(a){return a._zid||(a._zid=n++)}function d(a,b,d,g){if(b=e(b),b.ns)var h=f(b.ns);return(r[c(a)]||[]).filter(function(a){return a&&(!b.e||a.e==b.e)&&(!b.ns||h.test(a.ns))&&(!d||c(a.fn)===c(d))&&(!g||a.sel==g)})}function e(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function f(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function g(a,b){return a.del&&!t&&a.e in u||!!b}function h(a){return v[a]||t&&u[a]||a}function i(a,d,f,i,j,l,n){var o=c(a),p=r[o]||(r[o]=[]);d.split(/\s/).forEach(function(c){if("ready"==c)return b(document).ready(f);var d=e(c);d.fn=f,d.sel=j,d.e in v&&(f=function(a){var c=a.relatedTarget;if(!c||c!==this&&!b.contains(this,c))return d.fn.apply(this,arguments)}),d.del=l;var o=l||f;d.proxy=function(b){if(b=k(b),!b.isImmediatePropagationStopped()){b instanceof InputEvent?b.eventData=i:b.data=i;var c=o.apply(a,b._args==m?[b]:[b].concat(b._args));return!1===c&&(b.preventDefault(),b.stopPropagation()),c}},d.i=p.length,p.push(d),"addEventListener"in a&&a.addEventListener(h(d.e),d.proxy,g(d,n))})}function j(a,b,e,f,i){var j=c(a);(b||"").split(/\s/).forEach(function(b){d(a,b,e,f).forEach(function(b){delete r[j][b.i],"removeEventListener"in a&&a.removeEventListener(h(b.e),b.proxy,g(b,i))})})}function k(a,c){if(c||!a.isDefaultPrevented){c||(c=a),b.each(z,function(b,d){var e=c[b];a[b]=function(){return this[d]=w,e&&e.apply(c,arguments)},a[d]=x});try{a.timeStamp||(a.timeStamp=Date.now())}catch(a){}(c.defaultPrevented!==m?c.defaultPrevented:"returnValue"in c?!1===c.returnValue:c.getPreventDefault&&c.getPreventDefault())&&(a.isDefaultPrevented=w)}return a}function l(a){var b,c={originalEvent:a};for(b in a)y.test(b)||a[b]===m||(c[b]=a[b]);return k(c,a)}var m,n=1,o=Array.prototype.slice,p=b.isFunction,q=function(a){return"string"==typeof a},r={},s={},t="onfocusin"in window,u={focus:"focusin",blur:"focusout"},v={mouseenter:"mouseover",mouseleave:"mouseout"};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents",b.event={add:i,remove:j},b.proxy=function(a,d){var e=2 in arguments&&o.call(arguments,2);if(p(a)){var f=function(){return a.apply(d,e?e.concat(o.call(arguments)):arguments)};return f._zid=c(a),f}if(q(d))return e?(e.unshift(a[d],a),b.proxy.apply(null,e)):b.proxy(a[d],a);throw new TypeError("expected function")},b.fn.bind=function(a,b,c){return this.on(a,b,c)},b.fn.unbind=function(a,b){return this.off(a,b)},b.fn.one=function(a,b,c,d){return this.on(a,b,c,d,1)};var w=function(){return!0},x=function(){return!1},y=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,z={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};b.fn.delegate=function(a,b,c){return this.on(b,a,c)},b.fn.undelegate=function(a,b,c){return this.off(b,a,c)},b.fn.live=function(a,c){return b(document.body).delegate(this.selector,a,c),this},b.fn.die=function(a,c){return b(document.body).undelegate(this.selector,a,c),this},b.fn.on=function(a,c,d,e,f){var g,h,k=this;return a&&!q(a)?(b.each(a,function(a,b){k.on(a,c,d,b,f)}),k):(q(c)||p(e)||!1===e||(e=d,d=c,c=m),e!==m&&!1!==d||(e=d,d=m),!1===e&&(e=x),k.each(function(k,m){f&&(g=function(a){return j(m,a.type,e),e.apply(this,arguments)}),c&&(h=function(a){var d,f=b(a.target).closest(c,m).get(0);if(f&&f!==m)return d=b.extend(l(a),{currentTarget:f,liveFired:m}),(g||e).apply(f,[d].concat(o.call(arguments,1)))}),i(m,a,e,d,c,h||g)}))},b.fn.off=function(a,c,d){var e=this;return a&&!q(a)?(b.each(a,function(a,b){e.off(a,c,b)}),e):(q(c)||p(d)||!1===d||(d=c,c=m),!1===d&&(d=x),e.each(function(){j(this,a,d,c)}))},b.fn.trigger=function(a,c){return a=q(a)||b.isPlainObject(a)?b.Event(a):k(a),a._args=c,this.each(function(){a.type in u&&"function"==typeof this[a.type]?this[a.type]():"dispatchEvent"in this?this.dispatchEvent(a):b(this).triggerHandler(a,c)})},b.fn.triggerHandler=function(a,c){var e,f;return this.each(function(g,h){e=l(q(a)?b.Event(a):a),e._args=c,e.target=h,b.each(d(h,a.type||a),function(a,b){if(f=b.proxy(e),e.isImmediatePropagationStopped())return!1})}),f},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(a){b.fn[a]=function(b){return 0 in arguments?this.bind(a,b):this.trigger(a)}}),b.Event=function(a,b){q(a)||(b=a,a=b.type);var c=document.createEvent(s[a]||"Events"),d=!0;if(b)for(var e in b)"bubbles"==e?d=!!b[e]:c[e]=b[e];return c.initEvent(a,d,!0),k(c)}}(0,ui.$),function(a,b){!function(){try{getComputedStyle(void 0)}catch(b){var a=getComputedStyle;window.getComputedStyle=function(b,c){try{return a(b,c)}catch(a){return null}}}}()}(0,ui.$),function(a,b){function c(a,c){var e=a[i],j=e&&f[e];if(void 0===c)return j||d(a);if(j){if(c in j)return j[c];var k=h(c);if(k in j)return j[k]}return g.call(b(a),c)}function d(a,c,d){var g=a[i]||(a[i]=++b.uuid),j=f[g]||(f[g]=e(a));return void 0!==c&&(j[h(c)]=d),j}function e(a){var c={};return b.each(a.attributes||j,function(a,d){0==d.name.indexOf("data-")&&(c[h(d.name.replace("data-",""))]=b.zepto.deserializeValue(d.value))}),c}var f={},g=b.fn.data,h=b.camelCase,i=b.expando="Zepto"+ +new Date,j=[];b.fn.data=function(a,e){return void 0===e?b.isPlainObject(a)?this.each(function(c,e){b.each(a,function(a,b){d(e,a,b)})}):0 in this?c(this[0],a):void 0:this.each(function(){d(this,a,e)})},b.data=function(a,c,d){return b(a).data(c,d)},b.hasData=function(a){var c=a[i],d=c&&f[c];return!!d&&!b.isEmptyObject(d)},b.fn.removeData=function(a){return"string"==typeof a&&(a=a.split(/\s+/)),this.each(function(){var c=this[i],d=c&&f[c];d&&b.each(a||d,function(b){delete d[a?h(this):b]})})},["remove","empty"].forEach(function(a){var c=b.fn[a];b.fn[a]=function(){var b=this.find("*");return"remove"===a&&(b=b.add(this)),b.removeData(),c.call(this)}})}(0,ui.$),function(a,b){var c,d=document;c=function(){if(window.VBArray){var a=d.documentMode;return a||(window.XMLHttpRequest?7:6)}return 0}(),b.fn.nodeName=function(){var a=this.prop("nodeName");return 0!==this.length&&a?a:null},b.fn.isNodeName=function(a){return this.nodeName()===(a+"").toUpperCase()},b.fn.hasHorizontalScroll=function(){var a=this.css("overflow");return"visible"!==a&&"hidden"!==a&&("scroll"===a||this.get(0).scrollWidth>this.width())},b.fn.hasVerticalScroll=function(){var a=this.css("overflow");return"visible"!==a&&"hidden"!==a&&("scroll"===a||this.get(0).scrollHeight>this.height())},b.fn.bindOptions=function(a,b,c){if("SELECT"!==this.nodeName())return this;if(b||(b="value"),c||(c="text"),!a.length)return this;var d,e,f=a.length,g=[];for(d=0;d<f;d++)(e=a[d])&&g.push("<option value='",e[b],"'>",e[c],"</option>");return this.html(g.join("")),this},b.fn.selectOption=function(){if("SELECT"!==this.nodeName())return null;var a={value:this.val(),text:null};return a.text=this.children("option[value='"+a.value+"']").text(),a},c&&b(d).on("selectionchange",function(a){var b=d.activeElement;b&&"function"==typeof b.uiEventSelectionChange&&b.uiEventSelectionChange()}),b.fn.textinput=function(b,d){var e,f,g;if(0!==this.length&&(a.core.isFunction(b)&&(d=b,b=null),a.core.isFunction(d)&&(f={data:b,target:this[0]},e=!1,"INPUT"===(g=this.nodeName())||"TEXTAREA"===g)))return c?(9===c&&(this[0].uiEventSelectionChange=function(){d(f)}),c>8?this.on("input",null,b,d):(this.on("propertychange",function(a){"value"===(a.originalEvent?a.originalEvent.propertyName:a.propertyName)&&d(f)}),this.on("dragend",null,b,function(a){setTimeout(function(){d(a)})}))):(this.on("input",null,b,function(a){e||d(a)}),this.on("compositionstart",function(a){e=!0}),this.on("compositionend",function(a){e=!1,d(a)})),this}}(ui,ui.$),function(a,b){function c(b,d,e){Array.isArray(d)?d.forEach(function(a,d){f.test(b)?e(b,a):c(b+"["+("object"==typeof a?d:"")+"]",a,e)}):a.core.isPlainObject(d)?Object.keys(d).forEach(function(a){c(b+"["+a+"]",d[a],e)}):e(b,d)}function d(b,c,d){var e,f,g,h,i={};c&&d&&(h=d.getBoundingClientRect(),e=h.width,f=h.height,g=b.call(a,c,e,f),i.top=g.top+"px",i.left=g.left+"px",d.css(i))}a.scrollbarHeight=a.scrollbarWidth=17,a.tempDiv=b("<div style='position:absolute;left:-1000px;top:-100px;width:100px;height:100px;overflow:auto;' />"),a.tempInnerDiv=b("<div style='width:100%;height:50px;' />"),a.tempDiv.append(a.tempInnerDiv),document.documentElement.appendChild(a.tempDiv.get(0)),a.tempWidth=a.tempInnerDiv[0].clientWidth,a.tempInnerDiv.css("height","120px"),a.scrollbarHeight=a.scrollbarWidth=a.tempWidth-a.tempInnerDiv[0].clientWidth,a.tempInnerDiv.remove(),a.tempDiv.remove(),delete a.tempWidth,delete a.tempInnerDiv,delete a.tempDiv,a.hasScrollBar=function(){return!1},a.handleError=function(a){console.log(a)},a.globalEval=function(b){b&&a.str.trim(b)&&(window.execScript||function(a){window.eval.call(window,a)})(b)},a.fixedNumber=function(a,b){var c,d=1;return isNaN(a)?a:(a<0&&(d=-1),isNaN(b)&&(b=0),c=Math.pow(10,b),Math.round(Math.abs(a)*c)/c*d)};var e=/%20/g,f=/\[\]$/;a.param=function(b){var d=[],f=function(b,c){if(b){var e=a.core.isFunction(c)?c():c;d.push(encodeURIComponent(b)+"="+encodeURIComponent(null===e?"":e))}};return Array.isArray(b)?b.forEach(function(a){f(a.name,a.value)}):Object.keys(b).forEach(function(a){c(a,b[a],f)}),d.join("&").replace(e,"+")},a.extend=function(){var b,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;if(a.core.isBoolean(h)&&(k=h,h=arguments[i]||{},i++),"object"==typeof h||a.core.isFunction(h)||(h={}),i===j)return h;for(;i<j;i++)if(null!=(b=arguments[i]))for(c in b)b.hasOwnProperty(c)&&(f=!1,d=h[c],e=b[c],h!==e&&(k&&e&&(a.core.isPlainObject(e)||(f=Array.isArray(e)))?(g=f?d&&Array.isArray(d)?d:[]:d&&a.core.isPlainObject(d)?d:{},h[c]=a.extend(k,g,e)):void 0!==e&&null!==e&&(h[c]=e)));return h},a.getScrollOffsets=function(a){var b,c;return a=a||window,c=a.document,b={},null!==a.pageXOffset?(b.scrollLeft=a.pageXOffset,b.scrollTop=a.pageYOffset,b):"CSS1Compat"===document.compatMode?(b.scrollLeft=c.documentElement.scrollLeft,b.scrollTop=c.documentElement.scrollTop,b):(b.scrollLeft=c.body.scrollLeft,b.scrollTop=c.body.scrollTop,b)},a.getViewportSize=function(a){var b,c={};return a=a||window,b=a.document,null!==a.innerWidth&&(c.clientWidth=a.innerWidth,c.clientHeight=a.innerHeight),"CSS1Compat"===document.compatMode?(c.scrollLeft=b.documentElement.clientWidth,c.scrollTop=b.documentElement.clientHeight,c):(c.scrollLeft=b.body.clientWidth,c.scrollTop=b.body.clientHeight,c)},a.getBoundingClientRect=function(b){var c;return b?(a.core.isJQueryObject(b)&&(b=b[0]),c=b.getBoundingClientRect(),c.width=c.width||c.right-c.left,c.height=c.height||c.bottom-c.top,c.x=c.x||c.left,c.y=c.y||c.top,c):null},a.getJQueryElement=function(c){var d=null;return"string"===a.core.type(c)?d=b("#"+c):a.core.isJQueryObject(c)?d=c:a.core.isDomObject(c)&&(d=b(c)),d&&0!==d.length?d:null},a.setDown=function(b,c){d(a.getDownLocation,b,c)},a.setLeft=function(b,c){d(a.getLeftLocation,b,c)},a.getDownLocation=function(a,b,c){var d,e,f,g,h;return d={left:0,top:0},a?(e=a.getBoundingClientRect(),f=document.documentElement,g=e.top+e.height,h=e.left,g+c>f.clientHeight+f.scrollTop&&(g-=c+e.height),h+b>f.clientWidth+f.scrollLeft&&(h-=b-e.width),d.top=g,d.left=h,d):d},a.getLeftLocation=function(a,b,c){var d,e,f,g,h;return d={left:0,top:0},a?(e=a.getBoundingClientRect(),f=document.documentElement,g=e.top,h=e.left+e.width,g+c>f.clientHeight+f.scrollTop&&(g-=g+c-(f.clientHeight+f.scrollTop)),h+b>f.clientWidth+f.scrollLeft&&(h=e.left-b),d.top=g,d.left=h,d):d}}(ui,ui.$),function(a,b){function c(a){var b,c=f;a=a.replace(/\r\n/g,"\n");for(var d=0;d<a.length;d++)b=a.charCodeAt(d),b<128?c+=String.fromCharCode(b):b>127&&b<2048?(c+=String.fromCharCode(b>>6|192),c+=String.fromCharCode(63&b|128)):(c+=String.fromCharCode(b>>12|224),c+=String.fromCharCode(b>>6&63|128),c+=String.fromCharCode(63&b|128));return c}function d(a){for(var b=f,c=0,d=0,e=0,g=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(g=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&g),c+=2):(g=a.charCodeAt(c+1),e=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&g)<<6|63&e),c+=3);return b}var e,f="",g=/\\?\{([^{}]+)\}/gm,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.str={empty:f,each:a.core.each,trim:function(a,b){return"string"!=typeof a?a:(b||(b="\\s"),a.replace(new RegExp("(^"+b+"*)|("+b+"*$)","g"),f))},trimLeft:function(a,b){return"string"!=typeof a?a:(b||(b="\\s"),a.replace(new RegExp("(^"+b+"*)","g"),f))},trimRight:function(a,b){return"string"!=typeof a?a:(b||(b="\\s"),a.replace(new RegExp("("+b+"*$)","g"),f))},isEmpty:function(a){return void 0===a||null===a||"string"==typeof a&&0===a.length},isBlank:function(b){var c,d;if(void 0===b||null===b)return!0;if(a.core.isString(b)){for(c=0,d=b.length;c<d;c++)if(32!=b.charCodeAt(c))return!1;return!0}},format:function(a,b){var c=Array.prototype.slice,d=c.call(arguments,1);return a?a.replace(g,function(a,c){var e;return"\\"==a.charAt(0)?a.slice(1):(e=Number(c),e>=0?d[e]:b&&b[c]?b[c]:"")}):f},base64Encode:function(a){var b,d,e,f,g,i,j,k="",l=0;if(!a)return a;for(a=c(a);l<a.length;)b=a.charCodeAt(l++),d=a.charCodeAt(l++),e=a.charCodeAt(l++),f=b>>2,g=(3&b)<<4|d>>4,i=(15&d)<<2|e>>6,j=63&e,isNaN(d)?i=j=64:isNaN(e)&&(j=64),k=k+h.charAt(f)+h.charAt(g)+h.charAt(i)+h.charAt(j);return k},base64Decode:function(a){var b,c,e,f,g,i,j,k="",l=0;if(!a)return a;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<a.length;)f=h.indexOf(a.charAt(l++)),g=h.indexOf(a.charAt(l++)),i=h.indexOf(a.charAt(l++)),j=h.indexOf(a.charAt(l++)),b=f<<2|g>>4,c=(15&g)<<4|i>>2,e=(3&i)<<6|j,k+=String.fromCharCode(b),64!=i&&(k+=String.fromCharCode(c)),64!=j&&(k+=String.fromCharCode(e));return k=d(k)},htmlEncode:function(a){if(this.isEmpty(a))return f;var b,c,d,e=[];for(b=c=0,d=a.length;b<d;b++)switch(a.charAt(b)){case">":e.push(a.substring(c,b),"&gt;"),c=b+1;break;case"<":e.push(a.substring(c,b),"&lt;"),c=b+1;break;case"&":e.push(a.substring(c,b),"&amp;"),c=b+1;break;case"'":e.push(a.substring(c,b),"&#39;"),c=b+1;break;case'"':e.push(a.substring(c,b),"&quot;"),c=b+1}return c<d&&e.push(a.substring(c)),e.join("")},htmlDecode:function(a){return this.isEmpty(a)?f:(e||(e=document.createElement("span")),e.innerHTML=a,e.innerText)},numberScaleFormat:function(b,c){var d,e,g,h,i;if(isNaN(b))return null;for(isNaN(c)&&(c=2),b=a.fixedNumber(b,c),d=b+f,g=d.indexOf("."),g<0?e=f:(e=d.substring(g+1),d=d.substring(0,g)),h=0,i=c-e.length;h<i;h++)e+="0";return d+"."+e},integerFormat:function(a,b){var c,d,e;if(a=parseInt(a,10),isNaN(a))return NaN;for(isNaN(b)&&(b=8),c=a+f,d=0,e=b-c.length;d<e;d++)c="0"+c;return c},moneyFormat:function(b,c){var d,e,g,h,i;if(c||(c="￥"),!(d=a.str.numberScaleFormat(b,2)))return d;for(e=d.split("."),d=e[0],g=0,h=[],i=d.length-1;i>=0;i--)3==g&&(g=0,h.push(",")),g++,h.push(d.charAt(i));return h.push(c),h.reverse(),h.push(".",e[1]),h.join(f)}}}(ui,ui.$),function(a,b){function c(){}function d(a){return parseInt(a,10)||0}function e(a,b,c){var d="";for(a<0&&(d="-",a=-a),a+="";a.length<b;)a="0"+a;return c&&a.length>b&&(a=a.substring(a.length-b)),d+a}function f(a,b,c,d){return function(f){var g=f["get"+a]();return(c>0||g>-c)&&(g+=c),0===g&&-12===c&&(g=12),e(g,b,d)}}function g(a,b){return function(c,d){var e=c["get"+a]();return d[(b?"SHORT"+a:a).toUpperCase()][e]}}function h(a){var b,c;return 0===(b=a.getTimezoneOffset())?"Z":(b*=-1,c="",b>=0&&(c+="+"),c+=b>0?e(Math.floor(b/60),2):e(Math.ceil(b/60),2),c+=":"+e(Math.abs(b%60),2))}function i(a){return function(b){var c=b.getHours(),d=c>12?"PM":"AM";return d.length>a&&(d=d.substring(0,a)),d}}function j(a){return function(b,c){c[a]=d(b)}}function k(a,b){a=a.toUpperCase(),b.AMPM="P"===a||"PM"===a?"PM":"AM",b.hours>0&&l(b.hours,b)}function l(a,b){b.hours=d(a),b.hasOwnProperty("AMPM")&&"PM"===b.AMPM&&b.hours>0&&(b.hours+=12,b.hours>=24&&(b.hours=0))}function m(a,b,c,d){var e,f;if(e=c[d],f=(4===e.length?"":"SHORT")+"MONTH_MAPPING",!s[f])return void(b.month=NaN);b.month=s[f][a]||NaN}function n(a,b,c,e,f){var g,h,i,j,k,l,m=e[f],n=b;for(l=b;l<a.length;l++)if("Z"===(k=a.charAt(l))||"+"===k||"-"===k){g=a.substring(b,l),h="Z"===k?a.substring(l,l+1):a.substring(l,l+6);break}return g&&r[m]&&(n+=g.length,r[m](g,c,e,f)),h&&"Z"!==h&&(n+=h.length,k=h.charAt(0),j=h.substring(1).split(":"),i=d(j[0]),j=d(j[1]),c.timezone=60*i,c.timezone+=j,"-"===k&&c.timezone>0&&(c.timezone=-c.timezone)),n}function o(a){var b,c;if(a===t)b=u;else{for(b=[];a;){if(!(c=v.exec(a))){b.push(a);break}b.push(c[1]),a=c[2]}b.length>0&&(t=a,u=b)}return b}function p(a){var b;return a=a.trim(),0===a.length?null:/^\d+$/.test(a)?new Date(d(a)):(b=new Date(a),isNaN(b)&&null!==(b=w.exec(a))&&(b=new Date(Number(b[1]))),isNaN(b)?null:b)}var q,r,s,t,u,v=/((?:[^yMdHhmsStZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|S|t+|Z))(.*)/,w=/^\/Date\((\d+)\)\/$/;q={yyyy:f("FullYear",4),yy:f("FullYear",2,0,!0),y:f("FullYear",1),MMMM:g("Month"),MMM:g("Month",!0),MM:f("Month",2,1),M:f("Month",1,1),dd:f("Date",2),d:f("Date",1),EEEE:g("Day"),EEE:g("Day",!0),HH:f("Hours",2),H:f("Hours",1),hh:f("Hours",2,-12),h:f("Hours",1,-12),mm:f("Minutes",2),m:f("Minutes",1),ss:f("Seconds",2),s:f("Seconds",1),S:f("Milliseconds",3),t:i(1),tt:i(2),Z:h},r={yyyy:j("year"),yy:c,y:j("year"),MMMM:m,MMM:m,MM:j("month"),M:j("month"),dd:j("date"),d:j("date"),EEEE:c,EEE:c,HH:j("hours"),H:j("hours"),hh:l,h:l,mm:j("minutes"),m:j("minutes"),ss:j("seconds"),s:j("seconds"),S:j("milliseconds"),t:k,tt:k,Z:c},s={MONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],DAY:["星期天","星期一","星期二","星期三","星期四","星期五","星期六"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],MONTH_MAPPING:{"一月":1,"二月":2,"三月":3,"四月":4,"五月":5,"六月":6,"七月":7,"八月":8,"九月":9,"十月":10,"十一月":11,"十二月":12},default:"yyyy-MM-dd HH:mm:ss",medium:"yyyy-MM-dd HH:mm",date:"yyyy-MM-dd",longDate:"yyyy-MM-dd EEEE",shortDate:"y-M",time:"HH:mm:ss",shortTime:"HH:mm",time12:"h:m:s tt",shortTime12:"h:m tt",json:"yyyy-MM-ddTHH:mm:ss.SZ"},s.SHORTMONTH=s.MONTH,s.SHORTMONTH_MAPPING=s.MONTH_MAPPING,a.date={format:function(b,c){var d,e,f,g;return d=a.core.isString(b)?p(b):b,a.core.isNumber(d)&&(d=new Date(d)),g=[],e=(a.core.isString(c)?c.trim():c)||"default",e=s[e]||e,d instanceof Date&&(f=o(e),f.forEach(function(a){var b=q[a];b?g.push(b(d,s)):g.push(a)})),g.join("")},parseJSON:function(b){return a.core.isString(b)?p(b):b instanceof Date?b:null},parse:function(b,d){var e,f,g,h,i,j,k,l,m,p,q,t;if("string"!=typeof b||!b)return null;for(e=(a.core.isString(d)?d.trim():d)||"default",e=s[e]||e,q={year:1970,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},f=o(e),j=0,m=0,p=f.length;m<p;)if(g=f[m],h="",l=m,r.hasOwnProperty(g)){if(++m<p){if("Z"===(h=f[m])){m++,i=r[h],i!==c&&a.core.isFunction(i)||(i=n),j+=i(b,j,q,f,l);continue}if(r.hasOwnProperty(h))return null;if(m++,-1===(k=b.indexOf(h,j)))return null}else k=b.length;r[g]&&r[g](b.substring(j,k),q,f,l),j=k+h.length}else m++,j+=g.length;return t=new Date(q.year,q.month-1,q.date,q.hours,q.minutes,q.seconds,q.milliseconds),q.timezone&&t.setMinutes(t.getMinutes()+q.timezone),t},locale:s}}(ui,ui.$),function(a,b){function c(b){var c,d;return c=a.core.type(b),"function"!==c&&("string"===c?(d=b,b=function(){return index.indexOf(d)>-1}):b=function(){return this.indexOf("_")>-1}),b}a.obj={clone:function(b,d){var e,f,g;if(d=c(d),"object"===(f=a.core.type(b)))e={};else{if("array"!==f)return b;e=[]}for(g in b)d.call(g)||(e[g]=b[g]);return e},deepClone:function(b,d){var e,f,g,h;if("object"===(f=a.core.type(b)))e={};else{if("array"!==f)return b;e=[]}d=c(d);for(h in b)d.call(h)||(g=b[h],e!==g&&(f=a.core.type(g),"object"===f&&a.core.isPlainObject(g)||"array"===f?e[h]=this.deepClone(g,d):e[h]=g));return e}}}(ui,ui.$),function(a,b){var c=/\?/,d=/%20/g;a.url={urlInfo:function(a){var b=document.createElement("a");return b.href=a,{source:a,protocol:b.protocol.replace(":",""),host:b.hostname,port:b.port,search:b.search,params:function(){for(var a,c={},d=b.search.replace(/^\?/,"").split("&"),e=d.length,f=0;f<e;f++)d[f]&&(a=d[f].split("="),c[a[0]]=a[1]);return c}(),file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}},getParams:function(a){for(var b,c={},d=/([^?=&]+)=([^&]+)/gi;null!==(b=d.exec(a));)c[b[1]]=b[2];return c},setParams:function(a,b){var c,d,e,f;if(b){c=this.getParams(a);for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]+"");e=a.indexOf("?"),e>=0&&(a=a(0,e)),f=[];for(d in c)c.hasOwnProperty(d)&&f.push(d+"="+c[d]);return a+"?"+f.join("&")}},appendParams:function(e,f){var g,h,i,j=[],k=function(b,c){c=a.core.isFunction(c)?c():null==c?"":c,j[j.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)};if(b.isArray(f))for(g=0;g<f.length;g++)h=f[g],h.hasOwnProperty("name")&&k(h.name,h.value);else if(b.isPlainObject(f))for(i in f)k(i,f[i]);return j.length>0?e+(c.test(e)?"&":"?")+j.join("&").replace(d,"+"):e},getLocationParam:function(a){var b=window.location.search.substr(1),c=b.match(new RegExp("(^|&)"+a+"=([^&]*)(&|$)"));return null===c?null:unescape(c[2])}}}(ui,ui.$),function(a,b){function c(b,c){if(!a.core.isFunction(b)){if(a.core.isString(b))return function(){return this[b]};throw new TypeError(a.str.format("the {0} is not String or Function.",c))}return b}a.trans={listToTree:function(b,d,e,f){var g,h,i,j,k,l,m,n,o={};if(!Array.isArray(b)||0===b.length)return null;for(d=c(d,"parentField"),e=c(e,"valueField"),f=a.core.isString(f)?f:"children",j=0,k=b.length;j<k;j++)null!==(i=b[j])&&void 0!==i&&(m=d.call(i)+""||"__",o.hasOwnProperty(m)?(g=o[m],g[f]||(g[f]=[]),g[f].push(i)):(g={},g[f]=[],g[f].push(i),o[m]=g,g["_from-list"]=!0),l=e.call(i)+"",o.hasOwnProperty(l)?(g=o[l],i[f]=g[f],o[l]=i):(i[f]=null,o[l]=i));for(n in o)if(o.hasOwnProperty(n)&&(g=o[n],g.hasOwnProperty("_from-list"))){h=g;break}return h[f]},listToGroup:function(b,d,e,f){var g,h,i,j,k,l,m={};if(!Array.isArray(b)||0===b.length)return null;for(j=a.core.isString(d)?d:"text",d=c(d,"groupField"),f=a.core.isString(f)?f:"children",g=0,h=b.length;g<h;g++)null!==(k=b[g])&&void 0!==k&&(i=d.call(k)+""||"__",m.hasOwnProperty(i)||(m[i]={},m[i][j]=i,m[i][f]=[],a.core.isFunction(e)&&e.call(this,m[i],k,i)),m[i][f].push(k));l=[];for(i in m)m.hasOwnProperty(i)&&l.push(m[i]);return l},treeEach:function(b,c,d){var e,f,g,h;if(Array.isArray(b)&&a.core.isFunction(d))for(c=a.core.isString(c)?c:"children",h=function(){return Array.isArray(this[c])&&this[c].length>0},e=0,f=b.length;e<f;e++)g=b[e],g.isNode=h,d.call(null,g),delete g.isNode,h.call(g)&&a.trans.treeEach(g[c],c,d)}}}(ui,ui.$),function(a,b){var c={getNum:function(a,b){if(isNaN(a)&&(a=0),isNaN(b)&&(b=100),b==a)return a;var c;b<a&&(c=b,b=a,a=c);var d=b-a;return a+Math.floor(Math.random()*d)}},d=new Date,e=function(a,b,c){a=a.toString(36).split(""),b=b/4|0,c=c/4|0;for(var d=b;d<=c;d++)a[d]||(a[d]=0);return a.slice(b,c+1).join("")},f=function(a){return Math.random()*(a+1)|0},g=function(a){a=a.replace(/./g,function(a){return a.charCodeAt()}).split("");for(var b=2166136261,c=a.length,d=0;d<c;d++)b=16777619*(b^a[d]);return b+=b<<13,b^=b>>7,b+=b<<3,b^=b>>17,b+=b<<5,b&=2147483647,b=b.toString(36),b.length<6&&(b+=(c%36).toString(36)),b},h=[screen.width,screen.height,navigator.plugins.length,navigator.javaEnabled(),screen.colorDepth,location.href,navigator.userAgent].join("");c.uuid=function(){var a=new Date,b=(+a+631152e6).toString(36),c=e(f(4095),0,7)+e(f(8191),0,7)+e(f(8191),0,8),i=251*Math.random()+50|0,j=[];for(b.length<9&&(b+=(a%36).toString(36));i--;)j.push(Math.random());return g(h)+g([document.documentElement.offsetWidth,document.documentElement.offsetHeight,,history.length,new Date-d].join(""))+b+c+g(j.slice(0,10).join(""))+g(j.slice(i-9).join(""))};var i=function(){return Math.floor(256*Math.random())};c.hex=function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},c.hsb=function(){return"hsb("+Math.random()+", 1, 1)"},c.rgb=function(){return"rgb("+[i(),i(),i()]+")"},c.vivid=function(a){a||(a=[[150,256],[0,190],[0,30]]);var b=function(){var b=a.splice(Math.floor(Math.random()*a.length),1)[0];return Math.floor(Math.random()*(b[1]-b[0]))+b[0]};return"rgb("+b()+","+b()+","+b()+")"},a.random=c}(ui,ui.$),function(a,b){function c(b,c){var e,f,g,h,i,j,k=this.braceIndexes;if(c||(c={}),Array.isArray(k))for(e=[].concat(this.parts),i=0,j=k.length;i<j;i++)g=k[i],f=e[g],a.str.isEmpty(f)?e[g]="":(h=d(f,b,c),a.str.isEmpty(h)&&(h=""),e[g]=h);else e=this.parts;return e.join("")}function d(b,c,d){var e,f,g,h,i;return c?(e=b.indexOf(j),e>=0&&(f=b.substring(e+1).trim(),b=b.substring(0,e).trim()),g=b.split("."),i=g.reduce(function(a,b){return a?a[b]:null},c),h=a.core.type(i),"null"===h||"undefined"===h?null:f&&d&&a.core.isFunction(d[f])?d[f].call(c,i,b):i):null}function e(a){var b,d,e,f,g;if(g=[],f={parts:g,braceIndexes:[],statusText:"",bind:c},"string"!=typeof a||0===a.length)return g.push(a),f.statusText="template error",f;for(b=0;;){if(d=a.indexOf(h,b),e=a.indexOf(i,d>-1?d:b),d<0&&e<0){g.push(a.substring(b));break}if(e>-1&&(e<d||-1===d)){if(a.charAt(e+1)!==i)throw new TypeError("字符'}'， index:"+e+"， 标记符输出格式错误，应为}}");g.push(a.substring(b,e+1)),b=e+2}else if(g.push(a.substring(b,d)),b=d+1,a.charAt(b)!==h){if(-1===e)throw new TypeError("缺少闭合标记，正确的占位符应为{text}");g.push(a.substring(b,e).trim()),f.braceIndexes.push(g.length-1),b=e+1}else g.push(a.charAt(b)),b+=1}return f}function f(a){var b,c;if(!a||"string"!=typeof a)return null;try{window.DOMParser?(c=new DOMParser,b=c.parseFromString(a,"text/xml")):(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a))}catch(a){b=void 0}if(!b||!b.documentElement||b.getElementsByTagName("parsererror").length)throw new TypeError("Invalid XML: "+a);return b}function g(a){return a}var h="{",i="}",j="|";a.parseTemplate=e,a.parseXML=f,a.parseHTML=g,
a.parseJSON=JSON.parse}(ui,ui.$),function(a,b){function c(a){var b;return f(a)?(this.callbacks.push(a),b=this.callbacks.length-1,this.pedding||(this.pedding=!0,this.run()),b):-1}function d(a){"number"==typeof a&&a>=0&&a<this.callbacks.length&&(this.callbacks[a]=!1)}function e(){var b,c,d;for(this.pedding=!1,b=this.callbacks,this.callbacks=[],c=0,d=b.length;c<d;c++)if(b[c])try{b[c]()}catch(b){a.handleError(b)}}var f,g,h,i,j,k,l,m,n,o;f=a.core.isFunction,n={callbacks:[],pedding:!1,run:null},"undefined"!=typeof setImmediate&&a.core.isNative(setImmediate)?n.run=function(){setImmediate(function(){e.call(n)})}:MessageChannel&&(a.core.isNative(MessageChannel)||"[object MessageChannelConstructor]"===MessageChannel.toString())?(g=new MessageChannel,g.port1.onmessage=function(){e.call(n)},h=g.port2,n.run=function(){h.postMessage(1)}):n.run=function(){setTimeout(function(){e.call(n)},0)},o={callbacks:[],pedding:!1,run:null},"undefined"!=typeof Promise&&a.core.isNative(Promise)?(i=Promise.resolve(),o.run=function(){i.then(function(){e.call(o)})}):(j=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||null,j&&a.core.isNative(j)?(m=1,k=new j(function(){e.call(o)}),l=document.createTextNode(String(m)),k.observe(l,{characterData:!0}),o.run=function(){m=(m+1)%2,l.data=String(m)}):o.run=n.run),a.setTask=function(a){return c.call(n,a)},a.clearTask=function(a){d.call(n,a)},a.setMicroTask=function(a){return c.call(o,a)},a.clearMicroTask=function(a){d.call(o,a)}}(ui,ui.$),function(a,b){function c(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return decodeURIComponent(a.replace(/\+/g," "))}catch(b){return a}}a.cookie={stringify:function(a,b,c){var d=[a+"="+encodeURIComponent(b)];return isFinite(c)&&"number"==typeof c?d.push("Max-Age="+c):(c=c||{},c.maxAge&&d.push("Max-Age="+c.maxAge),c.domain&&d.push("Domain="+c.domain),c.path&&d.push("Path="+c.path),c.expires&&d.push("Expires="+c.expires.toUTCString()),c.httpOnly&&d.push("HttpOnly"),c.secure&&d.push("Secure")),d.join("; ")},forEach:function(a){String(document.cookie).split(/; */).forEach(function(b){var d=b.indexOf("=");if(-1!==d){var e=b.substr(0,d).trim(),f=b.substr(++d,b.length).trim();a(e,c(f))}})},get:function(a){var b;try{this.forEach(function(c,d){if(c===a)throw b=d,""})}catch(a){}return b},getAll:function(){var a={};return this.forEach(function(b,c){b in a||(a[b]=c)}),a},set:function(a,b,c){document.cookie=this.stringify.apply(0,arguments)},remove:function(a,b){b=b||{},b.expires||(b.expires=new Date(1970,0,1)),this.set(a,"",b)},clear:function(){var a=this;this.forEach(function(b,c){a.remove(b)})}}}(ui,ui.$),function(a,b){function c(){return this.prop("cssRules")||this.prop("rules")}function d(a,b){for(var c,d=0,e=a.length;d<e&&(c=a[d],!c.selectorText||!1!==b.call(this,c,d));d++);}function e(c){var d,f;if(!(this instanceof e))return new e(c);this.styleSheet=null,a.core.isString(c)&&c.length>0?(f=b("#"+c),"STYLE"!==(d=f.nodeName())&&"LINK"!==d||(this.styleSheet=f.prop("sheet"),this.styleSheet||(this.styleSheet=f.prop("styleSheet")),this.styleSheet&&(this.styleSheet=b(this.styleSheet)))):a.core.isJQueryObject(c)?this.styleSheet=c:a.core.isDomObject(c)&&(this.styleSheet=b(c))}e.prototype={constructor:e,disabled:function(){if(0===arguments.length)return this.styleSheet.prop("disabled");this.styleSheet.prop("disabled",!!arguments[0])},getRule:function(b){var e,f=null;return a.str.isEmpty(b)?null:this.styleSheet&&0!==this.styleSheet.length?(b=b.toLowerCase(),e=c.call(this.styleSheet),d(e,function(a,c){if(a.selectorText.toLowerCase()===b)return f=a,!1}),f):null},setRule:function(d,e){var f,g,h;if(!a.str.isEmpty(d)&&e){if(!(g=this.getRule(d))){if(d=d.toLowerCase(),f=c.call(this.styleSheet),h=f.length,a.core.isFunction(this.styleSheet[0].insertRule))this.styleSheet[0].insertRule(d+" {}",h);else{if(!a.core.isFunction(this.styleSheet[0].addRule))return;this.styleSheet[0].addRule(d," ",h)}f=c.call(this.styleSheet),g=f[h]}b(g).css(e)}},removeRule:function(b){var e,f;a.str.isEmpty(b)||this.styleSheet&&0!==this.styleSheet.length&&(f=this.styleSheet[0].deleteRule,a.core.isFunction(f)||(f=this.styleSheet[0].removeRule),b=b.toLowerCase(),e=c.call(this.styleSheet),d(e,function(c,d){if(c.selectorText.toLowerCase()===b)return a.core.isFunction(f)&&f.call(this.styleSheet[0],d),!1}))}},e.createStyleSheet=function(c){var d,f,g;return a.core.isFunction(document.createStyleSheet)?(f=document.createStyleSheet(),d=f.ownerNode||f.owningElement):(g=document.getElementsByTagName("head")[0],d=document.createElement("style"),g.appendChild(d),f=document.styleSheets[document.styleSheets.length-1]),a.str.isEmpty(c)||(d.id=c),new e(b(f))},a.StyleSheet=e}(ui,ui.$),function(a,b){function c(b,c){return a.core.isString(b)?b.localeCompare(c):b<c?-1:c>b?1:0}function d(){if(!(this instanceof d))return new d;this.initialize()}d.prototype={constructor:d,initialize:function(){this.keys=null,this.items=null,this.comparer=null},sort:function(b,d){var e;a.core.isFunction(b)?(b=null,d=b):(this.keys=b,a.core.isFunction(arguments[1])&&(this.comparer=arguments[1])),this.keys=b,Array.isArray(this.keys)&&(a.core.isFunction(d)||(d=c),this.comparer=d,(e=this.keys.length)<2||(Array.isArray(this.items)||(this.items=null),this._introsort(0,e-1,2*this._floorLog2(e))))},_introsort:function(a,b,c){for(var d;b>a;){if((d=b-a+1)<=16){if(1==d)return;return 2==d?void this._compareAndSwap(a,b):3==d?(this._compareAndSwap(a,b-1),this._compareAndSwap(a,b),void this._compareAndSwap(b-1,b)):void this._insertionsort(a,b)}if(0===c)return void this._heapsort(a,b);c--,d=this.partition(a,b),this._introsort(d+1,b,c),b=d-1}},partition:function(a,b){var c=parseInt(a+(b-a)/2,10);this._compareAndSwap(a,c),this._compareAndSwap(a,b),this._compareAndSwap(c,b);var d=this.keys[c];this._swap(c,b-1);var e=a;for(c=b-1;e<c;){for(;this.comparer(this.keys[++e],d)<0;);for(;this.comparer(d,this.keys[--c])<0;);if(e>=c)break;this._swap(e,c)}return this._swap(e,b-1),e},_heapsort:function(a,b){for(var c,d=b-a+1,e=Math.floor(d/2);e>=1;e--)this._downHeap(e,d,a);for(c=d;c>1;c--)this._swap(a,a+c-1),this._downHeap(1,c-1,a)},_downHeap:function(a,b,c){for(var d,e=this.keys[c+a-1],f=this.items?this.items[c+a-1]:null;a<=Math.floor(b/2)&&(d=2*a,d<b&&this.comparer(this.keys[c+d-1],this.keys[c+d])<0&&d++,!(this.comparer(e,this.keys[c+d-1])>=0));)this.keys[c+a-1]=this.keys[c+d-1],null!==this.items&&(this.items[c+a-1]=this.items[c+d-1]),a=d;this.keys[c+a-1]=e,null!==this.items&&(this.items[c+a-1]=f)},_insertionsort:function(a,b){var c,d,e,f;for(c=a;c<b;c++){for(d=c,e=this.keys[c+1],f=this.items?this.items[c+1]:null;d>=a&&this.comparer(e,this.keys[d])<0;)this.keys[d+1]=this.keys[d],null!==this.items&&(this.items[d+1]=this.items[d]),d--;this.keys[d+1]=e,this.items&&(this.items[d+1]=f)}},_swap:function(a,b){var c=this.keys[a];this.keys[a]=this.keys[b],this.keys[b]=c,this.items&&(c=this.items[a],this.items[a]=this.items[b],this.items[b]=c)},_compareAndSwap:function(a,b){a!=b&&this.comparer(this.keys[a],this.keys[b])>0&&this._swap(a,b)},_floorLog2:function(a){for(var b=0;a>=1;)b++,a/=2;return b}},a.Introsort=d}(ui,ui.$),function(a,b){function c(){}function d(){var a,b,c,d,e,f;if((e=arguments.length)%2)throw new TypeError("arguments length error");for(a=[{x:0,y:0}],c=0;c<e;c+=2)a.push({x:parseFloat(arguments[c]),y:parseFloat(arguments[c+1])});for(a.push({x:1,y:1}),b=[],f=a.length-1,c=1;c<=f;c++){for(b[c]=1,d=c-1;d>=1;d--)b[d]+=b[d-1];b[0]=1}return function(c){var d,e,g,h;for(c<0&&(c=0),c>1&&(c=1),h={x:0,y:0},d=0;d<=f;d++)e=a[d],g=b[d],h.x+=g*e.x*Math.pow(1-c,f-d)*Math.pow(c,d),h.y+=g*e.y*Math.pow(1-c,f-d)*Math.pow(c,d);return h.y}}function e(){this.duration=500,this.fps=60,this.onBegin=!1,this.onEnd=!1,this.loop=!1,this.isStarted=!1}var f,g,h,i,j,k=["ms","moz","webkit","o"];if(f=window.requestAnimationFrame,g=window.cancelAnimationFrame,!f)for(j=0;j<k.length&&!f;j++)f=window[k[j]+"RequestAnimationFrame"],g=window[k[j]+"CancelAnimationFrame"]||window[k[j]+"CancelRequestAnimationFrame"];f||(f=function(a,b){b=b||60,setTimeout(a,1e3/b)}),g||(g=function(a){clearTimeout(a)}),i={ease:d(.25,.1,.25,1),linear:d(0,0,1,1),"ease-in":d(.42,0,1,1),"ease-out":d(0,0,.58,1),"ease-in-out":d(.42,0,.58,1)},h={easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=.5)<1?.5*Math.pow(a,2):-.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=.5)<1?.5*Math.pow(a,5):.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return 1-Math.cos(a*(Math.PI/2))},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return 1===a?1:1-Math.pow(2,-10*a)},easeInOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*--a))},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},easeInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?a*a*((1+(b*=1.525))*a-b)*.5:.5*((a-=2)*a*((1+(b*=1.525))*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((6*a-1)*(2*Math.PI)/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=.5)<1?a*a*((1+(b*=1.525))*a-b)*.5:.5*((a-=2)*a*((1+(b*=1.525))*a+b)+2)},swingFrom:function(a){var b=1.70158;return a*a*((b+1)*a-b)},swingTo:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},swing:function(a){return.5-Math.cos(a*Math.PI)/2},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+.9375):2-(7.5625*(a-=2.625/2.75)*a+.984375)},easeFromTo:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,.25)},linear:function(a){return a},sinusoidal:function(a){return-Math.cos(a*Math.PI)/2+.5},reverse:function(a){return 1-a},mirror:function(b,c){return(c=c||a.AnimationStyle.sinusoidal)(b<.5?2*b:1-2*(b-.5))},flicker:function(b){return b+=(Math.random()-.5)/5,a.AnimationStyle.sinusoidal(b<0?0:b>1?1:b)},wobble:function(a){return-Math.cos(a*Math.PI*(9*a))/2+.5},pulse:function(a,b){return-Math.cos(a*((b||5)-.5)*2*Math.PI)/2+.5},blink:function(a,b){return Math.round(a*(b||5))%2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)},none:function(a){return 0},full:function(a){return 1}},e.prototype=new a.ArrayLike,e.prototype.add=function(a,b){return 1===arguments.length&&(b=a,a=b.target),b&&(b.target=a,this.push(b)),this},e.prototype.remove=function(b){var c,d=-1;if("number"!==a.core.type(b)){for(c=this.length-1;c>=0;c--)if(this[c]===b){d=c;break}}else d=b;d<0||d>=this.length||this.splice(d,1)},e.prototype.get=function(a){var b,c;for(b=this.length-1;b>=0;b--)if(c=this[b],c.name===a)return c;return null},e.prototype.doAnimation=function(){var a,b,c,d,e,g;0!==this.length&&(a=parseInt(this.fps,10)||60,e=this.length,c=this.onEnd,this.isStarted=!0,g=this,b=(new Date).getTime(),function(){var h;h=function(){var a,i,j,k,l;for(a=(new Date).getTime(),i=a-b,d=0;d<e;d++)if(j=g[d],k=j.duration||g.duration,!(j.disabled||i<j.delay))try{k+j.delay<=i?(l=1,j.disabled=!0):l=j.ease((i-j.delay)/k),j.current=Math.ceil(j.begin+l*j.change),j.onChange(j.current,j.target,g)}catch(a){g.promise._reject(a)}g.duration<=i?(g.isStarted=!1,g.stopHandle=null,c.call(g)):g.stopHandle=f(h)},g.stopHandle=f(h,1e3/a)}())},e.prototype._prepare=function(){var b,d,e,f,g=0;for(b=0,d=this.length;b<d;b++)e=this[b],e||(this.splice(b,1),b--),e.disabled=!1,e.begin=e.begin||0,e.end=e.end||0,e.change=e.end-e.begin,e.current=e.begin,e.disabled||0===e.change?(e.disabled=!0,g++):(e.onChange=e.onChange||c,e.ease=(a.core.isString(e.ease)?i[e.ease]:e.ease)||h.easeFromTo,e.duration=e.duration||0,e.delay=e.delay||0,(f=e.duration+e.delay)>this.duration&&(this.duration=f));return this.length==g},e.prototype.start=function(b){var d,e,f,g,h,i;return this.onBegin=a.core.isFunction(this.onBegin)?this.onBegin:c,this.onEnd=a.core.isFunction(this.onEnd)?this.onEnd:c,f=new Promise(function(a,b){d=a,e=b}),f._resolve=d,f._reject=e,this.promise=f,this.isStarted||(a.core.isNumber(b)&&b>0&&(this.duration=b),this.duration=parseInt(this.duration,10)||500,g=this._prepare(),this.onBegin.call(this),i=this,g?a.setTask(function(){i.onEnd.call(i),d.call(null,i)}):(h=this.onEnd,this.onEnd=function(){this.onEnd=h,h.call(this),d.call(null,this)},this.doAnimation())),f},e.prototype.stop=function(){var a;g(this.stopHandle),this.isStarted=!1,this.stopHandle=null,(a=this.promise)&&(this.promise=null,a.catch(c),a._reject.call(null,"stop"))},e.prototype.back=function(){var a,b,c,d;for(a=0,b=this.length;a<b;a++)c=this[a],d=c.begin,c.begin=c.current||c.end,c.end=d;return this.start()},a.animator=function(a){var b=new e;return b.add.apply(b,arguments),b},a.AnimationStyle=h,a.transitionTiming=function(){var b,c;return b=[].slice.call(arguments),c=b[0],a.core.isString(c)||(c=b.join(",")),i.hasOwnProperty(c)?i[c]:(i[c]=d.apply(this,b),i[c])},a.getRequestAnimationFrame=function(){return f},a.getCancelAnimationFrame=function(){return g},a.animator.fadeIn=function(b,c){var d,e;if(b&&((!c||c<=0)&&(c=240),"block"!==b.css("dispaly")&&(d=100*parseFloat(b.css("opacity")),isNaN(d)&&(d=0,b.css("opacity",d)),b.css("display","block"),!(d>=100))))return e=a.animator({target:b,begin:d,end:100,ease:h.easeFromTo,onChange:function(a){this.target.css("opacity",a/100)}}),e.duration=c,e.start()},a.animator.fadeOut=function(b){var c,d;if(b&&((!duration||duration<=0)&&(duration=240),"none"!==b.css("dispaly")))return c=100*parseFloat(b.css("opacity")),isNaN(c)&&(c=100,b.css("opacity",c)),c<=0?void b.css("display","none"):(d=a.animator({target:b,begin:c,end:0,ease:h.easeFromTo,onChange:function(a){this.target.css("opacity",a/100)}}),d.onEnd=function(){b.css("display","none")},d.duration=duration,d.start())}}(ui,ui.$),function(a,b){function c(a,b){var c,d,e,f,g,i,j,k,l=[];a=a.slice(0).concat(a.default),e=a.length,g=b;do{if(h.exec(""),(f=h.exec(g))&&(g=f[3],f[2]||!g))for(c=0;c<e;c++)if(j=a[c],i=j.getSelector(f[1])){for(d=l.length,k=!1;d--;)if(l[d].type===j&&l[d].key===i){k=!0;break}k||l.push({type:j,key:i});break}}while(f);return l}function d(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++)if(e=a[c],b.isPrototypeOf(e))return e}function e(a,b){return a.id-b.id}function f(){if(!(this instanceof f))return new f;this.count=0,this.uid=0,this.types=Object.create(o),this.types.default=g,this.activeTypes=[],this.selectors=[]}var g,h=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,i=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g,j=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g,k=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g,l=document.documentElement,n=l.matches||l.webkitMatchesSelector||l.mozMatchesSelector||l.oMatchesSelector||l.msMatchesSelector,o=[];g={name:"UNIVERSAL",getSelector:function(){return!0},getElementKeys:function(){return[!0]}},o.push({name:"ID",getSelector:function(a){var b=a.match(i);return b?b[0].substring(1):null},getElementKeys:function(a){return a.id?[a.id]:null}}),o.push({name:"CLASS",getSelector:function(a){var b=a.match(j);return b?b[0].substring(1):null},getElementKeys:function(a){var b=a.className;if(b){if("string"==typeof b)return b.split(/\s/);if("object"==typeof b&&"baseVal"in b)return b.baseVal.split(/\s/)}return null}}),o.push({name:"TAG",getSelector:function(a){var b=a.match(k);return b?b[0].toUpperCase():null},getElementKeys:function(a){return[a.nodeName.toUpperCase()]}}),f.prototype={constructor:f,add:function(b,e){var f,g,h,i,j,k,l,m;if(a.core.isString(b)){for(l={id:this.uid++,selector:b,data:e},f=c(this.types,b),h=this.activeTypes,j=0,k=f.length;j<k;j++)g=f[j],i=d(h,g.type),i||(i=Object.create(g.type),i.map=new Map,h.push(i)),g.type,this.types.default,m=i.map.get(g.key),m||(m=[],i.map.set(g.key,m)),m.push(l);this.count++,this.selectors.push(b)}},remove:function(b,d){var e,f,g,h,i,j,k,l,m,n,o,p=0;if(a.core.isString(b)){for(o=1===arguments.length,e=c(this.types,b),g=this.activeTypes,i=0,j=e.length;i<j;i++)for(f=e[i],k=g.length;k--;)if(h=g[k],f.type.isPrototypeOf(h)&&(m=h.map.get(f.key)))for(l=m.length;l--;)n=m[l],n.selector!==b||!o&&n.data!==d||(m.splice(l,1),p++);this.count-=p}},matchesSelector:function(a,b){return n.call(a,b)},querySelectorAll:function(a,b){return b.querySelectorAll(a)},queryAll:function(a){var b,c,d,f,g,h,i,j,k,l,n;if(0===this.selectors.length)return[];for(b={},d=[],f=this.querySelectorAll(this.selectors.join[", "],a),h=0,i=f.length;h<i;h++)for(g=f[h],l=this.matches(g),j=0,k=l.length;j<k;j++)n=m[j],b[n.id]?c=b[n.id]:(c={id:n.id,selector:n.selector,data:n.data,elements:[]},b[n.id]=c,d.push(c)),c.elements.push(g);return d.sort(e)},matches:function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o;if(!a)return[];for(n={},o=[],b=this.activeTypes,d=0,f=b.length;d<f;d++)if(c=b[d],k=c.getElementKeys(a))for(g=0,h=k.length;g<h;g++)if(l=c.map.get(k[d]))for(i=0,j=l.length;i<j;i++)m=l[i],!n[m.id]&&this.matchesSelector(a,m.selector)&&(n[m.id]=!0,o.push(m));return o.sort(e)}},a.SelectorSet=f}(ui,ui.$),function(a,b){function c(a,b,c){var d=a[b];return a[b]=function(){return c.apply(a,arguments),d.apply(a,arguments)},a}function d(a){var b,c=null,d={};return l?(Object.defineProperty(a,"currentTarget",{configurable:!0,enumerable:!0,get:function(){return c}}),d.update=function(a){c=a},d.reset=function(b){Object.defineProperty(a,"currentTarget",{configurable:!0,enumerable:!0,get:l.get})}):(b=a.currentTarget,d.update=function(b){a.currentTarget=b},d.reset=function(){a.currentTarget=b}),d}function e(a,b,c){var d,e,f=[],g=b;do{if(1!==g.nodeType)break;d=a.matches(g),d.length>0&&(e={node:g,observers:d},c?f.shift(e):f.push(e)),g=g.parentElement}while(g);return f}function f(a){var b,f,g,h,i,l,m,n=1===a.eventPhase?k:j,o=n[a.type],p=!1,q=!1;if(o&&(b=e(o,a.target,1===a.eventPhase),0!==(h=b.length))){for(c(a,"stopPropagation",function(){p=!0}),c(a,"stopImmediatePropagation",function(){q=!0}),m=d(a),g=0;g<h&&!p;g++)for(f=b[g],m.update(f.node),i=0,l=f.observers.length;i<l&&!q;i++)f.observers[i].data.call(f.node,a);m.reset()}}function g(b,c,d,e){var g,h,i;b&&c&&a.core.isFunction(d)&&(g=!(!e||!e.capture),h=g?k:j,i=h[b],i||(i=new a.SelectorSet,h[b]=i,document.addEventListener(b,f,g)),i.add(c,d))}function h(a,b,c,d){var e,g,h;a&&b&&(e=!(!d||!d.capture),g=e?k:j,h=g[a],h&&(h.remove(b,c),0===h.count&&(delete g[a],document.removeEventListener(name,f,e))))}function i(a,b,c){return a.dispatchEvent(new CustomEvent(b,{bubbles:!0,cancelable:!0,detail:c}))}var j={},k={},l=a.core.isFunction(Object.getOwnPropertyDescriptor)?Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget"):null;a.on=g,a.off=h,a.fire=i}(ui,ui.$),function(a,b){function c(a){if(!(this instanceof c))return new c(a);this.copyTo.call(a,this)}function d(a){this._listeners={},this._eventTarget=a||this}c.prototype={constructor:c,copyTo:function(a){if(a){var b=this;Object.keys(b).forEach(function(c){a[c]=b[c]})}}},d.prototype={constructor:d,addEventListener:function(b,c,d,e){var f,g,h,i;for(a.core.isNumeric(d)&&isFinite(d)&&(e=d,d=null),a.core.isFunction(c)&&(d=c,c=null),f=this._listeners[b],f||(this._listeners[b]=f=[]),i=f.length,h=0,e=e||0;--i>-1;)g=f[i],g.callback===d?f.splice(i,1):0===h&&g.priority<e&&(h=i+1);f.splice(h,0,{callback:d,data:c,priority:e})},removeEventListener:function(a,b){var c,d=this._listeners[a];if(d)for(c=d.length;--c>-1;)if(d[c].callback===b)return void d.splice(c,1)},dispatchEvent:function(a){var b,c,d,e,f,g=this._listeners[a];if(g&&g.length>0){for(b=this._eventTarget,c=Array.apply([],arguments),d=g.length;--d>-1;)e=g[d],c[0]={type:a,target:b,data:e.data},f=e.callback.apply(b,c);return f}},hasEvent:function(a){var b=this._listeners[a];return b&&b.length>0},initEvents:function(a,b){var c=this;b||(b=this._eventTarget),a||(a=b.events),Array.isArray(a)&&0!==a.length&&(b.on=function(a,b,d,e){c.addEventListener(a,b,d,e)},b.off=function(a,b){c.removeEventListener(a,b)},b.fire=b.trigger=function(a){var b=Array.apply([],arguments);return c.dispatchEvent.apply(c,b)},a.forEach(function(a){b[a]=c._createEventFunction(a,b)}))},_createEventFunction:function(a,b){var c=a;return function(a,d,e){arguments.length>0&&b.on(c,a,d,e)}}},a.CustomEvent=d}(ui,ui.$),function(ui,$){function noop(){}function isJsonContent(a){return a.startsWith("application/json")||a.startsWith("text/javascript")||a.startsWith("text/json")||a.startsWith("application/javascript")}function ajax(a){var b,c,d,e,f;if(!a||!a.url)throw new TypeError("参数必须为Object并且拥有url属性");return b={responseHeadersString:"",responseHeaders:{},requestHeaders:{},querystring:a.querystring,readyState:0,uniqueID:requestIDSeed--,status:0},c=new Promise(function(a,b){d=a,e=b}),c._resolve=d,c._reject=e,b=ui.extend(c,b,httpRequestMethods),a=ensureOption(a,b),b.option=a,b.async=!(!1===a.async),(a.crossDomain&&!supportCORS||rjsonp.test(a.url))&&"json"===a.dataType&&"GET"===a.type&&(a.dataType="jsonp"),f=a.dataType,ui.extend(b,httpRequestProcessor[a.files?"upload":f]||httpRequestProcessor.ajax),b.preprocess&&(f=b.preprocess()||f),a.contentType&&b.setRequestHeader("Content-Type",a.contentType),b.setRequestHeader("Accept",accepts[f]?accepts[f]+", "+acceptsAll+"; q=0.01":acceptsAll),a.headers&&Object.keys(a.headers).forEach(function(c){b.setRequestHeader(c,a.headers[c])}),a.async&&a.timeout>0&&(b._timeoutID=setTimeout(function(){b.abort("timeout"),b.dispatch(0,"timeout")},a.timeout)),b.prepareData&&b.prepareData(),b.then(a.success).catch(a.error).finally(a.complete),0===ui.ajax.global.activeIndex&&ui.ajax.global.fire("start"),ui.ajax.global.fire("send",b,a),ui.ajax.global.activeIndex++,b.request(),b}function getScript(a,b){return ui.get(a,null,b,"script")}function getJSON(a,b,c){return ui.get(a,b,c,"json")}function upload(a,b,c,d,e,f){return ui.core.isFunction(c)&&(f=e,e=d,d=c,c=null),ui.ajax({url:a,type:"post",dataType:f,files:b,data:c,success:d,error:e})}function extendHttpProcessor(){}var msie=0,useOnload,supportCORS=!1,isLocal=!1,global=ui.core.global(),head,HttpRequest,httpRequestMethods,httpRequestProcessor,ensureOption,ajaxConverter,eventDispatcher,events=["start","success","error","complete","stop"],acceptsAll,accepts,rquery=/\?/,rjsonp=/(=)\?(?=&|$)|\?\?/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rnoContent=/^(?:GET|HEAD)$/,rnewLine=/\n/g,rcarriageReturn=/\r/g,requestIDSeed=parseInt((Math.random()+"").substring(2),10),jsonpCallbackSeed=parseInt((Math.random()+"").substring(2),10);head=document.head||document.getElementsByTagName("head")[0]||document.documentElement,global.VBArray&&(msie=document.documentMode||(global.XMLHttpRequest?7:6)),useOnload=0===msie||msie>8,msie||(supportCORS=!0),msie>=9&&(supportCORS="boolean"==typeof(new XMLHttpRequest).withCredentials);try{isLocal=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(location.protocol)}catch(a){}!function(){var types=["XMLHttpRequest","ActiveXObject('MSXML2.XMLHTTP.6.0')","ActiveXObject('MSXML2.XMLHTTP.3.0')","ActiveXObject('MSXML2.XMLHTTP')","ActiveXObject('Microsoft.XMLHTTP')"],i,len,type;for(i=0,len=types.length;i<len;i++){type=types[i];try{if(eval("new "+type)){HttpRequest=new Function("return new "+type);break}}catch(a){}}}(),acceptsAll="*/".concat("*"),accepts={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},httpRequestProcessor={ajax:{prepareData:function(){var a,b=this.option,c=ui.core.type(b.data);"string"===c?this.querystring=b.data:"null"===c||"undefined"===c?this.querystring="":"array"===c||"object"===c?isJsonContent(b.contentType)?this.querystring=JSON.stringify(b.data):this.querystring=ui.param(b.data):this.querystring=b.data+"",this.hasRequestBody=!rnoContent.test(b.type),this.hasRequestBody||(a=rquery.test(b.url)?"&":"?",this.querystring&&(b.url+=a+this.querystring,this.querystring=null),!1===b.cache&&(b.url+=a+"_time="+(new Date-0)))},request:function(){var a,b;a=this,this.xhr=new HttpRequest,this.xhr.open(this.option.type,this.option.url,this.option.async,this.option.username,this.option.password),this.mimeType&&this.xhr.overrideMimeType&&this.xhr.overrideMimeType(this.mimeType),this.option.crossDomain&&supportCORS&&!0===this.option.withCredentials&&(this.xhr.withCredentials=!0),this.option.crossDomain||(this.requestHeaders["X-Requested-With"]="XMLHttpRequest");for(b in this.requestHeaders)this.requestHeaders.hasOwnProperty(b)&&this.xhr.setRequestHeader(b,this.requestHeaders[b]+"");ui.core.isFunction(this.option.progress)&&(0===msie||msie>9)&&(this.xhr.onprogress=this.option.progress),"responseType"in this.xhr&&/^(blob|arraybuffer|text)$/.test(this.option.dataType)?(this.xhr.responseType=this.option.dataType,this.useResponseType=!0):this.useResponseType=!1,this._timeoutID&&0===this.xhr.timeout&&(clearTimeout(this._timeoutID),delete this._timeoutID,this.xhr.timeout=this.option.timeout,this.xhr.ontimeout=function(){a.dispatch(0,"timeout")}),this.xhr.send(this.hasRequestBody&&(this.formdata||this.querystring)||null),this.option.async&&4!==this.xhr.readyState?useOnload?this.xhr.onload=this.xhr.onerror=function(b){a.respond()}:this.xhr.onreadystatechange=function(){4===a.xhr.readyState&&a.respond()}:this.respond()},respond:function(a,b){var c,d,e;if(this.xhr)try{if((c=4===this.xhr.readyState)||b)if(useOnload?this.xhr.onload=this.xhr.onerror=null:this.xhr.onreadystatechange=noop,b)!c&&ui.core.isFunction(this.xhr.abort)&&this.xhr.abort();else{d=this.xhr.status,this.responseText=ui.core.isString(this.xhr.responseText)?this.xhr.responseText:"";try{this.responseXML=this.xhr.responseXML.documentElement}catch(a){}this.useResponseType&&(this.response=this.xhr.response),this.responseHeadersString=this.xhr.getAllResponseHeaders();try{e=this.xhr.statusText}catch(a){this.error=a,e="firefoxaccesserror"}d||!isLocal||this.option.crossDomain?1223===d&&(d=204):d=this.responseText?200:404,this.dispatch(d,e)}}catch(a){b||this.dispatch(500,a)}}},jsonp:{preprocess:function(){var a,b,c,d,e,f;for(a=this.option.jsonpCallback||"ui.jsonp_callback_"+jsonpCallbackSeed--,this.jsonpCallbackName=a,rjsonp.test(this.option.url)?this.option.url=this.option.url.replace(rjsonp,"$1"+a):this.option.url=this.option.url+(rquery.test(this.option.url)?"&":"?")+this.option.jsonp+"="+a,b=a.split("."),f=global,d=0,e=b.length-1;d<e;d++)c=b[d],f[c]||(f[c]={}),f=f[c];return c=b[e],f[c]=function(a){f[c]=a},this.getJsonpCallBack=function(){return f[c]},this.finally(function(){delete f[c],delete this.jsonpCallbackName,delete this.getJsonpCallBack}.bind(this)),"script"}},script:{request:function(){var a;this.xhr=document.createElement("script"),this.option.charset&&(this.xhr.charset=this.option.charset),a=this,this.xhr.onerror=this.xhr[useOnload?"onload":"onreadystatechange"]=function(){a.respond()},this.xhr.src=this.option.url,head.insertBefore(this.xhr,head.firstChild)},respond:function(a,b){var c,d,e,f;this.xhr&&(c=/loaded|complete|undefined/i.test(this.xhr.readyState),(b||c)&&(this.xhr.onerror=this.xhr.onload=this.xhr.onreadystatechange=null,d=this.xhr.parentNode,d&&d.removeChild(this.xhr),b||(e=this.jsonpCallbackName,e?(e=this.getJsonpCallBack(),f=ui.core.isFunction(e)?[500,"error"]:[200,"success"]):f=[200,"success"],this.dispatch.apply(this,f))))}},upload:{preprocess:function(){this.option.contentType=""},prepareData:function(){var a,b,c=this.option.files;b=this.option.data,a=b instanceof FormData?this.data:new FormData,c&&(Array.isArray(c)||(c=[c]),c.forEach(function(b,c){var d;if(ui.core.isDomObject(b)&&"INPUT"===b.nodeName&&"file"===b.type){if(b.files)if(b.files.length>1)for(d=0;d<b.files.length;d++)a.append(b.name+"["+d+"]",b.files[d]);else a.append(b.name,b.files[0])}else b instanceof Blob&&a.append("file_"+c,b)})),ui.core.isString(b)?a.append("fileinfo",b):ui.core.isPlainObject(b)&&Object.keys(b).forEach(function(c){a.append(encodeURIComponent(c),encodeURIComponent(b[c]))}),this.formdata=a,this.hasRequestBody=!0}}},httpRequestProcessor.jsonp.prepareData=httpRequestProcessor.ajax.prepareData,httpRequestProcessor.script.prepareData=httpRequestProcessor.ajax.prepareData,httpRequestProcessor.jsonp.request=httpRequestProcessor.script.request,httpRequestProcessor.jsonp.respond=httpRequestProcessor.script.respond,httpRequestProcessor.upload.request=httpRequestProcessor.ajax.request,httpRequestProcessor.upload.respond=httpRequestProcessor.ajax.respond,ajaxConverter={text:function(a){return a+""},xml:function(a,b){return b||ui.parseXML(a)},html:function(a){return ui.parseHTML(a)},json:function(a){return a?(a=a.replace(rnewLine,"\\\\n").replace(rcarriageReturn,"\\\\r"),JSON.parse(a)):a},script:function(a){return ui.globalEval(a),a},jsonp:function(){var a;try{a=this.getJsonpCallBack()}catch(b){a=void 0,ui.handleError("the jsonp callback is undefined.")}return a}},httpRequestMethods={setRequestHeader:function(a,b){return this.requestHeaders[a]=b,this},getAllResponseHeaders:function(){return 4===this.readyState?this.responseHeadersString:null},getResponseHeader:function(a,b){if(4===this.readyState){for(;b=rheaders.exec(this.responseHeadersString);)this.responseHeaders[b[1]]=b[2];b=this.responseHeaders[a]}return void 0===b?null:b},overrideMimeType:function(a){return this.mimeType=a,this},abort:function(a){return a=a||"abort",this.xhr&&this.respond(0,a),this},dispatch:function(a,b){var c,d,e,f=b;if(this.xhr){if(this.readyState=4,c=a>=200&&a<300||304===a){if(204===a||"HEAD"===this.option.type)f="nocontent";else if(304===a)f="notmodified";else if(void 0===this.response){d=this.option.dataType||this.mimeType,(!d&&this.responseText||this.responseXML)&&(d=this.getResponseHeader("Content-Type")||"",d=d.match(/json|xml|script|html/i)||["text"],d=d[0].toLowerCase());try{this.response=ajaxConverter[d].call(this,this.responseText||"",this.responseXML)}catch(a){c=!1,this.error=a,f="parsererror"}}}else f||(f="error"),a<0&&(a=0);this.status=a,this.statusText=f+"",this._timeoutID&&(clearTimeout(this._timeoutID),delete this._timeoutID),e=this,c?(this._resolve({response:this.response,statusText:f,ajaxRequest:this}),ui.setTask(function(){ui.ajax.global.fire("success",e,e.option,f)})):(this._reject({ajaxRequest:this,statusText:f,error:this.error}),ui.setTask(function(){ui.ajax.global.fire("error",e,e.option,f)})),delete this.xhr,ui.ajax.global.activeIndex--,ui.setTask(function(){ui.ajax.global.fire("complete",e,e.option)}),0===ui.ajax.global.activeIndex&&ui.setTask(function(){0===ui.ajax.global.activeIndex&&ui.ajax.global.fire("stop")})}}},ensureOption=function(){var a={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0,timeout:0,jsonp:"callback",withCredentials:!1},b=/^\/\//,c=/#.*$/,d=document.createElement("a");return d.href=location.href,function(e,f){var g;if(e=ui.extend({},a,e),e.type=e.type.toUpperCase(),e.contentType=e.contentType.trim(),
e.url=e.url.replace(c,"").replace(b,location.protocol+"//"),(!ui.core.isNumeric(e.timeout)||e.timeout<0)&&(e.timeout=0),!ui.core.isBoolean(e.crossDomain)){g=document.createElement("a");try{g.href=e.url,g.href="1"[0]?g.href:g.getAttribute("href",4),e.crossDomain=d.protocol+"//"+d.host!=g.protocol+"//"+g.host}catch(a){e.crossDomain=!0}}return e}}(),ui.ajax=ajax,ui.ajax.global={activeIndex:0},eventDispatcher=new ui.CustomEvent(ui.ajax.global),eventDispatcher.initEvents(events),["get","post"].forEach(function(a){ui[a]=function(b,c,d,e){return ui.core.isFunction(c)&&(e=e||d,d=c,c=null),ui.ajax({url:b,type:a,data:c,success:d,dataType:e})}}),ui.getScript=getScript,ui.getJSON=getJSON,ui.upload=upload}(ui,ui.$),function(a,b){function c(a){return a=a||0,a=parseInt(a,10),isNaN(a)&&(a=0),a=Math.round(Math.min(Math.max(0,a),255)),i.charAt((a-a%16)/16)+i.charAt(a%16)}function d(a){return i.indexOf(a.toUpperCase())}var e=/^[\#]([a-fA-F\d]{6}|[a-fA-F\d]{3})$/,f=/^rgb[\(]([\s]*[\d]{1,3}[\,]{0,1}[\s]*){3}[\)]$/i,g=/^rgba[\(]([\s]*[\d]{1,3}[\,][\s]*){3}(([\d])|(([0])?[\.][\d]+))[\)]$/i,h=/(([\d]*[\.][\d]+)|([\d]+))/gm,i="0123456789ABCDEF";a.color={parseRGB:function(a){var b;return f.test(a)&&(b=a.match(h))?{red:parseInt(b[0],10),green:parseInt(b[1],10),blue:parseInt(b[2],10)}:null},parseRGBA:function(a){var b;return g.test(a)&&(b=a.match(h))?{red:parseInt(b[0],10),green:parseInt(b[1],10),blue:parseInt(b[2],10),alpha:parseFloat(b[3])}:null},parseHex:function(b){var c,e,f;if(a.str.isEmpty(b))return null;if("#"===b.charAt(0)&&(b=b.substring(1)),3===b.length)for(e="",c=0;c<b.length;c++)e+=b.charAt(c)+b.charAt(c);else e=b;return f={},b=e.substring(0,2),f.red=16*d(b.charAt(0))+d(b.charAt(1)),b=e.substring(2,4),f.green=16*d(b.charAt(0))+d(b.charAt(1)),b=e.substring(4,6),f.blue=16*d(b.charAt(0))+d(b.charAt(1)),f},rgb2hex:function(a,b,d){return"#"+c(a)+c(b)+c(d)},overlay:function(a,b,c){var d,i,j,k;isNaN(c)&&(c=.5),d=function(a){var b;return e.test(a)?this.parseHex(a):f.test(a)||g.test(a)?(b=a.match(h),{red:parseInt(b[0],10),green:parseInt(b[1],10),blue:parseInt(b[2],10)}):a},a=d.call(this,a),b=d.call(this,b),i=[a.red||0,a.green||0,a.blue||0],j=[b.red||0,b.green||0,b.blue||0],k=[];for(var l=0,m=i.length;l<m;l++)k[l]=Math.floor((1-c)*i[l]+c*j[l]);return{red:k[0],green:k[1],blue:k[2]}}}}(ui,ui.$),function(a,b){function c(a,b){return a=(""+a).replace(/_/g,"."),b=b||1,a=String(a).split("."),a=a[0]+"."+(a[1]||"0"),a=Number(a).toFixed(b)}function d(a,b,c){a.name=b,a.version=c,a[b]=c}var e,f,g,h,i=(navigator.platform||"").toLowerCase(),j=navigator.userAgent.toLowerCase(),k=k;e={name:void 0!==window.orientation?"iPod":(i.match(/mac|win|linux/i)||[k])[0],version:0,iPod:0,iPad:0,iPhone:0,iOS:0,android:0,windowsPhone:0,win:0,linux:0,mac:0},(h=j.match(/windows ([\d.]+)/))?d(e,"win",c(h[1])):(h=j.match(/windows nt ([\d.]+)/))?d(e,"win",c(h[1])):(h=j.match(/linux ([\d.]+)/))?d(e,"linux",c(h[1])):(h=j.match(/mac ([\d.]+)/))?d(e,"mac",c(h[1])):(h=j.match(/ipod ([\d.]+)/))?d(e,"iPod",c(h[1])):(h=j.match(/ipad[\D]*os ([\d_]+)/))?d(e,"iPad",c(h[1])):(h=j.match(/iphone[\D]*os ([\d_]+)/))?d(e,"iPhone",c(h[1])):(h=j.match(/android ([\d.]+)/))?d(e,"android",c(h[1])):(h=j.match(/windows phone ([\d.]+)/))&&d(e,"windowsPhone",c(h[1])),(e.iPhone||e.iPad)&&(e.iOS=e.iPhone||e.iPad),f={name:k,version:0,ie:0,edge:0,firefox:0,chrome:0,opera:0,safari:0,mobileSafari:0,adobeAir:0},(h=j.match(/edge\/([\d.]+)/))?d(f,"edge",c(h[1])):(h=j.match(/trident.*; rv\:([\d.]+)/))?d(f,"ie",c(h[1])):(h=j.match(/msie ([\d.]+)/))?d(f,"ie",c(h[1])):(h=j.match(/firefox\/([\d.]+)/))?d(f,"firefox",c(h[1])):(h=j.match(/chrome\/([\d.]+)/))?d(f,"chrome",c(h[1])):(h=j.match(/opera.([\d.]+)/))?d(f,"opera",c(h[1])):(h=j.match(/adobeair\/([\d.]+)/))?d(f,"adobeAir",c(h[1])):(h=j.match(/version\/([\d.]+).*safari/))&&d(f,"safari",c(h[1])),(h=j.match(/version\/([\d.]+).*mobile.*safari/))&&d(f,"mobileSafari",c(h[1])),e.iPad&&d(f,"mobileSafari","0.0"),f.ie&&(document.documentMode?document.documentMode!==Math.floor(f.ie)&&d(f,"ie",c(document.documentMode)):document.documentMode=Math.floor(f.ie)),g={name:k,version:0,trident:0,gecko:0,webkit:0,presto:0},(h=j.match(/trident\/([\d.]+)/))?d(g,"trident",c(h[1])):(h=j.match(/gecko\/([\d.]+)/))?d(g,"gecko",c(h[1])):(h=j.match(/applewebkit\/([\d.]+)/))?d(g,"webkit",c(h[1])):(h=j.match(/presto\/([\d.]+)/))&&d(g,"presto",c(h[1])),f.ie&&(6==f.ie?d(g,"trident",c("4")):7!=f.ie&&8!=f.ie||d(g,"trident",c("5"))),a.platform=e,a.browser=f,a.engine=g}(ui,ui.$),function(a,b){function c(){if(!(this instanceof c))return new c;this.initialize()}c.fitCenter=function(){this.displayWidth=this.originalWidth,this.displayHeight=this.originalHeight,this.marginTop=0,this.marginLeft=0,this.width>this.height?(this.originalHeight>this.height&&(this.displayHeight=this.height),this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.displayWidth>this.width?(this.displayWidth=this.width,this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.marginTop=Math.floor((this.height-this.displayHeight)/2)):(this.marginLeft=Math.floor((this.width-this.displayWidth)/2),this.marginTop=Math.floor((this.height-this.displayHeight)/2))):(this.displayWidth>this.width&&(this.displayWidth=this.width),this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.displayHeight>this.height?(this.displayHeight=this.height,this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.marginLeft=Math.floor((this.width-this.displayWidth)/2)):(this.marginLeft=Math.floor((this.width-this.displayWidth)/2),this.marginTop=Math.floor((this.height-this.displayHeight)/2)))},c.centerCrop=function(){this.displayWidth=this.originalWidth,this.displayHeight=this.originalHeight,this.marginTop=0,this.marginLeft=0,this.width>this.height?(this.displayHeight=this.height,this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.displayWidth>this.width?this.marginLeft=-Math.floor((this.displayWidth-this.width)/2):this.displayWidth<this.width&&(this.displayWidth=this.width,this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.marginTop=-Math.floor((this.displayHeight-this.height)/2))):(this.displayWidth=this.width,this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.displayHeight>this.height?this.marginTop=-Math.floor((this.displayHeight-this.height)/2):this.displayHeight<this.height&&(this.displayHeight=this.height,this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.marginLeft=-Math.floor((this.displayWidth-this.width)/2)))},c.prototype={constructor:c,initialize:function(){this.src=null,this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.originalWidth=0,this.originalHeight=0},load:function(b,d,e,f){if(!a.core.isString(b)||0===b.length)throw new TypeError("图片src不正确");this.src=b,this.width=d,this.height=e;var g=this;return a.core.isFunction(f)||(f=c.fitCenter),new Promise(function(a,c){var d=new Image;d.onload=function(){d.onload=null,g.originalWidth=d.width,g.originalHeight=d.height,f.call(g),a(g)},d.onerror=function(){c(d)},d.src=b})}},a.ImageLoader=c,b.fn.setImage=function(b,c,d,e){var f,g,h,i;if("IMG"==this.nodeName())return i=this,a.core.isPlainObject(b)&&(f=b,b=f.src,c=f.width,d=f.height,e=f.fillMode),g=this.parent(),arguments.length<2?"BODY"==g.nodeName()?(c=root.clientWidth,d=root.clientHeight):(c=g.width(),d=g.height()):a.core.isNumber(c)&&a.core.isNumber(d)||(c=320,d=240),a.core.isFunction(e)||(e=a.ImageLoader.fitCenter),h=a.ImageLoader(),h.load(b,c,d,e).then(function(a){var c={"vertical-align":"top"};return c.width=a.displayWidth+"px",c.height=a.displayHeight+"px",c["margin-top"]=a.marginTop+"px",c["margin-left"]=a.marginLeft+"px",i.css(c),i.prop("src",b),a},function(b){return i.prop("src",a.text.empty),b})}}(ui,ui.$),function(a,b){function c(){}function d(a){var b,c,d,e,f;for(b=a.split("."),c=g,e=0,f=b.length;e<f;e++)d=b[e],c[d]||(c[d]={}),c=c[d];return c}function e(a,b){var c,e,f,h={name:null,namespace:null,fullName:a,constructor:b};return f=a.lastIndexOf("."),f<0?(h.namespace=a,h.name=a,e=g[h.name],h.constructor=g[h.name]=b):(h.namespace=a.substring(0,f),h.name=a.substring(f+1),c=d(h.namespace),e=c[h.name],h.constructor=c[h.name]=b),e&&(b.getOriginal=function(){return e}),h}function f(b,c,d,f){var g,h,i={};return a.core.isFunction(f)||(f=function(){}),g=e(b,f),c?(h=a.core.isFunction(c)?c.prototype:c,h=a.extend({},h)):h={name:"",namespace:""},Object.keys(d).forEach(function(b){var c=d[b];if(a.core.isFunction(c)){var e=h[b];a.core.isFunction(e)&&(delete d[b],i[b]=function(){var a=function(){return h[b].apply(this,arguments)},d=function(a){return h[b].apply(this,a)};return function(){var b,e=this._super,f=this._superApply;return this._super=a,this._superApply=d,b=c.apply(this,arguments),this._super=e,this._superApply=f,b}}())}}),g.constructor.prototype=a.extend({},h,d,i,g),g.constructor}var g=a.core.global();a.define=function(b,d,e){var g;return a.core.isString(b)&&0!==b.length?(e||(e=d,d=null),d||(d={}),a.core.isFunction(d._initialize)||(d._initialize=c),g=f(b,d,e,function(a,b){if(!(this instanceof g))return new g(a,b);this._initialize(a,b)})):null}}(ui,ui.$),function(a,b){function c(b){var c;1===b.which&&(c={target:b.target,option:this.option},c.currentX=this.currentX=b.pageX,c.currentY=this.currentY=b.pageY,a.core.isFunction(this.option.onBeginDrag)&&!1===this.option.onBeginDrag.call(this,c)||(g.on("mousemove",this.onMouseMoveHandler).on("mouseup",this.onMouseUpHandler).on("mouseleave",this.onMouseUpHandler),document.onselectstart=function(){return!1},this.option.target.addClass("cancel-user-select"),this._isDragStart=!0,this.shield&&h.append(this.shield)))}function d(b){var c={target:b.target,option:this.option};this._isDragStart&&(c.x=b.clientX-this.currentX,c.y=b.clientY-this.currentY,c.currentX=this.currentX=b.clientX,c.currentY=this.currentY=b.clientY,a.core.isFunction(this.option.onMoving)&&this.option.onMoving.call(this,c))}function e(b){var c={target:b.target,option:this.option};1===b.which&&this._isDragStart&&(this._isDragStart=!1,this.currentX=this.currentY=null,g.off("mousemove",this.onMouseMoveHandler).off("mouseup",this.onMouseUpHandler).off("mouseleave",this.onMouseUpHandler),document.onselectstart=null,this.option.target.removeClass("cancel-user-select"),a.core.isFunction(this.option.onEndDrag)&&this.option.onEndDrag.call(this,c),this.shield&&this.shield.remove())}function f(a){if(!(this instanceof f))return new f(a);this.initialize(a)}var g=b(document),h=b(document.body),i={context:null,target:null,handle:null,parent:h,hasIframe:!1,onBeginDrag:null,onMoving:null,onEndDrag:null};f.prototype={constructor:f,initialize:function(a){this.doc=null,this.shield=null,this.isTurnOn=!1,this.option=b.extend({},i,a),this.doc=this.option.doc,!0===this.option.hasIframe&&(this.shield=b("<div class='drag-shield'>"),this.shield.css({position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%","z-index":"999999","background-color":"#fff",opacity:".01"})),this.onMouseDownHandler=c.bind(this),this.onMouseMoveHandler=d.bind(this),this.onMouseUpHandler=e.bind(this)},on:function(){var a,b=this.option.target,c=this.option.handle,d=this.option.parent;this.isTurnOn||(this.isTurnOn=!0,d.isNodeName("body")||(a=d.css("position"),this.originParentPosition=a,"absolute"!==a&&"relative"!==a&&"fixed"!==a&&d.css("position","relative")),this.originTargetPosition=b.css("position"),"absolute"!==this.originTargetPosition&&b.css("position","absolute"),c.on("mousedown",this.onMouseDownHandler),this.option.target&&this.option.target.data("mouse-dragger",this))},off:function(){var a=this.option.handle;this.isTurnOn&&(this.isTurnOn=!1,a.off("mousedown",this.onMouseDownHandler).css("position",this.originTargetPosition),this._isDragStart&&this.onMouseUpHandler({target:document,which:1}),this.option.parent.css("position",this.originParentPosition))}},a.MouseDragger=f,b.fn.draggable=function(b){var c,d,e;if(b&&b.target&&b.parent&&a.core.isDomObject(this[0])&&"BODY"!==this.nodeName())return b.handle=this,b.getParentCssNum=function(a){return parseFloat(b.parent.css(a))||0},a.core.isFunction(b.onBeginDrag)&&(d=b.onBeginDrag),b.onBeginDrag=function(a){var b,c,e=this.option,f=e.parent.offset();f||(f={top:0,left:0}),d&&d.call(null,a),c=e.parent.getBoundingClientRect(),b=e.target.getBoundingClientRect(),e.topLimit=f.top+e.getParentCssNum("border-top")+e.getParentCssNum("padding-top"),e.leftLimit=f.left+e.getParentCssNum("border-left")+e.getParentCssNum("padding-left"),e.rightLimit=f.left+c.width,e.bottomLimit=f.top+c.height,e.targetWidth=b.width,e.targetHeight=b.height,e.parentTop=f.top,e.parentLeft=f.left},a.core.isFunction(b.onMoving)&&(e=b.onMoving),b.onMoving=function(a){var b=this.option,c=b.target.position();e&&e.call(null,a),c.top=c.top+b.parentTop,c.left=c.left+b.parentLeft,c.top+=a.y,c.left+=a.x,c.top<b.topLimit?c.top=b.topLimit:c.top+b.targetHeight>b.bottomLimit&&(c.top=b.bottomLimit-b.targetHeight),c.left<b.leftLimit?c.left=b.leftLimit:c.left+b.targetWidth>b.rightLimit&&(c.left=b.rightLimit-b.targetWidth),c.top=c.top-b.parentTop,c.left=c.left-b.parentLeft,b.target.css({top:c.top+"px",left:c.left+"px"})},c=a.MouseDragger(b),c.on(),this},b.fn.undraggable=function(){var a;0!==this.length&&(a=this.data("mouse-dragger"))&&a instanceof f&&a.off()}}(ui,ui.$),function(a,b){function c(b,c){var d=document.getElementById(a.theme.highlightSheetId),e=c;d&&(e||(e=d.href,e=a.url.setParams({highlight:b.Id})),d.href=e),a.theme.currentHighlight=b,a.page.fire("hlchanged",a.theme.currentHighlight)}a.theme={currentTheme:"Light",currentHighlight:null,defaultHighlight:"Default",highlightSheetId:"highlight",getHighlight:function(a){var b,c,d,e;if(a||(a=this.defaultHighlight),Array.isArray(this.highlights))for(d=0,e=this.highlights.length;d<e;d++)if(c=this.highlights[d],c.Id===a){b=c;break}return b},changeHighlight:function(b,d){a.post(b,{themeId:d.Id},function(a){a.Result&&c(d)},"json")},setHighlight:function(a,b){a&&c(a,b)},initHighlight:function(){var b,c,d;b=document.getElementById(this.highlightSheetId),b&&(c=b.href,d=a.url.getParams(c).highlight),this.currentHighlight=this.getHighlight(d)||null,this.currentHighlight&&a.page.fire("hlchanged",this.currentHighlight)}}}(ui,ui.$),function(a,b){function c(){}function d(a){this.$errors||(this.$errors=[]),this.$errors.push(a)}function e(a){var b=Object.keys(a);return b.sort(function(a,b){var c=h[a]||i,d=h[b]||i;return c===d?0:c<d?-1:1}),b}a.eventPriority={masterReady:3,pageReady:2,bodyResize:3,elementResize:2,ctrlResize:1};var f={_resizeDelay:200,_resizeTimeoutHandler:null,events:["themechanged","hlchanged","ready","htmlclick","docmouseup","resize","hashchange","keydown","loaded"],$config:{model:null,created:null,layout:null,load:null,destroy:null,error:null}},g={},h={},i=100;f.event=new a.CustomEvent(f),f.event.initEvents(),f.init=function(b){var c,f=this.$config.model;a.core.isPlainObject(b)&&(f=a.extend(!0,{},f,b.model),delete b.model,this.$config=a.extend({},this.$config,b),this.$config.model=f),c=function(b){var c=this.$config,f=c.error,h=this;c.error=null,a.core.isFunction(f)||(f=d),e(c).forEach(function(b){var d=c[b];try{g.hasOwnProperty(b)?g[b].call(h,d):a.core.isFunction(d)&&d.call(h)}catch(a){a.cycleName=b,f.call(h,a)}}),this.$errors&&(this.$errors.forEach(function(b){console.log(b);var c=a.str.format("page init error. [{0}] {1}",b.cycleName,b.message);a.errorShow?a.errorShow(c):console.error(c)}),delete this.$errors)}.bind(this),this.$isInitAlready||(this.ready(c),this.$isInitAlready=!0)},f.plugin=function(b){if(b&&b.name&&a.core.isFunction(b.handler)){if(this.$config[b.name])throw new Error("the name "+b.name+" is exists.");this.$config[b.name]=c,g[b.name]=b.handler,h[b.name]=b.rank||++i}},f.get=function(b){return b&&g[b]?function(b,c,d){return{getName:function(){return d},setHandler:function(c){a.core.isFunction(c)&&(b[d]=c)},setRank:function(b){a.core.isNumber(b)&&(c[d]=b)}}}(g,h,b):null},f.plugin({name:"created",handler:function(b){a.core.isFunction(b)&&b.call(this)}}),f.plugin({name:"layout",handler:function(b){var c;a.core.isFunction(b)&&(c=b.bind(this),c(),this.resize(c,a.eventPriority.elementResize))}}),f.plugin({name:"load",handler:function(b){var c,d=function(){this.fire("loaded")}.bind(this);if(a.core.isFunction(b)&&(c=b.call(this))&&a.core.isFunction(c.then))return void c.then(d,d);d()}}),f.plugin({name:"destroy",handler:function(a){}}),b(document).ready(function(a){f.fire("ready")}).on("click",function(a){f.fire("htmlclick",a.target)}),b(window).on("resize",function(a){f._resizeTimeoutHandler&&clearTimeout(f._resizeTimeoutHandler),f._resizeTimeoutHandler=setTimeout(function(){f._resizeTimeoutHandler=null,f.fire("resize")},f._resizeDelay)}).on("hashchange",function(a){var b="";window.location.hash&&(b=window.location.hash),f.fire("hashchange",b)}),a.page=f}(ui,ui.$),function(a,b){function c(){}function d(b){this.classEventMap=new a.KeyArray,this.exclusiveFlag={},this.length=this.classEventMap.length,this.eventName=b||"NONE"}function e(c){return!c||a.core.isJQueryObject(c)?c:b(c)}function f(){var a,b,c,d;for(a={},c=0,d=arguments.length;c<d;c++)b=arguments[c],Array.isArray(b)&&b.forEach(function(b){a.hasOwnProperty(b)||(a[b]=!0)});return Object.keys(a)}function g(b,c,d){var e,g,h;return a.core.isString(b)&&0!==b.length?(e=b.indexOf("."),e<0?b="ui.ctrls."+b:"ui"!==b.substring(0,e)&&(b="ui."+b),d||(d=c,c=a.ctrls.ControlBase),g=a.define(b,c,d),h=a.core.isFunction(c)?c.prototype:c,a.core.isFunction(h._defineOption)&&(g.prototype.option=a.extend(!0,{},h.option,h._defineOption())),a.core.isFunction(h._defineEvents)&&(g.prototype.events=f(h._defineEvents(),h.events)),g):null}a.ctrls={},d.prototype={getClassNames:function(){return this.classEventMap.keys()},call:function(a){var b=Array.prototype.slice.call(arguments,1),c=this.classEventMap.get(a);Array.isArray(c)?c.forEach(function(a){a.apply(null,b)}):c.apply(null,b)},add:function(b,c,d,e){var f;if(!a.core.isFunction(c))throw new TypeError("the delegate event handler is not a function.");f=this.classEventMap.get(b),d&&(Array.isArray(f)?(f.push(c),c=f):a.core.isFunction(f)&&(c=[f,c])),this.classEventMap.set(b,c),this.exclusiveFlag[b]=void 0===e||!!e,this.length=this.classEventMap.length},remove:function(b,c){var d;a.core.isFunction(c)?(d=this.classEventMap.get(b),Array.isArray(d)?this.classEventMap.set(b,d.filter(function(a){return a===c})):this.classEventMap.remove(b)):this.classEventMap.remove(b),this.length=this.classEventMap.length},has:function(a){return this.classEventMap.containsKey(a)},getDelegateHandler:function(c){var d=this;return a.core.isFunction(c)||(c=function(){return!1}),function(a){var e,f,g,h=b(a.target),i=d.length;if(0!==i)for(e=d.getClassNames();;){if(0===h.length||c(h))return;for(g=0;g<i;g++)if(f=e[g],h.hasClass(f)&&(d.call(f,a,h),d.exclusiveFlag[f]))return;h=h.parent()}}}},a.define("ui.ctrls.ControlBase",{version:a.version,i18n:function(){return a.i18n("control",this.toString())},_initialize:function(b,c){var d,g,h;return this.document=document,this.window=window,this.element=e(c)||null,this.constructor&&this.constructor.prototype&&(g=this.constructor.prototype.option,h=this.constructor.prototype.events),this.option=a.extend(!0,{},g,this._defineOption(),b)||{},d=f(h,this._defineEvents()),d.length>0&&(this.eventDispatcher=new a.CustomEvent(this),this.eventDispatcher.initEvents(d)),this._create(),this._render(),this},_defineOption:c,_defineEvents:c,_create:c,_render:c,defineProperty:function(b,c,d){var e,f={};if(!a.core.isString(b)||0===b.length)throw new TypeError("参数propertyName只能是String类型并且不能为空");if("undefined"!=typeof Reflect&&a.core.isFunction(Reflect.defineProperty))e=Reflect.defineProperty;else{if(!a.core.isFunction(Object.defineProperty))return;e=Object.defineProperty}a.core.isFunction(c)&&(f.get=c.bind(this)),a.core.isFunction(d)&&(f.set=d.bind(this)),f.enumerable=!1,f.configurable=!1,e(this,b,f)},createClassEventDelegate:function(a){return new d},toString:function(){return this.fullName}}),a.ctrls.define=g}(ui,ui.$),function(a,b){function c(a){var b,c;if(0!==i.length){for(c=[];;){if(!(b=i.shift()))break;a&&a===b.ctrl||"retain"===b.func.call(b.ctrl)&&c.push(b)}i.push.apply(i,c)}}function d(a,b,c,d,e,f){var g,h,i,j,k;return g={top:d,left:0},g.topOffset=-d,h=b.parent().position(),"hidden"===a.css("overflow")?(i=a.width(),j=a.height()):(k=a[0],i=k.scrollWidth,j=k.scrollHeight,i+=k.scrollLeft,j+=k.scrollTop),h.top+d+f>j?h.top-f>0&&(g.top=-f-1,g.topOffset=d):g.top+=1,h.left+e>i&&(h.left-(h.left+e-i)>0?g.left=-(h.left+e-i):g.left=-h.left),g}function e(a){var b=this.element.width(),c=parseFloat(this.element.css("padding-right"))||0,d=a.offsetX;d||(d=a.clientX-this.element.offset().left),b-c-d<0&&this.isShow()?(this.element.css("cursor","pointer"),this._clearable=!0):(this.element.css("cursor","auto"),this._clearable=!1)}function f(b){var c,d,e;this._clearable&&(c=this.element.width(),d=parseFloat(this.element.css("padding-right"))||0,e=b.offsetX,e||(e=b.clientX-this.element.offset().left),c-d-e<0&&a.core.isFunction(this._clear)&&this._clear())}function g(b){a.hideAll(this),this.show()}function h(a){a.stopPropagation()}var i=[];a.page.htmlclick(function(a,d){var e=b(d);e.isNodeName("body")||e.hasClass("cancel-dropdown-html-click")||c()}),a.addHideHandler=function(b,c){b&&a.core.isFunction(c)&&i.push({ctrl:b,func:c})},a.hideAll=function(a){c(a)},a.ctrls.define("ui.ctrls.DropDownBase",{_create:function(){this.setLayoutPanel(this.option.layoutPanel),this.onMousemoveHandler=e.bind(this),this.onMouseupHandler=f.bind(this),this.fadeAnimator=a.animator({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("opacity",a/100)}}).add({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("transform","translateY("+a+"px)")}}),this.fadeAnimator.duration=240},_render:function(b){var c;this.element&&(b||(b={focus:g.bind(this)}),a.core.isFunction(b.click)||(b.click=h),c=this,Object.keys(b).forEach(function(a){c.element.on(a,b[a])}))},wrapElement:function(a,c){if(c&&(this._panel=c,!this.hasLayoutPanel()))return void b(document.body).append(this._panel);if(a){var d={display:a.css("display"),position:a.css("position"),"margin-left":a.css("margin-left"),"margin-top":a.css("margin-top"),"margin-right":a.css("margin-right"),"margin-bottom":a.css("margin-bottom"),width:a[0].offsetWidth+"px",height:a[0].offsetHeight+"px"};"relative"!==d.position&&"absolute"!==d.position||(d.top=a.css("top"),d.left=a.css("left"),d.right=a.css("right"),d.bottom=a.css("bottom")),d.position="relative",0===d.display.indexOf("inline")?(d.display="inline-block",d["vertical-align"]=a.css("vertical-align"),a.css("vertical-align","top")):d.display="block";var e=b("<div class='dropdown-wrap cancel-dropdown-html-click' />").css(d);return a.css("margin",0).wrap(e),e=a.parent(),c&&e.append(c),e}},isWrapped:function(a){return a||(a=this.element),a&&a.parent().hasClass("dropdown-wrap")},moveToElement:function(a,c){if(a){var d;!c&&this.element&&this.element[0]===a[0]||(this.hasLayoutPanel()?(d=this.isWrapped(a)?a.parent():this.wrapElement(a),d.append(this._panel)):b(document.body).append(this._panel))}},initPanelWidth:function(b){a.core.isNumber(b)||(b=this.element?this.element.getBoundingClientRect().width:100),this.panelWidth=b-2,this._panel.css("width",this.panelWidth+"px")},hasLayoutPanel:function(){return!!this.layoutPanel},setLayoutPanel:function(b){this.option.layoutPanel=b,this.layoutPanel=a.getJQueryElement(this.option.layoutPanel)},isShow:function(){return this._panel.hasClass(this._showClass)},show:function(b){a.addHideHandler(this,this.hide);var c,e,f,g,h,i,j;this.isShow()||(this._panel.addClass(this._showClass),this._panel.css("opacity","0"),h=this.element.getBoundingClientRect(),f=h.width,g=h.height,h=this._panel.getBoundingClientRect(),c=h.width,e=h.height,this.hasLayoutPanel()?i=d(this.layoutPanel,this.element,f,g,c,e):(i=a.getDownLocation(this.element,c,e),i.topOffset=-g,j=this.element.offset(),i.top<j.top?(i.top-=1,i.topOffset=g):i.top+=1),this._panel.css({top:i.top+"px",left:i.left+"px",transform:"translateY("+i.topOffset+"px)"}),this.panelLocation=i,this._show(this._panel,b))},_show:function(b,c){var d,e,f=this;a.core.isFunction(c)||(c=void 0),d=this._clearClass?function(){f.element.addClass(f._clearClass),f.element.on("mousemove",f.onMousemoveHandler),f.element.on("mouseup",f.onMouseupHandler),c&&c.call(f)}:c,this.fadeAnimator.stop(),e=this.fadeAnimator[0],e.target=b,e.begin=100*parseFloat(e.target.css("opacity"))||0,e.end=100,e=this.fadeAnimator[1],e.target=b,e.begin=this.panelLocation.topOffset,e.end=0,b.css("display","block").addClass("cancel-dropdown-html-click"),this.fadeAnimator.onEnd=d,this.fadeAnimator.start().then(function(){b.removeClass("cancel-dropdown-html-click")})},hide:function(a){this.isShow()&&(this._panel.removeClass(this._showClass),this.element.removeClass(this._clearClass),this.element.off("mousemove",this.onMousemoveHandler),this.element.off("mouseup",this.onMouseupHandler),this.element.css("cursor","auto"),this._hide(this._panel,a))},_hide:function(b,c){var d;a.core.isFunction(c)||(c=void 0),this.fadeAnimator.stop(),d=this.fadeAnimator[0],d.target=b,d.begin=100*parseFloat(d.target.css("opacity"))||100,d.end=0,d=this.fadeAnimator[1],d.target=b,d.begin=0,d.end=this.panelLocation.topOffset,this.fadeAnimator.onEnd=c,this.fadeAnimator.start().then(function(a){d.target.css("display","none")})},_clear:function(){}})}(ui,ui.$),function(a,b){a.ctrls.define("ui.ctrls.SidebarBase",{showTimeValue:300,hideTimeValue:300,_defineOption:function(){return{parent:null,width:240,hasCloseButton:!0}},_defineEvents:function(){return["showing","shown","hiding","hidden","resize"]},_create:function(){this.parent=a.getJQueryElement(this.option.parent),this.parent||(this.parent=b(document.body)),this._showClass="ui-sidebar-show",this.height=0,this.width=this.option.width||240,this.borderWidth=0},_render:function(){var c=this;this._panel=b("<aside class='ui-sidebar-panel border-highlight' />"),this._panel.css("width",this.width+"px"),this.option.hasCloseButton&&(this._closeButton=b("<button class='ui-side-close-button font-highlight-hover' />"),this._closeButton.append("<i class='far fa-angle-right'></i>"),this._closeButton.on("click",function(a){c.hide()})),this.element&&this._panel.append(this.element),this._panel.append(this._closeButton),this.parent.append(this._panel),this.borderWidth+=parseInt(this._panel.css("border-left-width"),10)||0,this.borderWidth+=parseInt(this._panel.css("border-right-width"),10)||0,setTimeout(function(){var a=this.width;this.width=0,c.setSize(a,this.parent.height())}.bind(this)),a.page.resize(function(){c.setSize(this.width,this.parent.height())}.bind(this),a.eventPriority.ctrlResize),this.animator=a.animator({target:this._panel,ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}})},set:function(c){if(this.element&&this.element.remove(),a.core.isDomObject(c))c=b(c);else if(!a.core.isJQueryObject(c))return;this.element=c,this._closeButton.before(c)},append:function(c){if(a.core.isDomObject(c))c=b(c);else if(!a.core.isJQueryObject(c))return;this._panel.append(c),this.element||(this.element=c)},setSize:function(b,c,d){var e,f=this.width,g=this.height,h={};a.core.isNumber(b)&&b>0&&b!==f&&(this.width=b,h.width=b+"px"),a.core.isNumber(c)&&c>0&&c!==g&&(this.height=c,h.height=c+"px"),(h.width||h.height)&&(this._panel.css(h),h.width&&(e=this.parent.width(),this.hideLeft=e,this.left=e-this.width-this.borderWidth,this.isShow()?this._panel.css({left:this.left+"px",display:"block"}):this._panel.css({left:this.hideLeft+"px",display:"none"})),!1!==d&&this.fire("resize",this.width,this.height))},isShow:function(){return this._panel.hasClass(this._showClass)},show:function(){var b,c,d,e=this;if(!this.isShow()){if(!1===this.fire("showing"))return a.PromiseEmpty;for(this.animator.stop(),this.animator.splice(1,this.length-1),this.animator.duration=this.showTimeValue,b=this.animator[0],b.target.css("display","block"),b.target.addClass(this._showClass),b.begin=parseFloat(b.target.css("left"))||this.hideLeft,b.end=this.left,c=0,d=arguments.length;c<d;c++)arguments[c]&&this.animator.add(arguments[c]);return this.animator.onEnd=function(){this.splice(1,this.length-1),e.fire("shown")},this.animator.start()}return a.PromiseEmpty},hide:function(){var b,c,d,e=this;if(this.isShow()){if(!1===this.fire("hiding"))return a.PromiseEmpty;for(this.animator.stop(),this.animator.splice(1,this.length-1),this.animator.duration=this.hideTimeValue,b=this.animator[0],b.target.removeClass(this._showClass),b.begin=parseFloat(b.target.css("left"))||this.left,b.end=this.hideLeft,c=0,d=arguments.length;c<d;c++)arguments[c]&&this.animator.add(arguments[c]);return this.animator.onEnd=function(){this.splice(1,this.length-1),b.target.css("display","none"),e.fire("hidden")},this.animator.start()}return a.PromiseEmpty}})}(ui,ui.$),function(a,b){function c(){}function d(a){return a<10?"0"+a:""+a}function e(b,c){return b||(b=""),a.core.isNumber(c)?"<span>"+a.str.moneyFormat(c,b)+"</span>":null}function f(b){return a.date.parseJSON(b)}var g,h,i,j="_RowspanContext";new Error("column.len或width设置太小，无法绘制进度条！");g={checkAll:function(a){var c=b("<i class='fa fa-square grid-checkbox-all' />");return this.columnResetter.add(function(){c.removeClass("fa-check-square").addClass("fa-square")}),c},columnText:function(a){var c=b("<span class='table-cell-text' />"),d=a.text;return void 0===d||null===d?null:(c.text(d),c)},empty:function(a){return null}},h={text:function(a,c){var d;return"undefined"===(a+="")||"null"===a||"NaN"===a?null:(d=b("<span class='table-cell-text' />"),d.text(a),d)},empty:function(a,b){return null},rowNumber:function(a,c,d){var e;return"no-count"===a?null:(e=b("<span />"),e.text((this.pageIndex-1)*this.pageSize+(d+1)),e)},check:function(a,c){var d=b("<i class='fa fa-square grid-checkbox' />");return d.attr("data-value",a+""),d},paragraph:function(a,c){var d;return"undefined"===(a+="")||"null"===a||"NaN"===a?null:(d=b("<p class='table-cell-block' />"),d.text(a),d)},date:function(a,c){var e,g=f(a);return null===g?null:(e=b("<span />"),isNaN(g)?e.text("无法转换"):e.text([g.getFullYear(),"-",d(g.getMonth()+1),"-",d(g.getDate())].join("")),e)},time:function(a,c){var e,g=f(a);return null===g?null:(e=b("<span />"),isNaN(g)?e.text("无法转换"):e.text([d(g.getHours()),":",d(g.getMinutes()),":",d(g.getSeconds())].join("")),e)},datetime:function(a,c){var e,g=f(a);return null===g?null:(e=b("<span />"),isNaN(g)?e.text("无法转换"):e.text([g.getFullYear(),"-",d(g.getMonth()+1),"-",d(g.getDate())," ",d(g.getHours()),":",d(g.getMinutes()),":",d(g.getSeconds())].join("")),e)},shortDatetime:function(a,c){var e,g=f(a);return null===g?null:(e=b("<span />"),isNaN(g)?e.text("无法转换"):e.text([g.getFullYear(),"-",d(g.getMonth()+1),"-",d(g.getDate())," ",d(g.getHours()),":",d(g.getMinutes())].join("")),e)},money:function(a,b){return e("￥",a)},cellPhone:function(a,c){var d;if(a)return d=b("<span />"),11===a.length?d.text(a.substring(0,3)+"-"+a.substring(3,7)+"-"+a.substring(7)):d.text(a),d},rowspan:function(a,c,d,e){var f;if(0===d)f=c[j]={rowSpan:1,value:a,td:e};else{if(f=c[j],f.value===a)return f.rowSpan++,f.td.prop("rowSpan",f.rowSpan),e.isAnnulment=!0,null;f.rowSpan=1,f.value=a,f.td=e}return b("<span />").text(a)}},i={getBooleanFormatter:function(c,d,e){return c+="",d+="",2===arguments.length&&(e="--"),function(f,g){var h={};if(!0===f)h.text=c,h.color="green";else{if(!1!==f)return b("<span />").text(e);h.text=d,h.color="red"}return a.ctrls.Tag(h).label}},getNumberFormatter:function(c){return function(d,e){return a.core.isNumber(d)?b("<span />").text(a.str.numberScaleFormat(d,c)):null}},getMoneyFormatter:function(a){return function(b,c){return e(a,c)}},getProgressFormatter:function(c,d){
return(!a.core.isNumber(c)||c<60)&&(c=!1),b.isNumeric(d)?d<1&&(d=null):d=null,function(e,f,g,h){var i,j,k,l,m,n,o;return j={},a.core.isNumber(e[0])?(j.value=e[0],j.total=d||e[1]||0):(j.value=e,j.total=d||0),0===j.total&&(j.total=1),a.core.isNumber(j.value)||(j.value=0),o=j.value/j.total,isNaN(o)&&(o=0),o=a.str.numberScaleFormat(100*o,2)+"%",i=b("<div class='cell-progress-panel' />"),k=b("<div class='cell-progress-bar' />"),n=c,a.core.isNumber(n)||(n=f.len-12),n-=52,k.css("width",n+"px"),l=b("<div class='cell-progress-value background-highlight' />"),l.css("width",o),k.append(l),m=b("<div class='cell-progress-text font-highlight'/>"),m.append("<span style='margin:0'>"+o+"</span>"),i.append(k),i.append(m),i.append("<br clear='all' />"),i}},getRowspanFormatter:function(a,b){return function(c,d,e,f){var g;if(0===e)g=d[j]={rowSpan:1,value:c[a],td:f};else{if(g=d[j],g.value===c[a])return g.rowSpan++,g.td.prop("rowSpan",g.rowSpan),f.isAnnulment=!0,null;g.rowSpan=1,g.value=c[a],g.td=f}return b.apply(this,arguments)}},getImageFormatter:function(c,d,e,f,g){var h,i;return(!a.core.isNumber(c)||c<=0)&&(c=120),(!a.core.isNumber(d)||d<=0)&&(d=90),e?e+="":e="",i=function(a){var c,d=this.target,e=d.parent().parent(),f=e.parent(),g=f.parent(),h=g[0].rows.length,i=f[0].rowIndex+a;do{if(i<0||i>=h)return!1;c=b(g[0].rows[i].cells[e[0].cellIndex]).children(),d=c.children("img"),i+=a}while(c.hasClass("failed-image"));return d},h=a.ctrls.ImageZoomer({getNext:function(){return i.call(this,1)||null},getPrev:function(){return i.call(this,-1)||null},hasNext:function(){return!!i.call(this,1)},hasPrev:function(){return!!i.call(this,-1)}}),function(a,i,j,k){var l,m;return a?(l=b("<div class='grid-small-image' style='overflow:hidden;' />"),m=b("<img style='cursor:crosshair;' />"),l.css({width:c+"px",height:d+"px"}),l.append(m),m.setImage(e+a,c,d,g).then(function(a){m.addImageZoomer(h)},function(a){var b={originalWidth:120,originalHeight:90,width:c,height:d};m.attr("alt","请求图片失败"),f&&(m.prop("src",f),g.call(b),m.css({"vertical-align":"top",width:b.displayWidth+"px",height:b.displayHeight+"px","margin-top":b.marginTop+"px","margin-left":b.marginLeft+"px"}),m.addClass("default-image")),l.addClass("failed-image")}),l):"<span>暂无图片</span>"}},hoverView:function(d,e,f){return(!a.core.isNumber(d)||d<=0)&&(d=160),(!a.core.isNumber(e)||e<=0)&&(e=160),a.core.isFunction(f)||(f=c),function(c,g,h){var i,j=g._HoverView;return j||(j=a.ctrls.HoverView({width:d,height:e}),j._contextCtrl=this,j.showing(function(a){var b,c,d;this.clear(),c=parseInt(this.target.attr("data-rowIndex"),10),b=this._contextCtrl.getRowData(c),(d=f.call(this._contextCtrl,b))&&this.append(d)}),g._HoverView=j),i=b("<a href='javascript:void(0)' class='grid-hover-target' />"),i.text(c+" "),i.addHoverView(j),i.attr("data-rowIndex",h),i}},switchButton:function(d,e){return a.core.isFunction(d)||(d=c),a.core.isString(e)||(e=null),function(c,f,g){var h,i;return h=b("<input type='checkbox' />"),h.prop("checked",!!c),i=h.switchButton({thumbColor:"Light"===a.theme.currentTheme?"#666666":"#888888",style:e}),i.changed(d),h.data("switchButton",i),i.switchBox}}},a.ColumnStyle={emptyColumn:{text:g.empty,formatter:h.empty},multipleEmptyColumn:function(b){var c={text:g.empty,formatter:h.empty};return a.core.isNumber(b)&&b>1&&(c.rowspan=b),c},isEmpty:function(a){return a===this.emptyColumn||a&&a.text===g.empty&&a.formatter===h.empty},cnfn:g,cfn:h,cfnp:i}}(ui,ui.$),function(a,b){a.mask={maskId:"#ui_mask_rectangle",isOpen:function(){return"block"===b(this.maskId).css("display")},open:function(c,d){var e,f=b(this.maskId),g=b(document.body);return a.core.isPlainObject(c)&&(d=c,c=null),c||(c=d.target),c=a.getJQueryElement(c),c||(c=g),d||(d={}),d.color=d.color||"#000000",d.opacity=d.opacity||.6,d.animate=!1!==d.animate,0===f.length&&(f=b("<div class='mask-panel' />"),f.prop("id",this.maskId.substring(1)),g.append(f),a.page.resize(function(a,b,c){f.css({height:c+"px",width:b+"px"})},a.eventPriority.ctrlResize),this._mask_animator=a.animator({target:f,onChange:function(a){this.target.css("opacity",a/100)}}),this._mask_animator.duration=500),f.css("background-color",d.color),this._mask_data={option:d,target:c},"BODY"===c.nodeName()?(this._mask_data.overflow=g.css("overflow"),"hidden"!==this._mask_data.overflow&&g.css("overflow","hidden"),f.css({top:"0",left:"0",width:document.documentElement.clientWidth+"px",height:document.documentElement.clientHeight+"px"})):(e=c.getBoundingClientRect(),f.css({top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px"})),d.animate?(f.css({display:"block",opacity:"0"}),this._mask_animator[0].begin=0,this._mask_animator[0].end=100*d.opacity,this._mask_animator.start()):f.css({display:"block",opacity:d.opacity}),f},close:function(){var a,c;a=b(this.maskId),0!==a.length&&(c=this._mask_data,this._mask_data=null,"BODY"===c.target.nodeName()&&c.target.css("overflow",c.overflow),c.option.animate?(this._mask_animator[0].begin=60,this._mask_animator[0].end=0,this._mask_animator.start().then(function(){a.css("display","none")})):a.css("display","none"))}}}(ui,ui.$),function(a,b){function c(a){if(!(this instanceof c))return new c(a);this.initialize(a)}c.prototype={constructor:c,initialize:function(a){a||(a={}),this.pageNumPanel=null,this.pageInfoPanel=null,this.pageButtonCount=5,this.pageIndex=1,this.pageSize=100,this.data=[],this.pageInfoFormatter=a.pageInfoFormatter,b.isNumeric(a.pageIndex)&&a.pageIndex>0&&(this.pageIndex=a.pageIndex),(b.isNumeric(a.pageSize)||a.pageSize>0)&&(this.pageSize=a.pageSize),(b.isNumeric(a.pageButtonCount)||a.pageButtonCount>0)&&(this.pageButtonCount=a.pageButtonCount),this._ex=Math.floor((this.pageButtonCount-1)/2)},renderPageList:function(a){var c=this._createPageInfo();(!b.isNumeric(a)||a<1)&&(a=this.data?this.data.length||0:0),c.pageIndex=this.pageIndex,c.pageSize=this.pageSize,c.rowCount=a,c.pageCount=Math.floor((a+this.pageSize-1)/this.pageSize),this.pageInfoPanel&&(this.pageInfoPanel.html(""),this._showRowCount(c)),this._renderPageButton(c.pageCount),c.pageCount&&this._checkAndSetDefaultPageIndexHash(this.pageIndex)},_showRowCount:function(a){var c=this.data?this.data.length:0;if(1==a.pageCount?a.currentRowNum=a.rowCount<a.pageSize?a.rowCount:a.pageSize:a.currentRowNum=c<a.pageSize?c:a.pageSize,this.pageInfoFormatter)for(var d in this.pageInfoFormatter)this.pageInfoFormatter.hasOwnProperty(d)&&b.isFunction(this.pageInfoFormatter[d])&&this.pageInfoPanel.append(this.pageInfoFormatter[d].call(this,a[d]))},_createPageInfo:function(){return{rowCount:-1,pageCount:-1,pageIndex:-1,pageSize:-1,currentRowNum:-1}},_renderPageButton:function(a){if(this.pageNumPanel){this.pageNumPanel.empty();var b=this.pageIndex-this._ex;b=b<1?1:b;var c=b+this.pageButtonCount-1;c=c>a?a:c,c-b+1<this.pageButtonCount&&(b=c-(this.pageButtonCount-1)>0?c-(this.pageButtonCount-1):1),b>1&&this.pageNumPanel.append(this._createPageButton("1..."));for(var d,e=b;e<=c;e++)d=e==this.pageIndex?this._createCurrentPage(e):this._createPageButton(e),this.pageNumPanel.append(d);c<a&&this.pageNumPanel.append(this._createPageButton("..."+a))}},_createPageButton:function(a){return"<a class='pager-button font-highlight-hover'>"+a+"</a>"},_createCurrentPage:function(a){return"<span class='pager-current font-highlight'>"+a+"</span>"},pageChanged:function(c,d){var e;this.pageNumPanel&&b.isFunction(c)&&(d=d||a,this.pageChangedHandler=function(){c.call(d,this.pageIndex,this.pageSize)},e=this,(!a.core.ie||a.core.ie>=8)&&a.page.hashchange(function(a,b){if(e._breakHashChanged)return void(e._breakHashChanged=!1);e._isPageHashChange(b)&&(e.pageIndex=e._getPageIndexByHash(b),e.pageChangedHandler())}),this.pageNumPanel.on("click",function(c){var d=b(c.target);if("A"===d.nodeName()){var f=d.text();f=f.replace("...",""),f=parseInt(f,10),e.pageIndex=f,(!a.core.ie||a.core.ie>=8)&&e._setPageHash(e.pageIndex),e.pageChangedHandler()}}))},empty:function(){this.pageNumPanel&&this.pageNumPanel.html(""),this.pageInfoPanel&&this.pageInfoPanel.html(""),this.data=[],this.pageIndex=1},_setPageHash:function(a){a&&(this._breakHashChanged=!0,window.location.hash="page="+a)},_isPageHashChange:function(a){var b=0;return!!a&&("#"===a.charAt(0)&&(b=1),a.indexOf("page")==b)},_getPageIndexByHash:function(a){var b,c;return a&&(c=a.indexOf("="))>=0?(b=a.substring(c+1,a.length),parseInt(b,10)):1},_checkAndSetDefaultPageIndexHash:function(a){var b=window.location.hash,c=b.length;"#"===b.charAt(0)&&c--,c<=0&&this._setPageHash(a)}},a.ctrls.Pager=c}(ui,ui.$),function(a,b){var c,d,e;c={up:function(){var a,b,c;a=this.getParentSize(),c=this,b=this.animator[0],b.begin=a.height,b.end=(a.height-this.offsetHeight)/2,b.onChange=function(a){c.box.css("top",a+"px")},this.openMask(),this.animator.onEnd=function(){c.onShown()},this.box.css({top:b.begin+"px",left:(a.width-this.offsetWidth)/2+"px",display:"block"})},down:function(){var a,b,c;a=this.getParentSize(),c=this,b=this.animator[0],b.begin=-this.offsetHeight,b.end=(a.height-this.offsetHeight)/2,b.onChange=function(a){c.box.css("top",a+"px")},this.openMask(),this.animator.onEnd=function(){c.onShown()},this.box.css({top:b.begin+"px",left:(a.width-this.offsetWidth)/2+"px",display:"block"})},left:function(){var a,b,c;a=this.getParentSize(),c=this,b=this.animator[0],b.begin=-this.offsetWidth,b.end=(a.width-this.offsetWidth)/2,b.onChange=function(a){c.box.css("left",a+"px")},this.openMask(),this.animator.onEnd=function(){c.onShown()},this.box.css({top:(a.height-this.offsetHeight)/2+"px",left:b.begin+"px",display:"block"})},right:function(){var a,b,c;a=this.getParentSize(),c=this,b=this.animator[0],b.begin=a.width,b.end=(a.width-this.offsetWidth)/2,b.onChange=function(a){c.box.css("left",a+"px")},this.openMask(),this.animator.onEnd=function(){c.onShown()},this.box.css({top:(a.height-this.offsetHeight)/2+"px",left:b.begin+"px",display:"block"})},fadein:function(){var a,b,c;a=this.getParentSize(),c=this,b=this.animator[0],b.begin=0,b.end=100,b.onChange=function(a){c.box.css("opacity",a/100)},this.openMask(),this.animator.onEnd=function(){c.onShown()},this.box.css({top:(a.height-this.offsetHeight)/2+"px",left:(a.width-this.offsetWidth)/2+"px",opacity:0,display:"block"})}},d={up:function(){var a,b;b=this,a=this.animator[0],a.begin=parseFloat(this.box.css("top")),a.end=-this.offsetHeight,a.onChange=function(a){b.box.css("top",a+"px")},this.closeMask(),this.animator.onEnd=function(){b.onHidden()}},down:function(){var a,b,c;a=this.getParentSize(),c=this,b=this.animator[0],b.begin=parseFloat(this.box.css("top"),10),b.end=a.height,b.onChange=function(a){c.box.css("top",a+"px")},this.closeMask(),this.animator.onEnd=function(){c.onHidden()}},left:function(){var a,b;b=this,a=this.animator[0],a.begin=parseFloat(this.box.css("left"),10),a.end=-this.offsetWidth,a.onChange=function(a){b.box.css("left",a+"px")},this.closeMask(),this.animator.onEnd=function(){b.onHidden()}},right:function(){var a,b,c;a=this.getParentSize(),c=this,b=this.animator[0],b.begin=parseFloat(this.box.css("left"),10),b.end=a.width,b.onChange=function(a){c.box.css("left",a+"px")},this.closeMask(),this.animator.onEnd=function(){c.onHidden()}},fadeout:function(){var a,b;b=this,a=this.animator[0],a.begin=100,a.end=0,a.onChange=function(a){b.box.css("opacity",a/100)},this.closeMask(),this.animator.onEnd=function(){b.onHidden()},this.box.css({opacity:1,display:"block"})}},e={closable:function(a){var c,d=this;return c=b("<a href='javascript:void(0)'>×</a>"),c.attr("class",a.className||"closable-button font-highlight-hover"),c.on("click",function(){d.hide()}),c},maximizable:function(a){var c,d=this;return c=b("<a href='javascript:void(0)'><i class='fa fa-window-maximize'></i></a>"),c.attr("class",a.className||"maximizable-button font-highlight-hover"),c.on("click",function(){d._maximize(!d.isMaximizeState,c)}),c}},a.ctrls.define("ui.ctrls.DialogBox",{_defineOption:function(){return{title:"",titleHeight:48,show:"up",hide:"down",done:"up",src:null,parent:null,hasIframe:!1,width:640,height:480,maskable:!0,buttons:[],operatePanelHeight:48,suitable:!0,resizeable:!1,draggable:!0,style:null,boxCtrls:["closable"]}},_defineEvents:function(){return["showing","shown","hiding","hidden","resize"]},_create:function(){var b;this.box=null,this.mask=null,this.buttons=[],this.isMaximizeState=!1,this.animator=a.animator(),this.animator.duration=500,a.core.isNumber(this.option.width)||(this.option.width=640),a.core.isNumber(this.option.height)||(this.option.height=480),this.option.titleHeight=parseInt(this.option.titleHeight,10)||48,this.offsetWidth=this.width=this.option.width,this.offsetHeight=this.height=this.option.height,this.contentWidth=this.width,this.contentHeight=0,b=this,a.core.each("show, hide, done",function(a){b[a+"Async"]=function(b){this._asyncCall(a,b)}})},_render:function(){this.box=b("<div class='ui-dialog-box border-highlight' />"),this.titlePanel=b("<section class='ui-dialog-box-title' />"),this.contentPanel=b("<section class='ui-dialog-box-content' />"),this.operatePanel=null,this.box.append(this.titlePanel).append(this.contentPanel),this._initTitle(),this._iniBoxCtrlsButton(),this._initContent(),this._initOperateButtons(),this.animator.add({target:this.box,ease:a.AnimationStyle.easeFromTo}),this.parent=a.getJQueryElement(this.option.parent),this.parent?this.getParentSize=function(){return{width:this.parent.width(),height:this.parent.height()}}:(this.parent=b(document.body),this.getParentSize=function(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}),this.maskable()&&(this.mask=b("<div class='ui-dialog-box-mask' />"),this.parent.append(this.mask),this.animator.add({target:this.mask,ease:a.AnimationStyle.easeFrom})),this.parent.append(this.box),this.draggable()&&this._initDraggable(),this.resizeable()&&this._initResizeable(),this._initSuitable(),a.core.isPlainObject(this.option.style)&&this.box.css(this.option.style),this.titlePanel.css("height",this.option.titleHeight+"px"),this.contentPanel.css({height:this.contentHeight+"px",top:this.option.titleHeight+"px"})},_initTitle:function(){var b=this.option.title;a.core.isPlainObject(b)?this.setTitle(b.text,b.hasHr,b.style):b&&this.setTitle(b)},_iniBoxCtrlsButton:function(){var c,d=this;c=this.option.boxCtrls,Array.isArray(c)&&0!==c.length&&(this.boxCtrls=b("<div class='ui-dialog-box-ctrls' />"),c.forEach(function(b){var c,f,b;if(a.core.isString(b))b={type:b};else if(a.core.isFunction(b))return void((f=b.call(d))&&d.boxCtrls.append(f));(c=e[b.type])&&(f=c.call(d,b),a.core.isPlainObject(b.css)&&f.css(b.css),d.boxCtrls.append(f))}),this.box.append(this.boxCtrls))},_initContent:function(){this.option.src&&(this.option.hasIframe=!0,this.element=b("<iframe class='content-frame' frameborder='0' scrolling='auto' />"),this.element.prop("src",this.option.src)),this.contentPanel.append(this.element)},_initOperateButtons:function(){var b,c;for(Array.isArray(this.option.buttons)||(a.core.isString(this.option.buttons)?this.option.buttons=[this.option.buttons]:this.option.buttons=[]),b=0,c=this.option.buttons.length;b<c;b++)this.addButton(this.option.buttons[b])},_initDraggable:function(){var a={target:this.box,parent:this.parent,hasIframe:this.hasIframe()};this.titlePanel.addClass("draggable-handle").draggable(a)},_initResizeable:function(){var c;this.resizeHandle=b("<u class='resize-handle' />"),this.box.append(this.resizeHandle),c={context:this,target:this.box,handle:this.resizeHandle,parent:b(document.body),hasIframe:this.hasIframe(),minWidth:320,minHeight:240,onMoving:function(a){var b,d,e,f=this.option;b=f.context,d=b.offsetWidth+a.x,e=b.offsetHeight+a.y,d<c.minWidth&&(d=c.minWidth),e<c.minHeight&&(e=c.minHeight),b._setSize(d,e)}},this.resizer=a.MouseDragger(c),this.resizer.on()},_initSuitable:function(){var b,c=this;this.suitable()?(b=function(a,b,d){c._calculateSize(b,d)},b(),a.page.resize(b,a.eventPriority.ctrlResize)):this._setSize(this.width,this.height,!1)},_maximize:function(b,c){var d,e=this.getParentSize();b!==this.isMaximize&&(this.maximizeAnimator||(this.maximizeAnimator=a.animator({target:this.box,onChange:function(a){this.target.css("top",a+"px")}}).add({target:this.box,onChange:function(a){this.target.css("left",a+"px")}}).add({target:this.box,onChange:function(a){this.target.css("width",a+"px")}}).add({target:this.box,onChange:function(a){this.target.css("height",a+"px")}}),this.maximizeAnimator.onBegin=function(){this.contentPanel.css("display","none"),this.operatePanel&&this.operatePanel.css("display","none")}.bind(this),this.maximizeAnimator.onEnd=function(){this.contentPanel.css("display","block"),this.operatePanel&&this.operatePanel.css("display","block"),this._setSize(this.maximizeAnimator[2].end,this.maximizeAnimator[3].end)}.bind(this),this.maximizeAnimator.duration=500),this.maximizeAnimator.isStarted||(b?(this.isMaximizeState=!0,c.html("<i class='fa fa-window-restore'></i>"),this.resizeHandle&&this.resizeHandle.css("display","none"),d=this.maximizeAnimator[0],d.begin=parseFloat(this.box.css("top"))||0,d.end=0,d=this.maximizeAnimator[1],d.begin=parseFloat(this.box.css("left"))||0,d.end=0,d=this.maximizeAnimator[2],d.begin=this.offsetWidth,d.end=e.width,d=this.maximizeAnimator[3],d.begin=this.offsetHeight,d.end=e.height,this.maximizeAnimator.start()):(this.isMaximizeState=!1,c.html("<i class='fa fa-window-maximize'></i>"),this.resizeHandle&&this.resizeHandle.css("display","block"),this.maximizeAnimator.back())))},_calculateSize:function(b,c){var d,e,f;f=this.getParentSize(),a.core.isNumber(b)||(b=f.width),a.core.isNumber(c)||(c=f.height),d=this.option.width,e=.85*c,this.height>e&&(e=this.height>c?c:this.height),d>b&&(d=b),this.setSize(d,e,b,c)},_setSize:function(b,c,d){var e=Math.floor(parseFloat(this.box.css("border-top-width")))||0,f=Math.floor(parseFloat(this.box.css("border-bottom-width")))||0,g=Math.floor(parseFloat(this.box.css("border-left-width")))||0,h=Math.floor(parseFloat(this.box.css("border-right-width")))||0;a.core.isNumber(b)&&b>0&&(this.offsetWidth=b,this.width=this.offsetWidth-g-h,this.box.css("width",this.width+"px"),this.contentWidth=this.width),a.core.isNumber(c)&&c>0&&(this.offsetHeight=c,this.height=this.offsetHeight-e-f,this.box.css("height",this.height+"px"),this._updateContentPanelHeight()),!1!==d&&this.fire("resize")},_updateContentPanelHeight:function(){this.contentHeight=this.height-this.option.titleHeight-(this.operatePanel?this.option.operatePanelHeight:0),this.contentPanel.css("height",this.contentHeight+"px")},_asyncCall:function(b,c){var d=null;a.core.isFunction(this[b])&&(d=this[b].call(this))&&a.core.isFunction(c)&&d.then(c)},maskable:function(){return!!this.option.maskable},suitable:function(){return!!this.option.suitable},resizeable:function(){return!!this.option.resizeable},draggable:function(){return!!this.option.draggable},hasIframe:function(){return!!this.option.hasIframe},setTitle:function(c,d,e){var f,g;a.core.isString(c)?f=b("<span class='title-text font-highlight' />").text(c):a.core.isDomObject(c)?f=b(c):a.core.isJQueryObject(c)&&(f=c),this.titlePanel.empty(),g=b("<div class='title-inner-panel' />"),g.append(f),!1!==d&&(d=!0),d&&g.append("<hr class='ui-dialog-box-spline background-highlight' />"),this.titlePanel.append(g),Array.isArray(e)?e.forEach(function(a){this.titlePanel.addClass(a)}.bind(this)):a.core.isPlainObject(e)&&this.titlePanel.css(e)},addButton:function(c){if(c=a.getJQueryElement(c))return this.operatePanel||(this.operatePanel=b("<section class='ui-dialog-box-operate' />"),this.box.append(this.operatePanel),this._updateContentPanelHeight(),this.fire("resize")),this.operatePanel.append(c),this},isShow:function(){return"block"===this.box.css("display")},show:function(b){return this.animator.isStarted||this.isShow()?a.PromiseEmpty:!1===this.fire("showing")?a.PromiseEmpty:a.core.isFunction(b)||(b=c[this.option.show],a.core.isFunction(b))?(b.call(this),this.animator.start()):a.PromiseEmpty},hide:function(b){return this.animator.isStarted||!this.isShow()?a.PromiseEmpty:!1===this.fire("hiding")?a.PromiseEmpty:a.core.isFunction(b)||(b=d[this.option.hide],a.core.isFunction(b))?(b.call(this),this.animator.start()):a.PromiseEmpty},done:function(b){return a.core.isFunction(b)||(b=d[this.option.done],a.core.isFunction(b))?this.hide(b):a.PromiseEmpty},onShown:function(){this.fire("shown")},onHidden:function(){this.box.css("display","none"),this.maskable()&&(this.parent.css("overflow",this._oldBodyOverflow),this.mask.css("display","none")),this.fire("hidden")},openMask:function(){var a,b=this.getParentSize();this.maskable()&&(this._oldBodyOverflow=this.parent.css("overflow"),this.parent.css("overflow","hide"),this.mask.css({display:"block",opacity:0,height:b.height+"px"}),a=this.animator[1],a.begin=0,a.end=70,a.onChange=function(a){this.target.css("opacity",a/100)})},closeMask:function(){var a;this.maskable()&&(a=this.animator[1],a.begin=70,a.end=0,a.onChange=function(a){this.target.css("opacity",a/100)})},setSize:function(b,c,d,e,f){var g=this.getParentSize(),h=a.core.isNumber(d),i=a.core.isNumber(e);h||(d=g.width),i||(e=g.height),h&&i&&(this.getParentSize=function(){return{width:d,height:e}}),this._setSize(b,c),this.box.css(a.core.isFunction(f)?f.call(this,d,e):{top:(e-this.offsetHeight)/2+"px",left:(d-this.offsetWidth)/2+"px"}),this.maskable()&&this.mask.css("height",e+"px")}}),b.fn.dialogBox=function(b){return 0===this.length?null:a.ctrls.DialogBox(b,this)},a.ctrls.DialogBox.setShowStyle=function(b,d){a.core.isString(b)&&b.length>0&&a.core.isFunction(d)&&(c[b]=d)},a.ctrls.DialogBox.setHideStyle=function(b,c){a.core.isString(b)&&b.length>0&&a.core.isFunction(c)&&(d[b]=c)}}(ui,ui.$),function(a,b){function c(a){if(!(this instanceof c))return new c(a);this.initialize(a)}var d;c.prototype={constructor:c,initialize:function(b){b||(b={}),this.delay=b.delay,("number"!==a.core.type(this.delay)||this.delay<0)&&(this.delay=1e3),this.timeoutHandle=null,this.isOpening=!1,this.box=null,this.openCount=0},getBox:function(){return this.box||(this.box=b("#loadingElement")),this.box},isShow:function(){return"block"===this.getBox().css("display")},show:function(){var a;if(this.isOpening||this.isShow())return void this.openCount++;this.isOpening=!0,a=this,this.timeoutHandle=setTimeout(function(){a.timeoutHandle=null,a._doShow()},this.delay)},_doShow:function(){this.getBox(),this.box.addClass("c_dotsPlaying").css("display","block")},hide:function(){return this.openCount>0?void this.openCount--:(this.isOpening=!1,this.timeoutHandle?void clearTimeout(this.timeoutHandle):(this.getBox(),void this.box.removeClass("c_dotsPlaying").css("display","none")))}},d=c(),a.loadingShow=function(){d.show()},a.loadingHide=function(){d.hide()}}(ui,ui.$),function(a,b){function c(){if(!(this instanceof c))return new c;this.initialize()}function d(a,b){b||(b=f.message),e.show(a,b)}var e,f={message:0,warn:1,error:3,success:4,failed:5};c.prototype={constructor:c,initialize:function(){this.box=null,this.type=f,this.isStartHide=!1,this.boxAnimator=null,this.width=322,this.top=88},_initAnimator:function(){this.boxAnimator=a.animator({target:this.box,ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}}),this.boxAnimator.duration=200},getIcon:function(a){return a===f.warn?"mb-warn fas fa-exclamation-triangle":a===f.error?"mb-error fas fa-times-circle":a===f.success?"mb-success far fa-check-circle":a===f.failed?"mb-failed far fa-times-circle":"mb-message fas fa-comment-dots"},getBox:function(){var a,c;if(!this.box){a=document.documentElement.clientWidth,c=document.documentElement.clientHeight,this.box=b("<div class='ui-message-box border-highlight' />"),this.box.css({top:this.top+"px",left:a+"px","max-height":c-2*this.top+"px"});var d=b("<a href='javascript:void(0)' class='closable-button'>×</a>"),e=this;d.on("click",function(a){e.hide(!0)}),this.box.on("mouseenter",function(a){e.isClosing||(e.isStartHide?e._show():clearTimeout(e.hideHandler))}),this.box.on("mouseleave",function(a){e.waitSeconds(5)}),this.box.append(d),b(document.body).append(this.box),this._initAnimator()}return this.box},isShow:function(){return"block"===this.getBox().css("display")},show:function(c,d){var f,g,h,i;if(g=b("<div class='message-item' />"),g.append(b("<i class='message-icon "+this.getIcon(d)+"'></i>")),h=b("<div class='message-content' />"),a.core.isFunction(c)?(i=c(),a.core.isString(i)?h.text(i):h.append(i)):h.text(c),g.append(h),f=this.getBox(),this.isShow())return void f.append(g);f.children(".message-item").remove(),f.append(g),this._show(function(){e.waitSeconds(5)})},_show:function(a){var b,c=(this.getBox(),document.documentElement.clientWidth);this.isStartHide=!1,this.boxAnimator.stop(),b=this.boxAnimator[0],b.begin=parseFloat(b.target.css("left"))||c,b.end=c-this.width,b.target.css("display","block"),this.boxAnimator.start().then(a)},hide:function(a){var b,c,d=this,e=document.documentElement.clientWidth;a&&(this.isClosing=!0),b=this.getBox(),this.isStartHide=!0,this.boxAnimator.stop(),c=this.boxAnimator[0],c.begin=parseFloat(c.target.css("left"))||e-this.width,c.end=e,this.boxAnimator.start().then(function(){b.css("display","none"),d.isClosing=!1,d.isStartHide=!1})},waitSeconds:function(a){var b=this;b.hideHandler&&window.clearTimeout(b.hideHandler),isNaN(parseInt(a))&&(a=5),b.hideHandler=window.setTimeout(function(){b.hideHandler=null,!1===b.isStartHide&&b.hide()},1e3*a)}},e=c(),a.page.resize(function(a){var b,c=e.getBox(),d=document.documentElement.clientWidth,f=document.documentElement.clientHeight;b=e.isShow()?d-e.width:d,e.waitSeconds(5),c.css({left:b+"px","max-height":f-2*e.top+"px"})}),a.messageShow=function(a){d(a,f.message)},a.warnShow=function(a){d(a,f.warn)},a.errorShow=function(a){d(a,f.error)},a.successShow=function(a){d(a,f.success)},a.failedShow=function(a){d(a,f.failed)}}(ui,ui.$),function(a,b){a.ctrls.define("ui.ctrls.OptionBox",a.ctrls.SidebarBase,{_defineOption:function(){return{title:"",buttons:null}},_create:function(){this._super(),this.contentPanel=null,this.contentTop=40,this.buttonTop=0,this.operatePanelHeight=0,this.buttons=[],this.opacityOption={ease:a.AnimationStyle.easeFromTo,onChange:function(a,b){b.css("opacity",a/100)}}},_render:function(){this._super(),this._panel.addClass("ui-option-box-panel"),this.titlePanel=b("<section class='ui-option-box-title' />"),this.contentPanel=b("<section class='ui-option-box-content' />"),this.contentPanel.append(this.element),this.borderWidth+=parseInt(this._panel.css("border-left-width"),10)||0,this.borderWidth+=parseInt(this._panel.css("border-right-width"),10)||0,this._panel.append(this.titlePanel).append(this.contentPanel),this._initOperateButtons(),this.setTitle(this.option.title)},_initOperateButtons:function(){var b,c;for(Array.isArray(this.option.buttons)||(a.core.isString(this.option.buttons)?this.option.buttons=[this.option.buttons]:this.option.buttons=[]),b=0,c=this.option.buttons.length;b<c;b++)this.addButton(this.option.buttons[b])},addButton:function(c){var d;if(c=a.getJQueryElement(c))return this.buttons.push(c),this.operatePanel?d=this.operatePanel.children(".ui-form"):(this.operatePanel=b("<section class='ui-option-box-buttons' />"),d=b("<div class='ui-form' />"),this.operatePanel.append(d),this._panel.append(this.operatePanel),this.buttonTop=16,this.operatePanelHeight=24),d.append(c),this},setTitle:function(c){this.titlePanel.empty(),c&&(a.core.isString(c)&&(c=b("<span class='option-box-title-text font-highlight'/>").text(c)),this.titlePanel.append(c))},setSize:function(b,c,d){var e;this._super(b,c,d),e=this.height-this.contentTop-this.buttonTop-this.operatePanelHeight-this.buttonTop,this.contentPanel.css({"max-height":e+"px"}),this.operatePanel&&(e<this.element.width()?this.operatePanel.css("width",this.width-a.scrollbarWidth+"px"):this.operatePanel.css("width","100%"))},show:function(){return this.showTimeValue=240,this.opacityOption.target=this._panel,this.opacityOption.begin=0,this.opacityOption.end=100,this._super(this.opacityOption)},hide:function(){return this.hideTimeValue=240,this.opacityOption.target=this._panel,this.opacityOption.begin=100,this.opacityOption.end=0,this._super(this.opacityOption)}})}(ui,ui.$),function(a,b){function c(){}function d(a){return a<10?"0"+a:""+a}function e(a){return a+""}function f(a,b,c){var d,e,f;for(f=[],f.push(null),d=3;d<arguments.length;d++)f.push(arguments[d]);for(e=[],d=a;d<=b;d++)f[0]=d,e.push(c.apply(this,f));return e}function g(a,b,c){var e,g;return e=[],a&&(g={title:"时"},g.list=f.call(this,0,23,d),e.push(g)),b&&(g={title:"分"},g.list=f.call(this,0,59,d),e.push(g)),c&&(g={title:"秒"},g.list=f.call(this,0,59,d),e.push(g)),e}function h(a){return Math.pow(a,.25)}function i(a){var b,c,d,e;if(a.beginAnimation)return a.duration=200,void(a.startTime=(new Date).getTime());a.startTime=(new Date).getTime(),a.duration=160,a.beginAnimation=!0,b=this,c=60,d=h,e=function(){var c=(new Date).getTime(),e=c-a.startTime,f=d(e/a.duration),g=a.scrollEnd-a.scrollBegin,h=Math.ceil(a.scrollBegin+f*g);a.target.scrollTop(h),a.duration<=e&&(a.target.scrollTop(a.scrollEnd),j.call(b,a),b._selectItem(a))},this._deselectItem(a),e(),a.stopScrollHandler=setInterval(e,1e3/c)}function j(a){clearInterval(a.stopScrollHandler),a.beginAnimation=!1}function k(a,b){b<0&&(b=0),a.scrollTop(b*(this.option.itemSize+this.option.margin))}function l(b){a.hideAll(this),this.show(),this._updateSelectionState()}function m(a){var c,d,e;for(a.stopPropagation(),c=b(a.target);"LI"!==c.nodeName();)if(c.hasClass("ui-chooser-list"))return;c.hasClass("ui-chooser-empty-item")||c.hasClass(p)||(d=parseInt(c.attr("data-index"),10),e=this.scrollData[parseInt(c.parent().parent().attr("data-index"),10)],this._chooseItem(e,d))}function n(a){var b,c,d,e,f,g,h;return a.stopPropagation(),b=a.data.target,c=parseInt(b.attr("data-index"),10),d=this.scrollData[c],e=this.option.itemSize+this.option.margin,h=Math.trunc(a.deltaY||-a.wheelDelta),f=h*e,g=h>0,null===d.lastDirection&&(d.lastDirection=g),d.lastDirection!==g&&(d.lastDirection=g,j.call(this,d)),d.beginAnimation?(d.scrollBegin=b.scrollTop(),d.scrollEnd=parseInt((d.scrollEnd+f)/e,10)*e):(d.scrollBegin=b.scrollTop(),d.scrollEnd=parseInt((d.scrollBegin+f)/e,10)*e),i.call(this,d),!1}var o,p="ui-chooser-selection-item",q={S:3,M:5,L:9};o={hourMinute:function(){var a;return a=g(!0,!0,!1),this.option.spliter=":",this.defaultValue=function(){var a=new Date;return[d(a.getHours()),d(a.getMinutes())]},this.getValue=this.getText=e,a},time:function(){var a;return a=g(!0,!0,!0),this.option.spliter=":",this.defaultValue=function(){var a=new Date;return[d(a.getHours()),d(a.getMinutes()),d(a.getSeconds())]},this.getValue=this.getText=e,a},yearMonth:function(){var a,b,c,g;return a=[],b=(new Date).getFullYear()-49,c=b+99,g={title:"年"},g.list=f.call(this,b,c,e),a.push(g),b=1,c=12,g={title:"月"},g.list=f.call(this,b,c,d),a.push(g),this.option.spliter="-",this.defaultValue=function(){var a=new Date;return[d(a.getFullYear()),d(a.getMonth()+1)]},this.getValue=this.getText=e,a}},a.ctrls.define("ui.ctrls.Chooser",a.ctrls.DropDownBase,{_defineOption:function(){return{type:!1,title:null,viewData:null,spliter:"",margin:0,size:"M",itemSize:32}},_defineEvents:function(){return["changing","changed","cancel","listChanged"]},_create:function(){var b;this._super(),this.scrollData=null,q.hasOwnProperty(this.option.size)?this.size=q[this.option.size]:this.size=q.M,(!a.core.isNumber(this.option.margin)||this.option.margin<0)&&(this.option.margin=0),(!a.core.isNumber(this.option.itemSize)||this.option.itemSize<=0)&&(this.option.itemSize=32),b=this.element.getBoundingClientRect(),this.width=b.width-2,this.width<this.itemSize+2*this.margin&&(this.width=120),this.onFocusHandler=l.bind(this),this.onItemClickHandler=m.bind(this),this.onMousewheelHandler=n.bind(this)},_render:function(){this.chooserPanel=b("<div class='ui-chooser-panel border-highlight' />"),this.chooserPanel.css("width",this.width+"px"),this._itemTitlePanel=b("<div class='ui-chooser-title-panel' />"),this._itemListPanel=b("<div class='ui-chooser-list-panel' />"),
this._itemListPanel.append(this._createFocusElement()),this._createItemList(this._itemTitlePanel,this._itemListPanel),this.chooserPanel.append(this._itemTitlePanel).append(this._itemListPanel),this._selectTextClass="ui-select-text",this._showClass="ui-chooser-show",this._clearClass="ui-clear-text",this._clear=function(){this.cancelSelection()},this.wrapElement(this.element,this.chooserPanel),this._super({focus:this.onFocusHandler}),this.chooserPanel.on("click",function(a){a.stopPropagation()})},_createFocusElement:function(){var a=b("<div class='focus-choose-element' />");return a.addClass("border-highlight"),a.css("top",this.option.itemSize*((this.size-1)/2)),a},_createItemList:function(a,b){var c=this._fillList(a,b);this.chooserPanel.css("width",c.width+"px"),b.css("height",c.height+"px")},_fillList:function(c,d){var e,f,g,h,i,j,k,l,m,n,p,q;if(e={width:0,height:this.size*(this.option.itemSize+this.option.margin)+this.option.margin},a.core.isString(this.option.type)?o.hasOwnProperty(this.option.type)&&(this.scrollData=o[this.option.type].call(this)):a.core.isFunction(this.option.type)&&(this.scrollData=this.option.type.call(this)),this.scrollData||(this.scrollData=this.option.viewData),!Array.isArray(this.scrollData)||0===this.scrollData.length)return e;for(k=this.scrollData.length,n=Math.floor(this.width/k),p=this.width-n*k,m=!1,j=0;j<k;j++)if(this.scrollData[j].title){m=!0;break}for(m||c.append("<span class='font-highlight'>"+this.option.title+"</span>"),j=0;j<k;j++)i=this.scrollData[j],p>0?(q=1,p--):q=0,g={left:e.width+"px",width:n+q+"px"},m&&(f=b("<div class='ui-chooser-title-item font-highlight' />"),f.css(g),f.text(i.title||""),c.append(f)),f=b("<div class='ui-chooser-list' />"),f.css(g),f.attr("data-index",j),l=this.scrollData[j],l.target=f,l.lastDirection=null,e.width+=n+q+this.option.margin,f.on("wheel",{target:f},this.onMousewheelHandler),f.on("click",this.onItemClickHandler),h=this._createList(i),f.append(h),d.append(f);return e},_createList:function(a){var c,d,e,f,g,h,i,j;for(h=this._getAttachmentCount(),c=a.list,d=[],e=[],i=0;i<h;i++)d.push(null),e.push(null);for(c=d.concat(c,e),f=b("<ul class='ui-chooser-list-ul' />"),i=0,j=c.length;i<j;i++)g=this._createItem(c[i]),i-h==0&&(a._current=g,g.addClass(p).addClass("font-highlight")),g.attr("data-index",i),f.append(g);return g.css("margin-bottom",this.option.margin+"px"),f},_createItem:function(a){var c;return c=b("<li class='ui-chooser-list-li' />"),{width:this.option.itemSize+"px",height:this.option.itemSize+"px"},c.addClass("ui-chooser-item"),a?c.text(this.getText(a)):c.addClass("ui-chooser-empty-item"),c},_getAttachmentCount:function(){return Math.floor((this.size-1)/2)},_getIndexes:function(b){var d,e,f,g,h,i;for(d=this._getAttachmentCount(),e=[],a.core.isFunction(b)||(b=c),f=0,g=this.scrollData.length;f<g;f++)h=this.scrollData[f],h._current?(i=parseInt(h._current.attr("data-index"),10),i-=d,e.push(i),b.call(this,h.list[i])):(e.push(-1),b.call(this,null));return e},_getValues:function(){var a,b;return a=[],b=this._getIndexes(function(b){b?a.push(this.getValue(b)):a.push("")}),{values:a,indexes:b}},_setValues:function(a){var b,c,d,e,f;if(Array.isArray(a)){for(f=[],b=0;b<a.length;b++)if(e=this.scrollData[b])for(f[b]=0,c=0,d=e.list.length;c<d;c++)if(this.getValue(e.list[c])===a[b]){f[b]=c;break}this._setSelectionState(f)}},_setSelectionState:function(a){var b,c,d,e;if(a.length==this.scrollData.length)for(d=0,e=a.length;d<e;d++)c=a[d],b=this.scrollData[d],this._deselectItem(b),k.call(this,b.target,c),this._selectItem(b)},_updateSelectionState:function(){var b,c;for(c=this._getIndexes(),b=c.length-1;b>=0;b--)-1===c[b]&&c.splice(b,1);if(c.length>0)this._setSelectionState(c);else if(a.core.isFunction(this.defaultValue))this._setValues(this.defaultValue());else{for(c=[],b=0;b<this.scrollData.length;b++)c.push(0);this._setSelectionState(c)}},_chooseItem:function(a,b){a.beginAnimation&&j.call(this,a),b-=this._getAttachmentCount(),a.scrollBegin=a.target.scrollTop(),a.scrollEnd=b*(this.option.itemSize+this.option.margin),i.call(this,a)},_selectItem:function(a){var c,d,e,f,g,h,i;for(f=0,g=this.scrollData.length;f<g;f++)if(this.scrollData[f].beginAnimation)return;c=a.target.find("ul"),d=a.target.scrollTop(),e=parseInt((d+.3*this.option.itemSize)/(this.option.itemSize+this.option.margin),10),i={listItem:a,itemIndex:e},this.fire("listChanged",i),a._current=b(c.children()[e+this._getAttachmentCount()]),a._current.addClass(p).addClass("font-highlight"),i=this._getValues(),i.text="",Array.isArray(i.values)&&(h=this,i.text=i.values.map(function(a){return h.getText(a)}).join(this.option.spliter)),!1!==this.fire("changing",i)&&(this._selectedItems=i.indexes,this.fire("changed",i))},_deselectItem:function(a){a._current&&a._current.removeClass(p).removeClass("font-highlight")},getSelection:function(){var a,b,c=[];for(a=this._getValues(),b=0;b<a.indexes.length;b++)-1===a.indexes[b]?c.push(null):c.push(a.values[b]);return c},setSelection:function(a){this._setValues(a)},cancelSelection:function(a){this.scrollData.forEach(function(a){a._current=null}),!1!==a&&this.fire("cancel")}}),a.ctrls.Chooser.extendType=function(b,c){a.core.isFunction(c)&&a.core.isString(b)&&!o.hasOwnProperty(b)&&(o[b]=c)},b.fn.chooser=function(b){return 0===this.length?null:a.ctrls.Chooser(b,this)}}(ui,ui.$),function(a,b){function c(c,d){var e=this;e.eventDispatcher=new a.CustomEvent(e),e.eventDispatcher.initEvents(["changed"]),b(c).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var f=b(".farbtastic",c);e.wheel=b(".wheel",c).get(0),e.radius=84,e.square=100,e.width=194,navigator.appVersion.match(/MSIE [0-6]\./)&&b("*",f).each(function(){if("none"!=this.currentStyle.backgroundImage){var a=this.currentStyle.backgroundImage;a=this.currentStyle.backgroundImage.substring(5,a.length-2),b(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+a+"')"})}}),e.linkTo=function(a){return"object"==typeof e.callback&&b(e.callback).unbind("keyup",e.updateValue),e.color=null,"function"==typeof a?e.callback=a:"object"!=typeof a&&"string"!=typeof a||(e.callback=b(a),e.callback.bind("keyup",e.updateValue),e.callback.get(0).value&&e.setColor(e.callback.get(0).value)),this},e.updateValue=function(a){this.value&&this.value!=e.color&&e.setColor(this.value)},e.setColor=function(a){var b=e.unpack(a);return e.color!=a&&b&&(e.color=a,e.rgb=b,e.hsl=e.RGBToHSL(e.rgb),e.updateDisplay()),this},e.setHSL=function(a){return e.hsl=a,e.rgb=e.HSLToRGB(a),e.color=e.pack(e.rgb),e.updateDisplay(),this},e.widgetCoords=function(a){var c,d,f,g,h=a.target||a.srcElement,i=e.wheel;if(void 0!==a.offsetX){f={x:a.offsetX,y:a.offsetY};for(var j=h;j;)j.mouseX=f.x,j.mouseY=f.y,f.x+=j.offsetLeft,f.y+=j.offsetTop,j=j.offsetParent;for(j=i,g={x:0,y:0};j;){if(void 0!==j.mouseX){c=j.mouseX-g.x,d=j.mouseY-g.y;break}g.x+=j.offsetLeft,g.y+=j.offsetTop,j=j.offsetParent}for(j=h;j;)j.mouseX=void 0,j.mouseY=void 0,j=j.offsetParent}else f=e.absolutePosition(i),c=(a.pageX||0*(a.clientX+b("html").get(0).scrollLeft))-f.x,d=(a.pageY||0*(a.clientY+b("html").get(0).scrollTop))-f.y;return{x:c-e.width/2,y:d-e.width/2}},e.mousedown=function(a){document.dragging||(b(document).bind("mousemove",e.mousemove).bind("mouseup",e.mouseup),document.dragging=!0);var c=e.widgetCoords(a);return e.circleDrag=2*Math.max(Math.abs(c.x),Math.abs(c.y))>e.square,e.mousemove(a),!1},e.mousemove=function(a){var b=e.widgetCoords(a);if(e.circleDrag){var c=Math.atan2(b.x,-b.y)/6.28;c<0&&(c+=1),e.setHSL([c,e.hsl[1],e.hsl[2]])}else{var d=Math.max(0,Math.min(1,-b.x/e.square+.5)),f=Math.max(0,Math.min(1,-b.y/e.square+.5));e.setHSL([e.hsl[0],d,f])}return!1},e.mouseup=function(){b(document).unbind("mousemove",e.mousemove),b(document).unbind("mouseup",e.mouseup),document.dragging=!1},e.updateDisplay=function(){var a=6.28*e.hsl[0];b(".h-marker",f).css({left:Math.round(Math.sin(a)*e.radius+e.width/2)+"px",top:Math.round(-Math.cos(a)*e.radius+e.width/2)+"px"}),b(".sl-marker",f).css({left:Math.round(e.square*(.5-e.hsl[1])+e.width/2)+"px",top:Math.round(e.square*(.5-e.hsl[2])+e.width/2)+"px"}),b(".color",f).css("backgroundColor",e.pack(e.HSLToRGB([e.hsl[0],1,.5]))),"object"==typeof e.callback?(b(e.callback).css({backgroundColor:e.color,color:e.hsl[2]>.5?"#000":"#fff"}),b(e.callback).each(function(){this.value&&this.value!=e.color&&(this.value=e.color)})):"function"==typeof e.callback&&e.callback.call(e,e.color),this.fire("changed",e.color)},e.absolutePosition=function(a){var b={x:a.offsetLeft,y:a.offsetTop};if(a.offsetParent){var c=e.absolutePosition(a.offsetParent);b.x+=c.x,b.y+=c.y}return b},e.pack=function(a){var b=Math.round(255*a[0]),c=Math.round(255*a[1]),d=Math.round(255*a[2]);return"#"+(b<16?"0":"")+b.toString(16)+(c<16?"0":"")+c.toString(16)+(d<16?"0":"")+d.toString(16)},e.unpack=function(a){return 7==a.length?[parseInt("0x"+a.substring(1,3))/255,parseInt("0x"+a.substring(3,5))/255,parseInt("0x"+a.substring(5,7))/255]:4==a.length?[parseInt("0x"+a.substring(1,2))/15,parseInt("0x"+a.substring(2,3))/15,parseInt("0x"+a.substring(3,4))/15]:void 0},e.HSLToRGB=function(a){var b,c,d=a[0],e=a[1],f=a[2];return c=f<=.5?f*(e+1):f+e-f*e,b=2*f-c,[this.hueToRGB(b,c,d+.33333),this.hueToRGB(b,c,d),this.hueToRGB(b,c,d-.33333)]},e.hueToRGB=function(a,b,c){return c=c<0?c+1:c>1?c-1:c,6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(.66666-c)*6:a},e.RGBToHSL=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2];return b=Math.min(h,Math.min(i,j)),c=Math.max(h,Math.max(i,j)),d=c-b,g=(b+c)/2,f=0,g>0&&g<1&&(f=d/(g<.5?2*g:2-2*g)),e=0,d>0&&(c==h&&c!=i&&(e+=(i-j)/d),c==i&&c!=j&&(e+=2+(j-h)/d),c==j&&c!=h&&(e+=4+(h-i)/d),e/=6),[e,f,g]},b("*",f).mousedown(e.mousedown),e.setColor("#000000"),d&&e.linkTo(d)}function d(a,d){return a=b(a).get(0),a.farbtastic||(a.farbtastic=new c(a,d))}function e(b,c){(b=a.getJQueryElement(b))&&(c||(c=arguments[2]||b.css("background-color")),c&&"transparent"!==c?(c=a.color.parseRGB(c),c=a.color.rgb2hex(c.red,c.green,c.blue).toLowerCase()):c="#ffffff",b.val(c),this.setColor(c))}b.fn.colorPicker=function(c){var f,g,h;return 0===this.length?null:(f=a.ctrls.DropDownBase(c,this),g=b("<div class='ui-color-picker border-highlight' />"),g.on("click",function(a){a.stopPropagation()}),f.colorPickerPanel=g,f._showClass="color-picker-show",f.wrapElement(this,g),f._render(),h=f.hide,d(g,this),f.farbtastic=f.colorPickerPanel[0].farbtastic,f.hide=function(){if(document.dragging)return"retain";h.call(this)},f.setColorValue=function(){e.apply(this.farbtastic,arguments)},f.setColorValue(this),f)}}(ui,ui.$),function(a,b){function c(a,b,d,e){if(!(this instanceof c))return new c(a,b,d,e);this.initialize(a,b,d,e)}function d(a){return a<10?"0"+a:""+a}function e(a,b){return b+=1,a+"-"+d.call(this,b)+"&nbsp;▼"}function f(a,b,c){var e;return e=a.exec(c),null!==e&&e[0].length>1&&(b=d(b)),c.replace(a,b)}function g(a,b,c){var d;return d=a.exec(c),d?parseInt(b.substring(d.index,d.index+d[0].length),10):NaN}function h(a,b){var d,e,f;return d=g.call(this,B,a,b),e=g.call(this,C,a,b),f=g.call(this,D,a,b),isNaN(d)||isNaN(e)||isNaN(f)?null:c(d,e-1,f,this)}function i(a){return a.hasClass("date-chooser-prev-disabled")||a.hasClass("date-chooser-next-disabled")}function j(a){var c,d,e,f=a.data.value;c=b(a.target),i(c)||(d=this._currentYear?parseInt(this._currentYear.attr("data-year"),10):this._selYear,e=this._currentMonth?parseInt(this._currentMonth.attr("data-month"),10):this._selMonth,d+=f,this._fillYear(d,e))}function k(a){var c,d;if(a.stopPropagation(),c=b(a.target),"TD"===c.nodeName()&&!c.hasClass("disabled-year")){if(this._currentYear){if(this._currentYear[0]===c[0])return;this._currentYear.removeClass(z).removeClass("background-highlight")}this._currentYear=c,this._currentYear.addClass(z).addClass("background-highlight"),d=this._currentMonth?parseInt(this._currentMonth.attr("data-month"),10):this._selMonth,this._updateMonthsStatus(d)}}function l(a){var c;if(a.stopPropagation(),c=b(a.target),"TD"===c.nodeName()&&!c.hasClass("disabled-month")){if(this._currentMonth){if(this._currentMonth[0]===c[0])return;this._currentMonth.removeClass(A).removeClass("background-highlight")}this._currentMonth=c,this._currentMonth.addClass(A).addClass("background-highlight")}}function m(a){a.stopPropagation(),this._selYear=parseInt(this._currentYear.attr("data-year"),10),this._selMonth=parseInt(this._currentMonth.attr("data-month"),10),this._updateCalendarTitle(),this._fillMonth(this._currentDays,this._selYear,this._selMonth),this._closeYearMonthPanel()}function n(a){a.stopPropagation(),this._closeYearMonthPanel()}function o(a){var c,d,e=a.data.value;c=b(a.target),i(c)||(d=new Date(this._selYear,this._selMonth+e,1),this._changeMonth(d,e>0))}function p(a){a.stopPropagation(),this._fillYear(this._selYear,this._selMonth),this._openYearMonthPanel()}function q(a){var c;if(c=b(a.target),!this._currentDays.parent().hasClass("click-disabled")){for(;"TD"!==c.nodeName();){if(c.hasClass("date-chooser-days-panel"))return;c=c.parent()}c[0]!==a.target&&(c.context=a.target),this._selectItem(c)}}function r(a){var b,c,d=new Date;b=d.getFullYear(),c=d.getMonth(),b===this._selYear&&c===this._selMonth?this.setSelection(d):this._changeMonth(d,12*b+c+1>12*this._selYear+this._selMonth+1,function(){this.setSelection(d)})}function s(a){var c,e,f,g,h,i,j;c=b(a.target),"INPUT"===c.nodeName()&&(e=c.hasClass("hour")?24:60,f=c.val(),f=parseFloat(f),g=Math.trunc(a.deltaY||-a.wheelDelta),f+=g,f<0?f=e-1:f>=e&&(f=0),c.val(d(f)),h=parseInt(this.hourText.val(),10),i=parseInt(this.minuteText.val(),10),j=parseInt(this.secondText.val(),10),this.setSelection(new Date(this._selYear,this._selMonth,this._selDay,h,i,j)))}function t(a){var c,e,f,g,h;if(c=b(a.target),0!==c.val().length){if(e=new Date,f=parseInt(this.hourText.val(),10),isNaN(f)||f<0||f>=24)return f=e.getHours(),void this.hourText.val(d(f));if(g=parseInt(this.minuteText.val(),10),isNaN(g)||g<0||g>=60)return g=e.getMinutes(),void this.minuteText.val(d(g));if(h=parseInt(this.secondText.val(),10),isNaN(h)||h<0||h>=60)return h=e.getSeconds(),void this.secondText.val(d(h));this.setSelection(new Date(this._selYear,this._selMonth,this._selDay,f,g,h))}}function u(){}function v(b,c){var d=a.ctrls.DateChooser(b,c);return d.selecting(function(b,c){if(a.core.isFunction(this.selectingHandler))return this.selectingHandler.apply(this,arguments)}),d.selected(function(b,c){a.core.isFunction(this.selectedHandler)?this.selectedHandler.apply(this,arguments):"INPUT"===this.element.nodeName()?this.element.val(c.value):this.element.html(c.value)}),d.cancel(function(){a.core.isFunction(this.cancelHandler)?this.cancelHandler.apply(this,arguments):"INPUT"===this.element.nodeName()?this.element.val(""):this.element.html("")}),d}function w(a){var b,c,d;if(!this.isShow())return this.element.css("cursor","auto"),void(this._clearable=!1);b=this.element.width(),c=parseFloat(this.element.css("padding-right"))||0,d=a.offsetX,d||(d=a.clientX-this.element.offset().left),b-c-d<0?(this.element.css("cursor","pointer"),this._clearable=!0):(this.element.css("cursor","auto"),this._clearable=!1)}function x(a){var c,d,e;this._clearable&&(c=this.element.width(),d=parseFloat(this.element.css("padding-right"))||0,e=a.offsetX,e||(e=a.clientX-this.element.offset().left),c-d-e<0&&b.isFunction(this._clear)&&this._clear())}function y(a,b){this.option=b,this._monthPrev.removeClass("date-chooser-prev-disabled"),this._monthNext.removeClass("date-chooser-next-disabled"),this._initDateRange(),this.isDateTime()||this._setTodayButton(),this.setLayoutPanel(b.layoutPanel),this.element=a,this.selectingHandler=b.selectingHandler,this.selectedHandler=b.selectedHandler,this.clearHandler=b.cancelHandler,"INPUT"===a.nodeName()?(this.onMousemoveHandler=w.bind(this),this.onMouseupHandler=x.bind(this)):(this.onMousemoveHandler=u,this.onMouseupHandler=u)}var z="year-selected",A="month-selected",B=/y+/i,C=/M+/,D=/d+/i,E=/h+/i,F=/m+/,G=/s+/i;c.prototype={constructor:c,initialize:function(a,b,c,d){this.year=a,this.month=b,this.day=c,this.dateChooser=d,this.today=null,this._isCurrentMonth=!0},isCurrentMonth:function(a){return arguments.length>0?(this._isCurrentMonth=a,this):this._isCurrentMonth},setToday:function(a){this.today=a},isToday:function(){return this.today||(this.today=new Date),this.year===this.today.getFullYear()&&this.month===this.today.getMonth()&&this.day===this.today.getDate()},isTheDay:function(a,b,c){return this.year===a&&this.month===b&&this.day===c},isDisabled:function(){return!!this.dateChooser&&this.dateChooser._isDisabledDay(this.year,this.month,this.day)},lt:function(a,b,c){var d=new Date(this.year,this.month,this.day),e=new Date(a,b,c);return d.getTime()<e.getTime()},gt:function(a,b,c){var d=new Date(this.year,this.month,this.day),e=new Date(a,b,c);return d.getTime()>e.getTime()},toDate:function(){return new Date(this.year,this.month,this.day,0,0,0)}},a.ctrls.define("ui.ctrls.DateChooser",a.ctrls.DropDownBase,{_defineOption:function(){return{dateFormat:"yyyy-MM-dd",calendarPanel:null,isDateTime:!1,startDate:null,endDate:null}},_defineEvents:function(){return["selecting","selected","cancel"]},_create:function(){var a;this._super(),this.isDateTime()?this.option.dateFormat=this.option.dateFormat||"yyyy-MM-dd hh:mm:ss":this.option.dateFormat=this.option.dateFormat||"yyyy-MM-dd",this._initDateRange(),a=this.formatDateValue(new Date),this._setCurrentDate(a),this._language=this.i18n(),this.onYearChangedHandler=j.bind(this),this.onYearSelectedHandler=k.bind(this),this.onMonthSelectedHandler=l.bind(this),this.onApplyYearMonthHandler=m.bind(this),this.onCancelYearMonthHandler=n.bind(this),this.onMonthChangedHandler=o.bind(this),this.onCalendarTitleClickHandler=p.bind(this),this.onDayItemClickHandler=q.bind(this),this.onTodayButtonClickHandler=r.bind(this),this.isDateTime()&&(this.onTimeMousewheelHandler=s.bind(this),this.onTimeTextinputHandler=t.bind(this))},_initDateRange:function(){this.startDay=null,a.core.isString(this.option.startDate)&&this.option.startDate.length>0&&(this.startDay=h.call(this,this.option.startDate,this.option.dateFormat)),this.endDay=null,a.core.isString(this.option.endDate)&&this.option.endDate.length>0&&(this.endDay=h.call(this,this.option.endDate,this.option.dateFormat))},_render:function(){this._calendarPanel=a.getJQueryElement(this.option.calendarPanel),this._calendarPanel?this._calendarPanel.css("position","relative"):this._calendarPanel=b("<div />"),this._calendarPanel.addClass("ui-date-chooser-panel").addClass("border-highlight").on("click",function(a){a.stopPropagation()}),this._showClass="ui-date-chooser-show",this._panel=this._calendarPanel,this._selectTextClass="ui-date-text",this._clearClass="ui-clear-text",this._clear=function(){this.cancelSelection()}.bind(this),this._initCalendarPanel(),this._initYearMonthPanel(),this._initYearMonthPanelAnimator(),this._initCalendarChangeAnimator()},_initYearMonthPanelAnimator:function(){this.ymAnimator=a.animator({target:this._settingPanel,onChange:function(a){this.target.css("top",a+"px")}}),this.ymAnimator.duration=240},_initCalendarChangeAnimator:function(){this.mcAnimator=a.animator({onChange:function(a){this.target.css("left",a+"px")}}).add({onChange:function(a){this.target.css("left",a+"px")}}),this.mcAnimator.duration=240},_initYearMonthPanel:function(){var a,c,d,e,f;this._settingPanel=b("<div class='year-month-setting-panel' />"),a=b("<div class='set-title font-highlight' style='height:24px;line-height:24px;' />"),this._settingPanel.append(a),d=b("<div class='date-chooser-prev'/>"),d.on("click",{value:-10},this.onYearChangedHandler),a.append(d),this._yearPrev=d,a.append("<div class='date-chooser-title'><span id='yearTitle'>"+this._language.year+"</span></div>"),e=b("<div class='date-chooser-next'/>"),e.on("click",{value:10},this.onYearChangedHandler),a.append(e),this._yearNext=e,a.append(b("<br clear='left' />")),this._settingPanel.append(this._createYearPanel()),c=b("<div class='set-title font-highlight' style='text-align:center;height:27px;line-height:27px;' />"),f=[],f.push("<fieldset class='title-fieldset border-highlight'>"),f.push("<legend class='title-legend font-highlight'>",this._language.month,"</legend>"),f.push("</fieldset>"),c.html(f.join("")),this._settingPanel.append(c),this._settingPanel.append(this._createMonthPanel()),this._settingPanel.append(this._createOkCancel()),this._calendarPanel.append(this._settingPanel)},_createYearPanel:function(){var a,c,d,e,f,g;for(a=b("<div class='date-chooser-year-panel' />"),this._yearsTable=b("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),this._yearsTable.on("click",this.onYearSelectedHandler),c=b("<tbody />"),f=0;f<3;f++){for(d=b("<tr />"),g=0;g<5;g++)e=b("<td class='date-chooser-year-td' />"),d.append(e);c.append(d)}return this._yearsTable.append(c),a.append(this._yearsTable),a},_createMonthPanel:function(){var a,c,d,e,f,g,h;for(a=b("<div class='date-chooser-month-panel' />"),this._monthsTable=b("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),this._monthsTable.on("click",this.onMonthSelectedHandler),c=b("<tbody />"),h=0,f=0;f<3;f++){for(d=b("<tr />"),g=0;g<4;g++)e=b("<td class='date-chooser-month-td' />"),e.html(this._language.months[h]),e.attr("data-month",h++),d.append(e);c.append(d)}return this._monthsTable.append(c),a.append(this._monthsTable),a},_createOkCancel:function(){var a=b("<div class='date-chooser-operate-panel' />");return a.append(this._createButton(this.onApplyYearMonthHandler,"<i class='far fa-check'></i>",null,{"margin-right":"10px"})),a.append(this._createButton(this.onCancelYearMonthHandler,"<i class='far fa-times'></i>")),a},_initCalendarPanel:function(){this._calendarPanel.append(this._createTitlePanel()),this._calendarPanel.append(this._createDatePanel()),this._calendarPanel.append(this._createCtrlPanel())},_createTitlePanel:function(){var a,c,d,e;return a=b("<div class='date-chooser-calendar-title' />"),c=b("<div class='date-chooser-prev' />"),c.on("click",{value:-1},this.onMonthChangedHandler),a.append(c),this._monthPrev=c,e=b("<div class='date-chooser-title' />"),this._linkBtn=b("<a href='javascript:void(0)' class='date-chooser-title-text font-highlight' />"),this._linkBtn.on("click",this.onCalendarTitleClickHandler),this._updateCalendarTitle(),e.append(this._linkBtn),a.append(e),d=b("<div class='date-chooser-next' />"),d.on("click",{value:1},this.onMonthChangedHandler),a.append(d),this._monthNext=d,a},_createDatePanel:function(){var a=b("<div class='date-chooser-calendar-panel' />");return a.append(this._createWeekHead()),a.append(this._createDaysBody()),a},_createWeekHead:function(){var a,c,d,e,f,g;for(a=b("<div class='date-chooser-week-panel'/>"),c=b("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),d=b("<tbody />"),e=b("<tr />"),g=0;g<7;g++)f=b("<th class='date-chooser-calendar-th' />"),f.text(this._language.weeks[g]),0!==g&&6!==g||f.addClass("date-chooser-weekend"),e.append(f);return d.append(e),c.append(d),a.append(c),a},_createDaysBody:function(){var a;return a=b("<div class='date-chooser-days-panel' />"),this._currentDays=this._createDaysTable(),this._nextDays=this._createDaysTable(),this._nextDays.css("display","none"),a.append(this._currentDays),a.append(this._nextDays),a.on("click",this.onDayItemClickHandler),a},_createDaysTable:function(){var a,c,d,e,f;for(a=b("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),c=b("<tbody />"),e=0;e<6;e++){for(d=b("<tr />"),f=0;f<7;f++)d.append(b("<td class='date-chooser-calendar-td' />"));c.append(d)}return a.append(c),a},_createCtrlPanel:function(){var a,c,e;return a=b("<div class='date-chooser-operate-panel' />"),c=new Date,this.isDateTime()?(e=d(c.getHours()),this.hourText=b("<input type='text' class='hour date-chooser-time-input font-highlight-hover' />"),this.hourText.val(e),this.hourText.textinput(this.onTimeTextinputHandler),a.append(this.hourText),a.append("<span style='margin-left:2px;margin-right:2px;'>:</span>"),e=d(c.getMinutes()),this.minuteText=b("<input type='text' class='minute date-chooser-time-input font-highlight-hover' />"),this.minuteText.val(e),this.minuteText.textinput(this.onTimeTextinputHandler),a.append(this.minuteText),a.append("<span style='margin-left:2px;margin-right:2px;'>:</span>"),e=d(c.getSeconds()),this.secondText=b("<input type='text' class='second date-chooser-time-input font-highlight-hover' />"),this.secondText.val(e),this.secondText.textinput(this.onTimeTextinputHandler),a.append(this.secondText),a.on("wheel",this.onTimeMousewheelHandler)):this._setTodayButton(function(){this._todayButton=this._createButton(this.onTodayButtonClickHandler,c.getDate()),a.append(this._todayButton)}),a},_setTodayButton:function(a,b){var c;a&&a.call(this),b||(b=new Date),c=!this.startDay||this.startDay.lt(b.getFullYear(),b.getMonth(),b.getDate()),c=c&&(!this.endDay||this.endDay.gt(b.getFullYear(),b.getMonth(),b.getDate())),c?(this._todayButton.attr("title",this.formatDateValue(b)),this._todayButton.removeAttr("disabled")):(this._todayButton.removeAttr("title"),this._todayButton.attr("disabled","disabled"))},_createButton:function(c,d,e,f){var g=b("<button class='icon-button date-chooser-button' />");return d&&g.html(d),e&&g.addClass(e),a.core.isObject(f)&&g.css(f),c&&g.on("click",c),g},_setCurrentDate:function(a){var b=this.option.dateFormat,c=new Date;this._selYear=g.call(this,B,a,b),this._selMonth=g.call(this,C,a,b),this._selDay=g.call(this,D,a,b),(isNaN(this._selYear)||this._selYear<=1970||this._selYear>9999)&&(this._selYear=c.getFullYear()),this._selMonth--,(isNaN(this._selMonth)||this._selMonth<0||this._selMonth>11)&&(this._selMonth=c.getMonth()),(isNaN(this._selDay)||this._selDay<=0||this._selDay>31)&&(this._selDay=c.getDate()),this._isDisabledDay(this._selYear,this._selMonth,this._selDay)&&(this._selYear=this.startDay.year,this._selMonth=this.startDay.month,this._selDay=this.startDay.day)},_setCurrentTime:function(a){var b,c,e,f,h;this.isDateTime()&&(f=this.option.dateFormat,h=new Date,b=g.call(this,E,a,f),c=g.call(this,F,a,f),e=g.call(this,G,a,f),(isNaN(b)||b<0||b>=24)&&(b=h.getHours()),(isNaN(c)||c<0||c>=60)&&(c=h.getMinutes()),(isNaN(e)||e<0||e>=60)&&(e=h.getSeconds()),this.hourText.val(d(b)),this.minuteText.val(d(c)),this.secondText.val(d(e)))},_updateCalendarTitle:function(){this._linkBtn.html(e.call(this,this._selYear,this._selMonth))},_fillMonth:function(a,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(this._checkPrev(d,e,this._monthPrev),this._checkNext(d,e,this._monthNext),f=[],h=new Date(d,e,1),(j=h.getDay())>0)for(g=new Date(d,e,0),k=g.getFullYear(),l=g.getMonth(),m=g.getDate(),n=m-(j-1);n<=m;n++)f.push(c(k,l,n,this).isCurrentMonth(!1));for(t=new Date(d,e+1,0).getDate(),n=1;n<=t;n++)f.push(c(d,e,n,this));for(i=new Date(e,e+1,1),k=i.getFullYear(),l=i.getMonth(),t=42-f.length,n=1;n<=t;n++)f.push(c(k,l,n,this).isCurrentMonth(!1));for(s=new Date,a.data("days",f),q=a[0].rows,n=0;n<6;n++)for(o=0;o<7;o++)p=7*n+o,m=f[p],m.setToday(s),r=b(q[n].cells[o]),r.attr("data-index",p),m.isDisabled()?r.addClass("disabled-day").html(""):(r.removeClass("disabled-day").html("<span>"+m.day+"</span>"),m.isTheDay(this._selYear,this._selMonth,this._selDay)&&this._selectItem(r),m.isToday()?r.addClass("font-highlight"):r.removeClass("font-highlight"),m.isCurrentMonth()||r.addClass("other-month-day"))},_fillYear:function(a,c){var d,e,f,g,h,i,j;for(e=15,d=15*Math.floor(a/15),b("#yearTitle").text(d+"年 ~ "+(d+e-1)+"年"),this._checkPrev(d-1,-1,this._yearPrev),this._checkNext(d+e,-1,this._yearNext),this._currentYear&&(this._currentYear.removeClass(z).removeClass("background-highlight"),this._currentYear=null),f=this._yearsTable[0].rows,i=0;i<3;i++)for(j=0;j<5;j++)g=b(f[i].cells[j]),h=d+(5*i+j),this.startDay&&h<this.startDay.year||this.endDay&&h>this.endDay.year?g.addClass("disabled-year"):g.html(h),g.attr("data-year",h),h===a&&(g.addClass(z).addClass("background-highlight"),this._currentYear=g);this._updateMonthsStatus(c)},_updateMonthsStatus:function(a){var c,d,e,f,g,h,i,j,k,l;if(f=parseInt(this._currentYear.attr("data-year"),10),e=new Array(12),this.startDay||this.endDay)for(h=-1,i=-1,this.startDay&&(this.startDay.year===f?h=this.startDay.month:this.startDay.year<f&&(h=0)),this.endDay&&this.endDay.year>=f&&(this.endDay.year===f?i=this.endDay.month:this.endDay.year>f&&(i=11)),k=0;k<e.length;k++)(k<h||k>i)&&(e[k]=!1);for(this._currentMonth&&(this._currentMonth.removeClass(A).removeClass("background-highlight"),this._currentMonth=null),c=this._monthsTable[0].rows,g=null,k=0;k<3;k++)for(l=0;l<4;l++)j=4*k+l,d=b(c[k].cells[l]),!1===e[j]?d.addClass("disabled-month"):(g||(g=d),d.removeClass("disabled-month")),j===a&&!1!==e[j]&&(this._currentMonth=d,d.addClass(A).addClass("background-highlight"));this._currentMonth||(this._currentMonth=g,g.addClass(A).addClass("background-highlight"))},_checkPrev:function(a,b,c){var d,e;this.startDay&&(d=12*this.startDay.year,e=12*a,b>=0&&(d+=this.startDay.month+1,e+=b+1),e<=d?c.addClass("date-chooser-prev-disabled"):c.removeClass("date-chooser-prev-disabled"))},_checkNext:function(a,b,c){var d,e;this.endDay&&(d=12*this.endDay.year,e=12*a,b>=0&&(d+=this.endDay.month+1,e+=b+1),e>=d?c.addClass("date-chooser-next-disabled"):c.removeClass("date-chooser-next-disabled"))},_isDisabledDay:function(a,b,c){return!(!this.startDay||!this.startDay.gt(a,b,c))||!(!this.endDay||!this.endDay.lt(a,b,c))},_getSelectionData:function(a){var b,c,d,e,f=0,g=0,h=0;return e={},this.isDateTime()&&(f=parseInt(this.hourText.val(),10)||0,g=parseInt(this.minuteText.val(),10)||0,h=parseInt(this.secondText.val(),10)||0),b=parseInt(a.attr("data-index"),10),c=a.parent().parent().parent(),c=c.data("days"),d=c[b],e.date=new Date(d.year,d.month,d.day,f,g,h),e.value=this.formatDateValue(e.date),e},_selectItem:function(a){var c;a.hasClass("disabled-day")||(c=this._getSelectionData(a),a.element=a,c.originElement=a.context?b(a.context):null,!1!==this.fire("selecting",c)&&(this._selYear=c.date.getFullYear(),this._selMonth=c.date.getMonth(),this._selDay=c.date.getDate(),this._currentDate&&this._currentDate.removeClass("date-selected").removeClass("background-highlight"),this._currentDate=a,this._currentDate.addClass("date-selected").addClass("background-highlight"),this.fire("selected",c)))},_openYearMonthPanel:function(){var b;b=this.ymAnimator[0],b.target.css("display","block"),b.begin=parseFloat(b.target.css("top")),b.end=0,b.ease=a.AnimationStyle.easeTo,this.ymAnimator.start()},_closeYearMonthPanel:function(){var b;b=this.ymAnimator[0],b.begin=parseFloat(b.target.css("top")),b.end=-b.target.height(),b.ease=a.AnimationStyle.easeFrom,this.ymAnimator.start().then(function(){b.target.css("display","none")}),this._currentYear.removeClass(z).removeClass("background-highlight"),this._currentMonth.removeClass(A).removeClass("background-highlight"),this._currentYear=null,this._currentMonth=null},_changeMonth:function(b,c,d){var e,f,g,h,i;this.mcAnimator.isStarted||(f=this._currentDays.parent(),h=f.width(),g=parseFloat(this._currentDays.css("left"))||0,e=this.mcAnimator[0],e.target=this._currentDays,e.begin=g,e.end=c?-h:h,e=this.mcAnimator[1],e.target=this._nextDays,e.target.css("display","block"),c?(e.begin=h-g,e.target.css("left",e.begin+"px")):(e.begin=g-h,e.target.css("left",e.begin+"px")),e.end=0,this._selYear=b.getFullYear(),this._selMonth=b.getMonth(),this._updateCalendarTitle(),this._fillMonth(this._nextDays,this._selYear,this._selMonth),f.addClass("click-disabled"),i=this,this.mcAnimator.start().then(function(){var b=i._currentDays;i._currentDays=i._nextDays,i._nextDays=b,i._nextDays.css("display","none"),f.removeClass("click-disabled"),a.core.isFunction(d)&&d.call(i)}))},isDateTime:function(){return!!this.option.isDateTime},setSelection:function(a){var c,d,e,f,g;a&&!this._isDisabledDay(a.getFullYear(),a.getMonth(),a.getDate())&&(f=new Date(a.getFullYear(),a.getMonth(),1),
c=f.getDay()+a.getDate()-1,d=Math.floor(c/7),e=c-7*d,g=b(this._currentDays[0].rows[d].cells[e]),g.length>0&&this._selectItem(g))},getSelection:function(){return this._currentDate?this._getSelectionData(this._currentDate):null},cancelSelection:function(){this._currentDate&&this._currentDate.removeClass("date-selected").removeClass("background-highlight"),this.fire("cancel")},setDateValue:function(a){this._setCurrentDate(a),this.isDateTime()&&this._setCurrentTime(a),this._updateCalendarTitle(),this._fillMonth(this._currentDays,this._selYear,this._selMonth)},formatDateValue:function(a){var b=this.option.dateFormat;return b=f(B,a.getFullYear(),b),b=f(C,a.getMonth()+1,b),b=f(D,a.getDate(),b),this.isDateTime()&&(b=f(E,a.getHours(),b),b=f(F,a.getMinutes(),b),b=f(G,a.getSeconds(),b)),b},show:function(){var a,b,c,d,e;this._todayButton&&(d=new Date,c=parseInt(this._todayButton.text(),10),d.getDate()!==c&&this._todayButton.html(d.getDate()).attr("title",this.formatDateValue(d))),a=this,b=this._super,e=function(){a.moveToElement(a.element,!0),b.call(a)},this.isShow()?this.hide(e):e()}});var H,I;b.fn.dateChooser=function(c){var d,e,f;return 0===this.length?null:(this.hasClass("date-text")&&this.css("width",parseFloat(this.css("width"),10)-23+"px"),d=this.nodeName(),"INPUT"!==d&&"A"!==d&&"SELECT"!==d&&this.attr("tabindex",0),e="INPUT"===d?function(){return this.val()}:function(){return this.text()},c&&c.isDateTime?(I||(c.dateFormat||(c.dateFormat="yyyy-MM-dd hh:mm:ss"),I=v(c,this)),f=I):(H||(H=v(null,this)),f=H),c=a.extend({},f.option,c),this.focus(function(d){var g,h=b(d.target);f.isShow()&&f.element&&f.element[0]===h[0]||(f.element&&f.element.removeClass(f._clearClass),y.call(f,h,c),g=e.call(h),f.setDateValue(g),a.hideAll(f),f.show())}).on("click",function(a){a.stopPropagation()}),f)}}(ui,ui.$),function(a,b){function c(a){var b,c,d,e;for(c=a.split("."),b=this[c[0]],d=1,e=c.length;d<e&&(void 0!==(b=b[c[d]])&&null!==b);d++);return void 0===b&&(b=null),b}function d(a){for(var b,c=[],d=0;d<a.length;d++)b=this[a[d]],void 0===b&&(b=null),c.push(b+"");return c.join("_")}function e(c,d,e){var f="";return a.core.isString(c)?f=c:c&&(f=this._getText.call(c,this.option.textField)),b("<span />").text(f)}function f(a,b){b?a.removeClass("fa-square").addClass("fa-check-square").addClass("font-highlight"):a.removeClass("fa-check-square").removeClass("font-highlight").addClass("fa-square")}function g(a){return a.hasClass("fa-check-square")}function h(a){var c;for(this.isMultiple()&&a.stopPropagation(),c=b(a.target);"LI"!==c.nodeName()&&!c.hasClass("ui-selection-list-li");){if(c.hasClass("ui-selection-list-panel"))return;c=c.parent()}c[0]!==a.target&&(c.context=a.target),this._selectItem(c)}var i="ui-selection-list-selected",j="ui-selection-list-checkbox";a.ctrls.define("ui.ctrls.SelectionList",a.ctrls.DropDownBase,{_defineOption:function(){return{multiple:!1,valueField:null,textField:null,viewData:null,itemFormatter:null,width:null}},_defineEvents:function(){return["changing","changed","cancel"]},_create:function(){var a,e;this._super(),this._current=null,this._selectList=[],a=[this.option.valueField,this.option.textField],e=["_getValue","_getText"],a.forEach(function(a,f){Array.isArray(a)?this[e[f]]=d:b.isFunction(a)?this[e[f]]=a:this[e[f]]=c},this),this.onItemClickHandler=h.bind(this)},_render:function(){this.listPanel=b("<div class='ui-selection-list-panel border-highlight' />"),this.listPanel.on("click",this.onItemClickHandler),this.wrapElement(this.element,this.listPanel),this._showClass="ui-selection-list-show",this._clearClass="ui-clear-text",this._clear=function(){this.cancelSelection()},this._selectTextClass="ui-select-text",this.initPanelWidth(this.option.width),a.core.isFunction(this.option.itemFormatter)?this.itemFormatter=this.option.itemFormatter:this.itemFormatter=e,Array.isArray(this.option.viewData)&&this._fill(this.option.viewData),this._super()},_fill:function(a){var c,d,e;for(this.clear(),c=b("<ul class='ui-selection-list-ul' />"),e=0;e<a.length;e++)this.option.viewData.push(a[e]),d=b("<li class='ui-selection-list-li' />"),this.isMultiple()&&d.append(this._createCheckbox()),d.append(this.itemFormatter(a[e],e,d)),d.attr("data-index",e),c.append(d);this.listPanel.append(c)},_createCheckbox:function(){var a=b("<i class='fa fa-square' />");return a.addClass(j),a},_getItemIndex:function(a){return parseInt(a.getAttribute("data-index"),10)},_getSelectionData:function(a){var b=this._getItemIndex(a),c={},d=this.getViewData();return c.itemData=d[b],c.itemIndex=b,c},_selectItem:function(c,d,e){var h,k,l,m,n;if(h=this._getSelectionData(c[0]),h.element=c,h.originElement=c.context?b(c.context):null,l=this.isMultiple(),l&&(k=c.find("."+j)),a.core.isBoolean(d)?h.isSelection=d:h.isSelection=!l||!g.call(this,k),!1!==this.fire("changing",h)){if(l)if(h.isSelection){if(g.call(this,k))return;f.call(this,k,!0),this._selectList.push(c[0])}else{if(!g.call(this,k))return;for(m=0,n=this._selectList.length;m<n;m++)if(this._selectList[m]===c[0]){f.call(this,k,!1),this._selectList.splice(m,1);break}}else{if(this._current){if(this._current[0]==c[0])return;this._current.removeClass(i).removeClass("background-highlight")}this._current=c,this._current.addClass(i).addClass("background-highlight")}!1!==e&&this.fire("changed",h)}},_selectByValues:function(a,c){var d,e,f,g,h,i;for(d=a.length,a=a.slice(0),e=this.getViewData(),g=0,i=e.length;g<i;g++)for(f=e[g],h=0;h<d;h++)if(this._equalValue(f,a[h])){c.elem=b(this.listPanel.children("ul").children()[g]),this._selectItem(c.elem,!0,!1),d--,a.splice(h,1);break}},_equalValue:function(b,c){return a.core.isString(b)?b===c+"":a.core.isObject(b)&&!a.core.isObject(c)?this._getValue.call(b,this.option.valueField)===c:this._getValue.call(b,this.option.valueField)===this._getValue.call(c,this.option.valueField)},getSelection:function(){var a,b,c=null;if(this.isMultiple())for(c=[],a=0,b=this._selectList.length;a<b;a++)c.push(this._getSelectionData(this._selectList[a]).itemData);else this._current&&(c=this._getSelectionData(this._current[0]).itemData);return c},getSelectionValues:function(){var a,b,c,d=null;if(this.isMultiple())for(d=[],b=0,c=this._selectList.length;b<c;b++)a=this._getSelectionData(this._selectList[b]).itemData,d.push(this._getValue.call(a,this.option.valueField));else this._current&&(a=this._getSelectionData(this._current[0]).itemData,d=this._getValue.call(a,this.option.valueField));return d},setSelection:function(a){var b,c;this.cancelSelection(),this.isMultiple()?Array.isArray(a)||(a=[a]):a=Array.isArray(a)?[a[0]]:[a],b={elem:null},this._selectByValues(a,b),b.elem&&(c=this._getSelectionData(b.elem[0]),c.element=b.elem,c.originElement=null,this.fire("changed",c))},cancelSelection:function(c,d){var e,g,h,k,l,m;if(a.core.isBoolean(c)&&(d=c,c=null),this.isMultiple()){if(m=!1,c){for(c=Array.isArray(c)?Array.from(c):[c],k=this._selectList.length-1;k>=0&&0!==c.length;k--)for(e=b(this._selectList[k]),l=this._getSelectionData(e[0]).itemData,g=0,h=c.length;g<h;g++)if(this._equalValue(l,c[g])){this._selectItem(e,!1),c.splice(g,1);break}}else{for(g=0,h=this._selectList.length;g<h;g++)e=b(this._selectList[g]),f.call(this,e.find("."+j),!1);this._selectList=[]}m=0===this._selectList.length}else m=!0,this._current&&(this._current.removeClass(i).removeClass("background-highlight"),this._current=null);!1!==d&&m&&this.fire("cancel")},setViewData:function(a){Array.isArray(a)&&this._fill(a)},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return this.viewData.length},isMultiple:function(){return!0===this.option.multiple},clear:function(){this.option.viewData=[],this.listPanel.empty(),this._current=null,this._selectList=[]}}),b.fn.selectionList=function(b){return 0===this.length?null:a.ctrls.SelectionList(b,this)}}(ui,ui.$),function(a,b){function c(a,b){var c=this[s];c||(c={},this[s]=c),c[a]=b}function d(a){var b=this[s];return b?b[a]||null:null}function e(){return d.call(this,"parentNode")}function f(a){var b,c,d,e;for(c=a.split("."),b=this[c[0]],d=1,e=c.length;d<e&&(void 0!==(b=b[c[d]])&&null!==b);d++);return void 0===b&&(b=null),b}function g(a){for(var b,c=[],d=0;d<a.length;d++)b=this[a[d]],void 0===b&&(b=null),c.push(b+"");return c.join("_")}function h(a,c,d){var e=b("<span />").text(a);return c>0&&e.css("margin-left",c),e}function i(a,b){b?a.removeClass("fa-square").addClass("fa-check-square").addClass("font-highlight"):a.removeClass("fa-check-square").removeClass("font-highlight").addClass("fa-square")}function j(a){return a.hasClass("fa-check-square")}function k(a){var c,d,e;if(this.isMultiple()&&a.stopPropagation(),c=b(a.target),c.hasClass(p))return a.stopPropagation(),void this.onTreeFoldClickHandler(a);for(;"DT"!==c.nodeName()&&!c.hasClass("ui-selection-tree-dt");){if(c.hasClass("ui-selection-tree-panel"))return;c=c.parent()}c[0]!==a.target&&(c.context=a.target),d=this._getNodeData(c),e=this._hasChildren(d),!0!==this.option.nodeSelectable&&e?e&&(a.stopPropagation(),this.onTreeFoldClickHandler({target:c.children(".fold-button")[0]})):this._selectItem(c,d)}function l(a){var c,d;c=b(a.target),d=c.parent(),c.hasClass(q)?this._setChildrenExpandStatus(d,!1,c):this._setChildrenExpandStatus(d,!0,c)}function m(a){var c,d,e;c=b(a.target),d=c.parent(),e=d.next(),c.hasClass(q)?this._setChildrenExpandStatus(d,!1,c):(this._setChildrenExpandStatus(d,!0,c),0===e.children().length&&this._loadChildren(d,e,this._getNodeData(d)))}var n="ui-selection-tree-selected",o="ui-selection-tree-checkbox",p="fold-button",q="expand-button",r=0,s="_extensions";a.ctrls.define("ui.ctrls.SelectionTree",a.ctrls.DropDownBase,{_defineOption:function(){return{multiple:!1,valueField:null,textField:null,parentField:null,childField:null,viewData:null,nodeSelectable:!0,defaultExpandLevel:!1,lazy:!1,itemFormatter:null,width:null}},_defineEvents:function(){return["changing","changed","cancel"]},_create:function(){var c,d;this._super(),this._current=null,this._selectList=[],this._treePrefix="selectionTree_"+ ++r+"_",c=[this.option.valueField,this.option.textField,this.option.parentField],d=["_getValue","_getText","_getParent"],c.forEach(function(a,c){Array.isArray(a,c)?this[d[c]]=g:b.isFunction(a)?this[d[c]]=a:this[d[c]]=f},this),!1===this.option.defaultExpandLevel?this.expandLevel=0:a.core.isNumber(this.option.defaultExpandLevel)?this.expandLevel=this.option.defaultExpandLevel<=0?0:this.option.defaultExpandLevel:this.expandLevel=1e3,this.option.lazy?(a.core.isFunction(this.option.lazy.hasChildren)&&(this._hasChildren=this.option.lazy.hasChildren),a.core.isFunction(this.option.lazy.loadChildren)&&(this._loadChildren=this.option.lazy.loadChildren,this.expandLevel=0),this.onTreeFoldClickHandler=m.bind(this),this.option.lazy=!0):(this.onTreeFoldClickHandler=l.bind(this),this.option.lazy=!1),a.core.isFunction(this.option.itemFormatter)||(this.option.itemFormatter=h),this.onTreeItemClickHandler=k.bind(this)},_render:function(){this.treePanel=b("<div class='ui-selection-tree-panel border-highlight' />"),this.treePanel.on("click",this.onTreeItemClickHandler),this.wrapElement(this.element,this.treePanel),this._showClass="ui-selection-tree-show",this._clearClass="ui-clear-text",this._clear=function(){this.cancelSelection()},this._selectTextClass="ui-select-text",this.initPanelWidth(this.option.width),a.core.isFunction(this.option.itemFormatter)?this.itemFormatter=this.option.itemFormatter:this.itemFormatter=h,Array.isArray(this.option.viewData)&&this._fill(this.option.viewData),this._super.apply(this,arguments)},_fill:function(a){var c,d;this.clear(),this.option.viewData=a,c=b("<dl class='ui-selection-tree-dl' />"),d=this.getViewData(),this.option.childField?this._renderTree(d,c,0):this.option.parentField&&this._listDataToTree(d,c,0),this.treePanel.append(c)},_listDataToTree:function(b,c,d){var e;Array.isArray(b)&&0!==b.length&&(this.originalViewData=b,e="children",b=a.trans.listToTree(b,this.option.parentField,this.option.valueField,e),b?(this.option.childField=e,this.option.viewData=b,this._renderTree(b,c,d)):delete this.originalViewData)},_renderTree:function(a,d,f,g,h){var i,j,k,l,m,n,o,p,r,s,t,u;if(Array.isArray(a)&&0!==a.length)for(u=g,m=0,n=a.length;m<n;m++)o=0,l=a[m],i=u?u+"_"+m:""+m,j=this._getText.call(l,this.option.textField)||"",c.call(l,"parentNode",h||null),c.call(l,"elementId",i),l.getParent=e,r=b("<dt class='ui-selection-tree-dt' />"),this.isMultiple()&&(t=this._createCheckbox()),r.prop("id",this._treePrefix+i),d.append(r),this._hasChildren(l)?(k=this._getChildren(l),s=b("<dd class='ui-selection-tree-dd' />"),f+1<=this.expandLevel?r.append(this._createFoldButton(f,q,"fa-angle-down")):(r.append(this._createFoldButton(f,"fa-angle-right")),s.css("display","none")),!0===this.option.nodeSelectable&&t&&r.append(t),this.option.lazy?f+1<=this.expandLevel&&this._loadChildren(r,s,l):(p=b("<dl class='ui-selection-tree-dl' />"),this._renderTree(k,p,f+1,i,l),s.append(p)),d.append(s)):(o=17*(f+1)+3,t&&(t.css("margin-left",o+"px"),o=0,r.append(t))),r.append(this.option.itemFormatter.call(this,j,o,l,r))},_createCheckbox:function(){var a=b("<i class='fa fa-square' />");return a.addClass(o),a},_createFoldButton:function(a){var c,d,e;for(c=b("<i class='fold-button font-highlight-hover far' />"),d=1,e=arguments.length;d<e;d++)c.addClass(arguments[d]);return c.css("margin-left",17*a+3+"px"),c},_setChildrenExpandStatus:function(a,b,c){var d=a.next();c&&0!==c.length||(c=a.children(".fold-button")),b?(c.addClass(q).removeClass("fa-angle-right").addClass("fa-angle-down"),d.css("display","block")):(c.removeClass(q).removeClass("fa-angle-down").addClass("fa-angle-right"),d.css("display","none"))},_getChildren:function(a){return a[this.option.childField]||null},_hasChildren:function(a){var b=this._getChildren(a);return Array.isArray(b)&&b.length>0},_loadChildren:function(c,d,e){var f,g;f=this._getChildren(e),Array.isArray(f)&&f.length>0&&(g=b("<dl />"),this._renderTree(f,g,this._getLevel(e)+1,a.str.trimLeft(c.prop("id"),this._treePrefix),e),d.append(g))},_getLevel:function(a){for(var b,c=0;b=a.getParent();)c++,a=b;return c},_getNodeData:function(a){var b;return a?(b=a.prop("id"),0===b.length||0!==b.indexOf(this._treePrefix)?null:(b=b.substring(this._treePrefix.length),this._getNodeDataByPath(b))):null},_getNodeDataByPath:function(a){var b,c,d,e,f;if(!a)return null;for(b=a.split("_"),d=this.getViewData(),c=d[parseInt(b[0],10)],e=1,f=b.length;e<f;e++)c=this._getChildren(c)[parseInt(b[e],10)];return c},_getSelectionData:function(a,b){var c={};return b||(b=this._getNodeData(a)),c.nodeData=b,c.children=this._getChildren(b),c.parent=c.nodeData.getParent(),c.isRoot=!c.parent,c.isNode=this._hasChildren(b),c},_selectItem:function(c,d,e,f){var g,h,k,l,m;if(g=this._getSelectionData(c,d),g.element=c,g.originElement=c.context?b(c.context):null,k=this.isMultiple(),k&&(h=c.find("."+o)),a.core.isBoolean(e)?g.isSelection=e:g.isSelection=!k||!j.call(this,h),!1!==this.fire("changing",g)){if(k)if(g.isSelection){if(j.call(this,h))return;i.call(this,h,!0),this._selectList.push(c[0])}else{if(!j.call(this,h))return;for(l=0,m=this._selectList.length;l<m;l++)if(this._selectList[l]===c[0]){i.call(this,h,!1),this._selectList.splice(l,1);break}}else{if(this._current){if(this._current[0]==c[0])return;this._current.removeClass(n).removeClass("background-highlight")}this._current=c,this._current.addClass(n).addClass("background-highlight")}!1!==f&&this.fire("changed",g)}},_selectTreeByValues:function(a,b,c,d,e){var f,g,h,i,j;if(Array.isArray(a)&&0!==a.length&&Array.isArray(b)&&0!==b.length)for(f=0,h=a.length;f<h;f++){for(i=a[f],j=d?d+"_"+f:""+f,g=0;g<b.length;g++)if(this._equalValue(i,b[g])){e.elem=this._selectNodeByValue(i,j),b.splice(g,1);break}if(0===b.length)break;this._selectTreeByValues(this._getChildren(i),b,c+1,j,e)}},_equalValue:function(b,c){return a.core.isObject(b)&&!a.core.isObject(c)?this._getValue.call(b,this.option.valueField)===c:this._getValue.call(b,this.option.valueField)===this._getValue.call(c,this.option.valueField)},_selectNodeByValue:function(a,c){var d,e,f,g,h,i,j;if(this.option.lazy){for(f=[],g=c.split("_"),e="#"+this._treePrefix+c,d=b(e);0===d.length&&(f.push(e),g.splice(g.length-1,1),0!==g.length);)e="#"+this._treePrefix+g.join("_"),d=b(e);if(0===d.length)return;for(h=f.length-1;h>=0;h--)i=d,j=i.next(),this._loadChildren(i,j,this._getNodeData(i)),d=b(f[h])}else d=b("#"+this._treePrefix+c);for(j=d.parent().parent();"DD"===j.nodeName()&&j.hasClass("ui-selection-tree-dd");)i=j.prev(),"none"===j.css("display")&&this._setChildrenExpandStatus(i,!0),j=i.parent().parent();return this._selectItem(d,a,!0,!1),d},_selectChildNode:function(a,c,d){var e,f,g,h,i;if(e=this._getChildren(a),Array.isArray(e)&&0!==e.length)for(f=c.prop("id"),g=c.next(),this.option.lazy&&0===g.children().length&&this._loadChildren(c,g,a),h=0,i=e.length;h<i;h++)a=e[h],c=b("#"+f+"_"+h),this._selectItem(c,a,d,!1),this._selectChildNode(a,c,d)},_selectParentNode:function(a,c,d){var e,f,g,h,i,k,l,m;if(e=a.getParent()){if(f=c.substring(0,c.lastIndexOf("_")),g=b("#"+f),!d&&(h=g.next(),"DD"===h.nodeName()))for(i=h.find("dt"),k=0,l=i.length;k<l;k++)if(m=b(i[k]).find("."+o),j.call(this,m))return;this._selectItem(g,e,d,!1),this._selectParentNode(e,f,d)}},getSelection:function(){var a,c,d=null;if(this.isMultiple())for(d=[],a=0,c=this._selectList.length;a<c;a++)d.push(this._getNodeData(b(this._selectList[a])));else this._current&&(d=this._getNodeData(this._current));return d},getSelectionValues:function(){var a,c,d,e=null;if(this.isMultiple())for(e=[],c=0,d=this._selectList.length;c<d;c++)a=this._getNodeData(b(this._selectList[c])),e.push(this._getValue.call(a,this.option.valueField));else this._current&&(a=this._getNodeData(this._current),e=this._getValue.call(a,this.option.valueField));return e},setSelection:function(a){var b,c,d;this.cancelSelection(),a=this.isMultiple()?Array.isArray(a)?Array.from(a):[a]:Array.isArray(a)?[a[0]]:[a],b={elem:null},c=this.getViewData(),this._selectTreeByValues(c,a,0,null,b),b.elem&&(d=this._getSelectionData(b.elem),d.element=b.elem,d.originElement=null,d.isSelection=!0,this.fire("changed",d))},selectChildNode:function(a,b){var c;b=1===arguments.length||!!b,(c=this._getNodeData(a))&&this.isMultiple()&&!0===this.option.nodeSelectable&&this._selectChildNode(c,a,b)},selectParentNode:function(a,b){var c,d;b=1===arguments.length||!!b,(c=this._getNodeData(a))&&this.isMultiple()&&!0===this.option.nodeSelectable&&(d=a.prop("id"),this._selectParentNode(c,d,b))},cancelSelection:function(c,d){var e,f,g,h,j,k;if(a.core.isBoolean(c)&&(d=c,c=null),this.isMultiple()){if(k=!1,c){for(c=Array.isArray(c)?Array.from(c):[c],h=this._selectList.length-1;h>=0&&0!==c.length;h--)for(e=b(this._selectList[h]),j=this._getNodeData(e),f=0,g=c.length;f<g;f++)if(this._equalValue(j,c[f])){this._selectItem(e,j,!1),c.splice(f,1);break}}else{for(f=0,g=this._selectList.length;f<g;f++)e=b(this._selectList[f]),i.call(this,e.find("."+o),!1);this._selectList=[]}k=0===this._selectList.length}else k=!0,this._current&&(this._current.removeClass(n).removeClass("background-highlight"),this._current=null);!1!==d&&k&&this.fire("cancel")},setViewData:function(a){Array.isArray(a)&&this._fill(a)},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return this.viewData.length},isMultiple:function(){return!0===this.option.multiple},clear:function(){this.option.viewData=[],this.treePanel.empty(),this._current=null,this._selectList=[],delete this.originalViewData}}),b.fn.selectionTree=function(b){return 0===this.length?null:a.ctrls.SelectionTree(b,this)}}(ui,ui.$),function(a,b){function c(b){a.hideAll(this),this._resetTreeList(),this.show()}function d(b){b.which===a.keyCode.DOWN?this._moveSelection(1):b.which===a.keyCode.UP?this._moveSelection(-1):b.which===a.keyCode.ENTER&&this._selectCompleter()}function e(a){for(var c=b(a.target);"DT"!==c.nodeName()&&!c.hasClass("autocomplete-dt");){if(c.hasClass("autocomplete-dl"))return;c=c.parent()}this._currentCompleterElement&&this._currentCompleterElement.removeClass(h),this._currentCompleterElement=c,this._currentCompleterElement.addClass(h)}function f(a){a.stopPropagation(),this._selectCompleter()}function g(a){var c=b(a.target),d=c.val(),e=c.data("autocomplete.value");if(!this._cancelAutoComplete)return 0===d.length?(this._resetTreeList(),void this.cancelSelection()):void(this._autoCompleteListIsShow()&&e===d||(c.data("autocomplete.value",d),this.isShow()||this.show(),this._launch(d)))}var h="autocomplete-selected";a.ctrls.define("ui.ctrls.AutocompleteSelectionTree",a.ctrls.SelectionTree,{_create:function(){this.option.multiple=!1,a.core.isNumber(this.option.limit)?this.option.limit<=0?this.option.limit=10:this.option.limit>100&&(this.option.limit=100):this.option.limit=10,this.onFocusHandler=c.bind(this),this.onKeyupHandler=d.bind(this),this.onMouseoverHandler=e.bind(this),this.onClickHandler=f.bind(this),this.onTextinputHandler=g.bind(this),this._super()},_render:function(){var b;this._super({focus:this.onFocusHandler,keyup:this.onKeyupHandler}),a.browser.ie&&a.browser<9&&(b=this.fire,this.fire=function(){this._callAndCancelPropertyChange(b,arguments)}),this.element.textinput(this.onTextinputHandler),this._clear=function(){this.cancelSelection(!0,this._autoCompleteListIsShow())}},_callAndCancelPropertyChange:function(a,b){this._cancelAutoComplete=!0,a.apply(this,b),this._cancelAutoComplete=!1},_launch:function(a){var b,c=this.getViewData();0!==c.length&&(this.cancelSelection(!1,!1),b=this._search(a,c,this.option.limit),this._showSearchInfo(b,a))},_search:function(a,b,c){var d,e=[],f=[];return a=a.toLowerCase(),this._doSearch(e,f,a,b,c),d=e.concat(f),d.slice(0,c)},_doSearch:function(a,b,c,d,e,f){var g,h,i,j;for(g=0,h=d.length;g<h;g++){if(a.length>e)return;j=f?f+"_"+g:""+g,i=d[g],this._hasChildren(i)?(!0===this.option.nodeSelectable&&this._doQuery(a,b,c,i,j),this._doSearch(a,b,c,this._getChildren(i),e,j)):this._doQuery(a,b,c,i,j)}},_doQuery:function(a,b,c,d,e){var f;f=this._getText.call(d,this.option.textField).toLowerCase().search(c),0===f?a.push({nodeData:d,path:e}):f>0&&b.push({nodeData:d,path:e})},_showSearchInfo:function(a,c){var d,e,f,g,h,i,j;for(d=this._autoCompleteList,d?d.empty():(d=this._autoCompleteList=b("<dl class='autocomplete-dl' />"),d.hide(),d.on("click",this.onClickHandler).mouseover(this.onMouseoverHandler),this.treePanel.append(d)),e=[],g=new RegExp(c,"gi"),h="<span class='font-highlight'>"+c+"</span>",i=0,j=a.length;i<j;i++)e.push("<dt class='autocomplete-dt' data-path='"+a[i].path+"'>"),e.push("<span class='normal-text'>"),f=this._getText.call(a[i].nodeData,this.option.textField),f=f.replace(g,h),e.push(f),e.push("</span></dt>");b(this.treePanel.children()[0]).hide(),d.append(e.join("")),d.show(),this._moveSelection(1)},_autoCompleteListIsShow:function(){return!!this._autoCompleteList&&"block"===this._autoCompleteList.css("display")},_resetTreeList:function(){var a=this.treePanel.children();b(a[1]).hide(),b(a[0]).show()},_selectCompleter:function(){var b,c,d;this._currentCompleterElement&&(b=this._currentCompleterElement.attr("data-path"),c=this._getNodeDataByPath(b),c&&(d=this._selectNodeByValue(c,b),this.fire("changed",this._getSelectionData(d,c))),a.hideAll())},_moveSelection:function(a){var c,d;c=b(this.treePanel.children()[1]).children(),this._currentCompleterElement?this._currentCompleterElement.removeClass(h):this._currentCompleterElement=b(c[0]),0===a?this._currentCompleterElement=b(c[0]):1===a?(d=this._currentCompleterElement.next(),0===d.length&&(d=b(c[0])),this._currentCompleterElement=d):-1===a&&(d=this._currentCompleterElement.prev(),0===d.length&&(d=b(c[c.length-1])),this._currentCompleterElement=d),this._currentCompleterElement.addClass(h)},_selectItem:function(){this._callAndCancelPropertyChange(this._super,arguments)},cancelSelection:function(a,b){b?(this._callAndCancelPropertyChange(function(){this.element.val("")}),this._resetTreeList()):this._super(a)}}),b.fn.autocompleteSelectionTree=function(b){return 0===this.length?null:a.ctrls.AutocompleteSelectionTree(b,this)}}(ui,ui.$),function(a,b){function c(){}function d(a){return a<10?"0"+a:""+a}function e(a,b){var c,e,f=a.getHours(),g=a.getMinutes(),h=a.getSeconds();return b&&(c=new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0),e=a-c,(e=e/1e3/60/60)>=24&&(f=24)),[d(f),":",d(g),":",d(h)].join("")}function f(a){return["<span",this.calendar.isWeekend(a.getDay())?" class='ui-calendar-weekend'":"",">",a.getMonth()+1," / ",a.getDate(),"（"+r.sundayFirstWeek[a.getDay()],"）","</span>"].join("")}function g(a){for(var c,d=b(a.target);"TD"!==(c=d.nodeName());){if("TABLE"===c)return;d=d.parent()}d[0]!==a.target&&(d.context=a.target),this._selectItem(d)}function h(a){for(var c,d=b(a.target);"TD"!==(c=d.nodeName());){if("TABLE"===c)return;d=d.parent()}d[0]!==a.target&&(d.context=a.target),this._selectItem(d)}function i(a){for(var c,d,e=b(a.target);"TH"!==(d=e.nodeName());){if("TABLE"===d)return;e=e.parent()}c={view:this,index:e[0].cellIndex},this.calendar.fire("weekTitleClick",c)}function j(a){var b={view:this,index:0};this.calendar.fire("weekTitleClick",b)}function k(a){if(!(this instanceof k))return new k(a);this.initialize(a)}function l(a){if(!(this instanceof l))return new l(a);this.initialize(a)}function m(a){if(!(this instanceof m))return new m(a);this.initialize(a)}function n(a){if(!(this instanceof n))return new n(a);this.initialize(a)}function o(a,b,c){if(!(this instanceof o))return new o(a,b,c);this.initialize(a,b,c)}function p(c){var d,e,f,g;t=!0,s?g=a.StyleSheet(s):(s=b("#GlobalThemeChangeStyle"),0===s.length?(g=a.StyleSheet.createStyleSheet("GlobalThemeChangeStyle"),s=g.styleSheet):g=a.StyleSheet(s)),c||(c=a.theme.currentHighlight||{color:"#3E5A99"}),d=a.theme.backgroundColor||"#FFFFFF",e=c.Color||c.color,f=a.color.overlay(e,d,.4),f=a.color.rgb2hex(f.red,f.green,f.blue),g.setRule(".ui-calendar-selector",{"background-color":f}),g.setRule(".ui-calendar-hour-panel .schedule-item-panel",{"background-color":f}),g.setRule(".ui-calendar-hour-panel .schedule-item-panel:hover",{"background-color":e}),g.setRule(".ui-calendar-month-day-view .month-days-table .selected",{"background-color":f}),g.setRule(".ui-calendar-year-view .year-month-table .selected",{"background-color":f}),f=a.color.overlay(e,d,.85),f=a.color.rgb2hex(f.red,f.green,f.blue),g.setRule(".ui-calendar-hour-panel .week-hour-cell-today",{"background-color":f}),f=a.color.overlay(e,d,.7),f=a.color.rgb2hex(f.red,f.green,f.blue),g.setRule(".ui-calendar-month-day-view .month-days-cell .schedule-item",{"background-color":f}),g.setRule(".ui-calendar-month-day-view .month-days-cell .schedule-border",{"background-color":e})}var q,r=a.i18n("control","ui.ctrls.CalendarView");k.prototype={constructor:k,initialize:function(a){this.calendar=a,this.initialled=!1,this.year=null,this._selectList=[],this._current=null,this.width=null,this.height=null,this.viewPanel=b("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this.onYearItemClickHandler=g.bind(this),this.yearPanel=b("<div class='ui-calendar-year-view' />"),this._initYear(),this.viewPanel.append(this.yearPanel),this.initialled=!0)},_initYear:function(){var a,c;for(c=0;c<12;c++)a=b("<div class='year-month-panel' />"),a.append(b("<div class='year-month-title' />").append("<span class='font-highlight'>"+(c+1)+r.monthUnit+"</span>")),a.append("<div class='year-month-content' />"),this.yearPanel.append(a);this.yearPanel.append("<br clear='all' />")},_oddStyle:function(a,b,c){c%2&&a.addClass("year-month-odd")},_evenStyle:function(a,b,c){Math.floor(c/b)%2?c%2&&a.addClass("year-month-odd"):c%2==0&&a.addClass("year-month-odd")},_setCellSize:function(c,d){var e,f,g,h,i,j,k;if(c&&d&&(this.width!==c||this.height!==d))for(this.width=c,this.height=d,e=this.getMonthCount(c),f=e%2?this._oddStyle:this._evenStyle,g=this.yearPanel.children(),g.removeClass("year-month-odd"),i=Math.floor(c/e),j=Math.floor(i/4*3),(j*(12/e)>d||this.yearPanel[0].scrollHeight>d)&&(c-=a.scrollbarWidth,i=Math.floor(c/e)),j<248&&(j=248),k=0;k<12;k++)h=b(g[k]),h.css({width:i+"px",height:j+"px"}),h.children(".year-month-content").css("height",j-40+"px"),f.call(this,h,e,k)},_changeYear:function(a){this.calendar.currentDate=a,this.year=this.calendar.currentDate.getFullYear(),this._setCellSize(this.viewPanel.width(),this.viewPanel.height()),this._updateYear(),this._current=null,this._selectList=[]},_updateYear:function(){var a,c=this.yearPanel.children(".year-month-panel"),d=this.calendar.currentDate.getFullYear(),e=null,f=new Date;for(a=0;a<12;a++)e=b(c[a]),this._createMonth(b(e.children()[1]),d,a,f)},_createMonth:function(a,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(f=b("<table class='year-month-table unselectable' cellspacing='0' cellpadding='0' />"),g=b("<colgroup />"),h=b("<thead />"),i=b("<tbody />"),l=this.calendar.getWeekNames(),j=b("<tr />"),s=0;s<l.length;s++)g.append("<col />"),p=this.calendar.isWeekend(s)?"<th class='year-month-table-head ui-calendar-weekend'>":"<th class='year-month-table-head'>",j.append(p+"<span>"+l[s]+"</span></th>");for(h.append(j),m=1,n=this.calendar.getWeekIndexOf(new Date(c,d,m)),o=new Date(c,d+1,0).getDate(),p=!1,c===e.getFullYear()&&d===e.getMonth()&&(p=!0,q=e.getDate()),s=0;s<6;s++){for(j=b("<tr />"),t=0;t<7;t++)k=b("<td class='year-month-table-cell' />"),j.append(k),0===s&&t<n?k.addClass("ui-calendar-empty"):m<=o&&(r=b("<span>"+m+"</span>"),p&&m===q&&r.addClass("today").addClass("background-highlight"),k.append(r),m++);i.append(j)}f.append(g).append(h).append(i),a.empty().append(f),f.data("month",d),f.on("click",this.onYearItemClickHandler)},_isDateCell:function(a){return!a.hasClass("ui-calendar-empty")&&a.children().length>0},_getDateByCell:function(a){var b,c,d;return b=a.parent().parent().parent(),c=parseInt(b.data("month"),10),d=parseInt(a.children().text(),10),new Date(this.year,c,d)},_getCellByDate:function(a,c){var d,e;return d=b(b(a[c.getMonth()]).children()[1]),e=this.calendar.getTableIndexOf(c),b(d.children()[0].tBodies[0].rows[e.rowIndex].cells[e.cellIndex])},_selectItem:function(a){var c,d,e;if(this._isDateCell(a)&&(c={},c.date=this._getDateByCell(a),c.view=this,c.element=a,c.originElement=a.context?b(a.context):null,!1!==this.calendar.fire("selecting",c)))if(this.isMultiple())if(a.hasClass("selected")){for(a.removeClass("selected"),d=0,e=this._selectList.length;d<e;d++)if(this._selectList[d]===a[0]){this._selectList.splice(d,1);break}this.calendar.fire("deselected",c)}else a.addClass("selected"),this._selectList.push(a[0]),this.calendar.fire("selected",c);else{if(this._current){if(this._current.removeClass("selected"),this._current[0]===a[0])return void this.calendar.fire("deselected",c);this._current=null}this._current=a,this._current.addClass("selected"),this.calendar.fire("selected",c)}},_updateSchedules:function(b,c,d){var e,f,g,h,i,j,k,l;if(Array.isArray(b))for(c||(c="date"),f=a.core.isFunction(c)?c:function(){return this[c]},l=a.core.isFunction(d),e=this.yearPanel.children(".year-month-panel"),i=0,j=b.length;i<j;i++){if((k=b[i])instanceof Date)g=k;else if(!((g=f.call(k))instanceof Date))continue;h=this._getCellByDate(e,g),l&&d.call(h,k)}},getMonthCount:function(a){return a>=1024?4:a>=768?3:a>=512?2:1},checkChange:function(){return this.calendar.hideTimeLine(),this.year!==this.calendar.currentDate.getFullYear()&&(this._changeYear(this.calendar.currentDate),!0)},active:c,dormant:c,previous:function(){var a=this.calendar.currentDate;this._changeYear(new Date(a.setFullYear(a.getFullYear()-1)))},next:function(){var a=this.calendar.currentDate;this._changeYear(new Date(a.setFullYear(a.getFullYear()+1)))},today:function(a){a&&a instanceof Date||(a=new Date),this._changeYear(new Date(a.getTime()))},addSchedules:function(b,c,d){var e;a.core.isFunction(d)||(d=null),e=function(a){0===this.children(".year-day-marker").length&&this.append("<i class='year-day-marker border-highlight'></i>"),d&&d.call(this,a)},
this._updateSchedules(b,c,e)},removeSchedules:function(b,c,d){var e;a.core.isFunction(d)||(d=null),e=function(a){var b=this.children(".year-day-marker");b.length>0&&b.remove(),d&&d.call(this,a)},this._updateSchedules(b,c,e)},clearSchedules:function(){var a,c,d,e,f,g,h,i;for(a=this.yearPanel.children(".year-month-panel"),g=0;g<12;g++)for(c=b(a[g]).children(".year-month-content").children(".year-month-table")[0].tBodies[0].rows,h=0;h<c.length;h++)for(d=c[h].cells,i=0;i<d.length;i++)e=b(d[i]),f=e.children(".year-day-marker"),f.length>0&&f.remove()},isMultiple:function(){return!!this.calendar.option.yearMultipleSelect},getSelection:function(){var a,c,d=null;if(this.isMultiple())for(d=[],a=0,c=this._selectList.length;a<c;a++)d.push(this._getDateByCell(b(this._selectList[a])));else this._current&&(d=this._getDateByCell(this._current));return d},setSelection:function(b){var c,d,e,f,g;for(Array.isArray(b)||(b=[b]),c=this.yearPanel.children(".year-month-panel"),f=0,g=b.length;f<g;f++)if((d=b[f])instanceof Date){if(d.getFullYear()!==this.year)throw new Error(a.str.format("the date({0}) does not belong to {1}",a.date.format(d,"yyyy-MM-dd"),this.year));e=this._getCellByDate(c,d),this._selectItem(e)}},cancelSelection:function(){var a,c,d,e;if(a="selected",this.isMultiple()){for(d=0,e=this._selectList.length;d<e;d++)c=b(this._selectList[d]),c.removeClass(a);this._selectList=[]}else this._current&&(this._current.removeClass(a),this._current=null);this.calendar.fire("cancel",this)},setSize:function(a,b){this._setCellSize(a,b)},getTitle:function(){return this.year+r.yearUnit},toString:function(){return"ui.ctrls.CalendarView.YearView"}},l.prototype={constructor:l,initialize:function(a){this.calendar=a,this.year=null,this.month=null,this.initialled=!1,this._selectList=[],this._current=null,this.width=null,this.height=null,this.viewPanel=b("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this.onMonthItemClickHandler=h.bind(this),this._setCurrent(),this.weekPanel=b("<div class='ui-calendar-month-week-view' />"),this._createWeek(),this.daysPanel=b("<div class='ui-calendar-month-day-view' />"),this._createDays(),this.viewPanel.append(this.weekPanel).append(this.daysPanel),this.initialled=!0)},_setCurrent:function(){var a=this.calendar.currentDate;this.year=a.getFullYear(),this.month=a.getMonth()},_createWeek:function(){var a,c,d,e,f,g,h;for(this.weekTable=b("<table class='month-week-table unselectable' cellspacing='0' cellpadding='0' />"),d=b("<thead />"),c=b("<colgroup />"),this.weekTable.append(c).append(d),e=b("<tr />"),a=this.calendar.getWeekNames(),g=0,h=a.length;g<h;g++)c.append("<col />"),f=b("<th class='month-week-cell' />"),this.calendar.isWeekend(g)&&f.addClass("ui-calendar-weekend"),f.append("<span class='month-week-text'>星期"+a[g]+"</span>"),g===h-1&&f.addClass("month-week-cell-last"),e.append(f);d.append(e),this.weekPanel.append(this.weekTable)},_createDays:function(){var a,c,d,e,f,g,h,i,j,k,l,m,n,o;for(this.daysTable?this.daysTable.html(""):(this.daysTable=b("<table class='month-days-table unselectable' cellspacing='0' cellpadding='0' />"),this.daysTable.on("click",this.onMonthItemClickHandler)),a=b("<tbody />"),c=b("<colgroup />"),m=0;m<7;m++)c.append("<col />");for(this.daysTable.append(c).append(a),f=this.calendar.currentDate,g=new Date(f.getFullYear(),f.getMonth(),1),i=this.calendar.getWeekIndexOf(g),h=new Date(g.getFullYear(),g.getMonth()+1,0).getDate(),g=1,j=new Date,k=j.getDate(),j.getFullYear()===f.getFullYear()&&j.getMonth()===f.getMonth()&&(l=function(a,b){b===k&&a.children().children(".month-date").addClass("font-highlight")}),o=g,m=0;m<6;m++){for(d=b("<tr />"),n=0;n<7;n++)e=b("<td class='month-days-cell' />"),d.append(e),0===m&&n<i||o>h||(e.append("<div class='day-container' />"),this.calendar.isWeekend(n)&&e.addClass("month-days-cell-weekend"),6===n&&e.addClass("month-days-cell-last"),e.children().html("<span class='month-date'>"+o+"</span>"),l&&l.call(this,e,o),o++);if(a.append(d),o>h)break}this.daysPanel.append(this.daysTable)},_setCellSize:function(a,c){var d,e,f,g,h,i,j,k,l;if(a&&c&&(this.width!==a||this.height!==c)){for(this.width=a,this.height=c,c-=26,this.daysPanel.css("height",c+"px"),d=this._setCellWidth(a),e=this.daysTable[0].rows,l=e.length,c-=l,g=Math.floor(c/l),h=c-g*(l-1),k=0;k<l;k++)k<l-1?b(e[k]).children().css("height",g+"px"):b(e[k]).children().css("height",h+"px");for(f=this.weekTable[0].tHead.rows[0].cells,i="",j=this.calendar.getWeekNames(),d>=60&&(i="星期"),k=0,l=f.length;k<l;k++)b(f[k]).children().text(i+j[k])}},_setCellWidth:function(a){var b,c,d;return b=Math.floor(a/7),c=this.weekTable.children("colgroup").children(),d=this.daysTable.children("colgroup").children("col"),c.splice(6,1),d.splice(6,1),c.css("width",b+"px"),d.css("width",b+"px"),b},_changeMonth:function(a){this.calendar.currentDate=a,this._setCurrent(),this._createDays(),this._setCellSize(this.viewPanel.width(),this.viewPanel.height()),this._current=null,this._selectList=[]},_isDateCell:function(a){return a.children(".day-container").children().length>0},_getDateByCell:function(a){var b,c;return b=a.children(".day-container"),c=b.children(".month-date"),0===c.length?null:(c=parseInt(c.text(),10),new Date(this.year,this.month,c))},_getCellByDate:function(a){var c,d;return c=this.daysTable[0].tBodies[0].rows,d=this.calendar.getTableIndexOf(a),b(c[d.rowIndex].cells[d.cellIndex])},_selectItem:k.prototype._selectItem,_updateSchedules:function(b,c,d){var e,f,g,h,i,j,k;if(Array.isArray(b))for(c||(c="date"),e=a.core.isFunction(c)?c:function(){return this[c]},k=a.core.isFunction(d),h=0,i=b.length;h<i;h++){if((j=b[h])instanceof Date)f=j;else if(!((f=e.call(j))instanceof Date))continue;g=this._getCellByDate(f),k&&d.call(g,j)}},checkChange:function(){var a;return this.calendar.hideTimeLine(),a=this.calendar.currentDate,(this.year!==a.getFullYear()||this.month!==a.getMonth())&&(this._changeMonth(a),!0)},active:c,dormant:c,previous:function(){var a=this.calendar.currentDate;this.width=null,this.height=null,this._changeMonth(new Date(a.setMonth(a.getMonth()-1)))},next:function(){var a=this.calendar.currentDate;this.width=null,this.height=null,this._changeMonth(new Date(a.setMonth(a.getMonth()+1)))},today:function(a){a&&a instanceof Date||(a=new Date),this.width=null,this.height=null,this._changeMonth(new Date(a.getTime()))},addSchedules:function(c,d,e){var f,g;a.core.isPlainObject(c)?(f=c,c=f.data,d=f.dateField,e=f.action):f={textField:"text"},g=a.core.isFunction(f.textField)?f.textField:function(){return this[f.textField]||null},a.core.isFunction(e)||(e=function(a){var c,d,e,f,h,i;e=this.children(".day-container"),c=e.children(".schedule-list"),0===c.length&&(c=b("<ul class='schedule-list' />"),c.data("schedule-items",[]),e.append(c)),d=c.data("schedule-items"),d.push(a),a.backgroundColor&&(h=" style='background-color:"+a.backgroundColor+"'"),a.borderColor&&(i=" style='background-color:"+a.borderColor+"'"),f=[],f.push("<li class='schedule-item'",h,">"),f.push("<b class='schedule-border'",i,"></b>"),f.push("<span class='schedule-text'>",g.call(a),"</span>"),f.push("</li>"),c.append(f.join(""))}),this._updateSchedules(c,d,e)},removeSchedules:function(c,d,e){var f,g;a.core.isPlainObject(c)?(f=c,c=f.data,d=f.dateField,e=f.action):f={idField:function(){return this}},g=a.core.isFunction(f.idField)?f.idField:function(){return this[f.idField]||null},a.core.isFunction(e)||(e=function(a){var c,d,e,f,h,i,j;if(c=this.children(".day-container"),d=c.children(".schedule-list"),0!==d.length){for(e=d.data("schedule-items"),f=-1,h=0,i=e.length;h<i;h++)if(j=e[h],g.call(j)===g.call(a)){f=h;break}f>-1&&(b(d.children()[f]).remove(),e.splice(f,1))}}),this._updateSchedules(c,d,e)},clearSchedules:function(b){var c,d,e;for(e=new Date(this.year,this.month+1,0).getDate(),a.core.isFunction(b)||(b=function(){var a,b;a=this.children(".day-container"),b=a.children(".schedule-list"),b.removeData("schedule-items"),b.remove()}),d=1;d<=e;d++)c=this._getCellByDate(new Date(this.year,this.month,d)),b.call(c)},isMultiple:function(){return!!this.calendar.option.monthMultipleSelect},getSelection:k.prototype.getSelection,setSelection:function(b){var c,d,e,f;for(Array.isArray(b)||(b=[b]),e=0,f=b.length;e<f;e++)if((c=b[e])instanceof Date){if(c.getFullYear()!==this.year||c.getMonth()!==this.month)throw new Error(a.str.format("the date({0}) does not belong to {1}-{2}",a.date.format(c,"yyyy-MM-dd"),this.year,this.month));d=this._getCellByDate(c),this._selectItem(d)}},cancelSelection:k.prototype.cancelSelection,setSize:function(a,b){this._setCellSize(a,b)},getTitle:function(){return this.year+"年"+(this.month+1)+"月"},toString:function(){return"ui.ctrls.CalendarView.MonthView"}},m.prototype={constructor:m,initialize:function(a){this.calendar=a,this.startDate=null,this.endDate=null,this.year=null,this.month=null,this.todayIndex=-1,this.weekDays=null,this.weekHours=[],this.initialled=!1,this.width=null,this.height=null,this.singleSelect=!!this.calendar.option.weekSingleSelect,this.viewPanel=b("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this._formatDayText=this.calendar.option.formatWeekDayHead,a.core.isFunction(this._formatDayText)||(this._formatDayText=f),this.onWeekHeadItemClickHandler=i.bind(this),this.weekDays=this.calendar.getWeek(this.calendar.currentDate),this._setCurrent(),this.weekDayPanel=b("<div class='ui-calendar-week-view' />"),this._createWeek(),this.hourPanel=b("<div class='ui-calendar-hour-panel' />"),this._createHourName(),this._createHour(),this._setTodayStyle(),this.viewPanel.append(this.weekDayPanel).append(this.hourPanel),this.selector=o(this,this.hourPanel,this.hourTable),this.selector.getDateByIndex=function(a){return this.view.weekDays[a]},this.hourAnimator=a.animator(this.hourPanel,{ease:a.AnimationStyle.easeTo,onChange:function(a,b){b.scrollTop(a)}}),this.hourAnimator.duration=800,this.initialled=!0)},_setCurrent:function(){var a=this.weekDays[0];this.startDate=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),a=this.weekDays[6],this.endDate=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59),this.year=a.getFullYear(),this.month=a.getMonth()},_createWeek:function(){var a,c,d,e,f,g;for(this.weekTable=b("<table class='ui-calendar-weekday unselectable' cellspacing='0' cellpadding='0' />"),a=b("<thead />"),c=b("<colgroup />"),d=b("<tr />"),f=0;f<7;f++)g=this.weekDays[f],c.append("<col />"),e=b("<th class='weekday-cell' />"),e.html(this._formatDayText(g)),d.append(e);a.append(d),this.weekTable.append(c).append(a),this.weekDayPanel.append(this.weekTable),this.weekTable.on("click",this.onWeekHeadItemClickHandler)},_createHourName:function(){var a,c,d,e,f,g,h,i;for(this.hourNames=b("<div class='hour-name-panel' />"),a=b("<table class='hour-name-table unselectable' cellspacing='0' cellpadding='0' />"),c=b("<colgroup />"),c.append("<col style='width:0px;' />").append("<col />"),a.append(c),d=b("<tbody />"),i=this.calendar._getTimeCellCount(),g=0;g<24;g++)for(h=0;h<i;h++)e=b("<tr />"),f=b("<td class='hour-name-cell' />"),(h+1)%i&&f.addClass("hour-name-cell-odd"),e.append(f),0===h&&(f=b("<td class='hour-name-cell' rowspan='"+i+"' />"),f.append("<h3 class='hour-name-text'>"+g+"</h3>"),e.append(f)),d.append(e);a.append(d),this.hourNames.append(a),this.hourPanel.append(this.hourNames)},_createHour:function(){var a,c,d,e,f,g,h,i;for(this.weekHour=b("<div class='week-hour-panel' />"),this.hourTable=b("<table class='week-hour-table unselectable' cellspacing='0' cellpadding='0' />"),a=b("<tbody />"),c=b("<colgroup />"),f=0;f<7;f++)c.append("<col />");for(i=this.calendar._getTimeCellCount(),g=24*i,f=0;f<g;f++){for(d=b("<tr />"),h=0;h<7;h++)e=b("<td class='week-hour-cell' />"),this.calendar.isWeekend(h)&&e.addClass("week-hour-cell-weekend"),(f+1)%i&&e.addClass("week-hour-cell-odd"),d.append(e);a.append(d)}this.hourTable.append(c).append(a),this.weekHour.append(this.hourTable),this.hourPanel.append(this.weekHour)},_setTodayStyle:function(){var a,c,d,e,f,g;for(a=new Date,this.todayIndex=-1,f=0;f<7;f++)if(c=this.weekDays[f],c.getFullYear()==a.getFullYear()&&c.getMonth()==a.getMonth()&&c.getDate()==a.getDate()){this.todayIndex=f;break}if(!(this.todayIndex<0))for(d=this.hourTable[0],f=0,g=d.rows.length;f<g;f++)e=d.rows[f],b(e.cells[this.todayIndex]).addClass("week-hour-cell-today")},_clearTodayStyle:function(){var a,c,d,e,f;for(a=this.hourTable[0].tBodies[0].rows,d=-1,e=0,f=a[0].cells.length;e<f;e++)if(c=b(a[0].cells[e]),c.hasClass("week-hour-cell-today")){d=e;break}if(!(d<0))for(e=0,f=a.length;e<f;e++)c=b(a[e].cells[d]),c.removeClass("week-hour-cell-today")},_setCellSize:function(b,c){var d,e,f,g,h=0;b&&c&&(this.width===b&&this.height===c||(this.width=b,this.height=c,c<this.hourPanel[0].scrollHeight&&(h=a.scrollbarWidth),d=b-80-h,e=Math.floor(d/7),e<95&&(e=95),f=this.weekTable.find("col"),g=this.hourTable.find("col"),this.weekTable.css("width",7*e+"px"),this.hourTable.css("width",7*e+"px"),f.css("width",e+"px"),g.css("width",e+"px"),this.selector.cellWidth>1&&this._restoreSchedules(e-this.selector.cellWidth),this.selector.cellWidth=e,this.selector.cancelSelection()))},_updateWeek:function(){var a,c,d,e;for(a=this.weekTable[0].tHead.rows[0],e=0;e<7;e++)d=this.weekDays[e],c=b(a.cells[e]),c.html(this._formatDayText(d)),c.attr("class","weekday-cell")},_addScheduleItem:function(c,d,e,f,g){var h,i,j,k,l;h=b("<div class='schedule-item-panel' />"),i=b("<div class='time-title' />"),i.html("<span class='time-title-text'>"+g+"</span>"),j=b("<div class='schedule-container' />"),h.append(i).append(j),k=this._getPositionAndSize(c),l=this._getPositionAndSize(d),h.css({top:k.top+"px",left:k.left+"px",width:k.width+"px",height:l.height+l.top-k.top+"px"}),b(this.hourPanel).append(h),f.itemPanel=h,this._setScheduleInfo(f.columnIndex,f),a.core.isFunction(e)&&e.call(this,f,j)},_findSchedules:function(b,c){var d,f,g,h,i,j,k;for(k=a.core.isFunction(c),d=0;d<b.length;d++)if((g=b[d])instanceof Date&&(h=this.calendar.getWeekIndexOf(g),i=this.calendar.timeToIndex(e(g)),j=this._getScheduleInfo(h)))for(f=j.length-1;f>=0;f--)i===j[f].beginRowIndex&&k&&c.call(this,j[f],f,j)},_restoreSchedules:function(a){var b,c,d,e,f,g,h;for(e=0;e<this.weekHours.length;e++)if(g=this.weekHours[e])for(f=0;f<g.length;f++)h=g[f].itemPanel,b=g[f].weekIndex,c=parseFloat(h.css("left")),d=parseFloat(h.css("width")),h.css({left:c+b*val+"px",width:d+val+"px"})},_setScheduleInfo:function(a,b){var c=this.weekHours[a];c||(c=[],this.weekHours[a]=c),b.weekIndex=a,c.push(b)},_getScheduleInfo:function(a){var b=this.weekHours[a];return b||null},_changeWeek:function(){this.calendar.currentDate=this.weekDays[0],this._setCurrent(),this.clearSchedules(),this.selector.cancelSelection(),this._updateWeek(),this._clearTodayStyle(),this._setTodayStyle()},_getUnitHourNameHeight:function(){var a,b;return this.hourNames?(a=this.hourNames.children("table")[0],b=a.tBodies[0].rows[0].cells[1].getBoundingClientRect(),b.height/this.calendar._getTimeCellCount()):25},_getPositionAndSize:function(a){var b,c;return b=a.position(),b.left=b.left+80,b.top=b.top,c=a.getBoundingClientRect(),{top:b.top,left:b.left,width:c.width-1,height:c.height-1}},checkChange:function(){var a=this.calendar.currentDate;return this.calendar.showTimeLine(this.hourPanel,this._getUnitHourNameHeight()),!(a>=this.startDate&&a<=this.endDate)&&(this.weekDays=this.calendar.getWeek(a),this._changeWeek(),!0)},active:function(){this.selector.active()},dormant:function(){this.selector.dormant()},previous:function(){var a=this.calendar.currentDate;this.weekDays=this.calendar.getWeek(new Date(a.getFullYear(),a.getMonth(),a.getDate()-7)),this._changeWeek()},next:function(){var a=this.calendar.currentDate;this.weekDays=this.calendar.getWeek(new Date(a.getFullYear(),a.getMonth(),a.getDate()+7)),this._changeWeek()},today:function(a){a&&a instanceof Date||(a=new Date),this.weekDays=this.calendar.getWeek(a),this._changeWeek()},setBeginTime:function(a){var b,c,d,e,f,g,h;b=this.hourPanel.height(),c=this.hourPanel[0].scrollHeight,b>=c||(this.hourAnimator.stop(),d=this.calendar.timeToIndex(a),e=this.calendar._getTimeCellCount(),d>e&&(d-=e),f=c-b,g=25*d,g>f&&(g=f),h=this.hourAnimator[0],h.begin=this.hourPanel.scrollTop(),h.end=g,this.hourAnimator.start())},addSchedules:function(c,d,f,g,h){var i,j,k,l,m,n,o,p;if(Array.isArray(c))for(i=a.core.isFunction(d)?d:function(){return this[d+""]||null},j=a.core.isFunction(f)?f:function(){return this[f+""]||null},a.core.isFunction(h)||(h=function(a){return this.calendar.getWeekIndexOf(a)}),n=0,o=c.length;n<o;n++)p=c[n],k={data:p},k.beginDate=i.call(p),k.endDate=j.call(p),k.beginDate instanceof Date&&k.endDate instanceof Date&&(k.columnIndex=h.call(this,k.beginDate),l=e(k.beginDate),m=e(k.endDate,k.beginDate),k.beginRowIndex=this.calendar.timeToIndex(l),k.endRowIndex=this.calendar.timeToIndex(m)-1,this._addScheduleItem(b(this.hourTable[0].rows[k.beginRowIndex].cells[k.columnIndex]),b(this.hourTable[0].rows[k.endRowIndex].cells[k.columnIndex]),g,k,l.substring(0,5)+" - "+m.substring(0,5)))},removeSchedules:function(a){this._findSchedules(a,function(a,b,c){a.itemPanel.remove(),c.splice(b,1)})},findSchedules:function(b,c,d){var e;b instanceof Date&&(b=[b]),Array.isArray(b)&&(d||(d=this),e=a.core.isFunction(c)?function(){c.apply(d,arguments)}:null,this._findSchedules(b,e))},clearSchedules:function(){var a,b,c;for(a=0;a<this.weekHours.length;a++)if(c=this.weekHours[a])for(b=0;b<c.length;b++)c[b].itemPanel.remove();this.weekHours=[]},hasSchedule:function(a){var b=this.weekHours[a];return!!b&&b.length>0},getSelection:function(){var a,b,c,d,e,f;if(f=[],!(a=this.selector.getSelection()))return f;for(b=this.weekDays[a.weekIndex],d=0,e=a.timeArray.length;d<e;d++)c=a.timeArray[d],f.push(new Date(b.getFullYear(),b.getMonth(),b.getDate(),c.hours,c.minutes,c.seconds));return f},setSelection:function(b,c){var d,e,f,g,h,i;if(b instanceof Date&&c instanceof Date){for(d=-1,g=0,h=this.weekDays.length;g<h;g++)if(i=this.weekDays[g],i.getFullYear()==b.getFullYear()&&i.getMonth()==b.getMonth()&&i.getDate()==b.getDate()){d=g;break}d<0||(e=a.date.format(b,"hh:mm:ss"),f=a.date.format(c,"hh:mm:ss"),this.selector.setSelectionByTime(d,e,f))}},cancelSelection:function(){this.selector.cancelSelection()},setSize:function(a,b){this.hourPanel.css("height",b-25+"px"),this._setCellSize(a,b)},getTitle:function(){return a.str.format("{0}年{1}月{2}日 ~ {3}年{4}月{5}日",this.startDate.getFullYear(),this.startDate.getMonth()+1,this.startDate.getDate(),this.endDate.getFullYear(),this.endDate.getMonth()+1,this.endDate.getDate())},toString:function(){return"ui.ctrls.CalendarView.WeekView"}},n.prototype={constructor:n,initialize:function(a){this.calendar=a,this.year=null,this.month=null,this.day=null,this.dayHours=[],this.initialled=!1,this.width=null,this.height=null,this.singleSelect=!!this.calendar.option.daySingleSelect,this.viewPanel=b("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this._formatDayText=this.calendar.option.formatDayHead,a.core.isFunction(this._formatDayText)||(this._formatDayText=f),this.onDayHeadItemClickHandler=j.bind(this),this._setCurrent(),this.dayPanel=b("<div class='ui-calendar-day-view' />"),this._createDay(),this.hourPanel=b("<div class='ui-calendar-hour-panel' />"),this._createHourName(),this._createHour(),this.viewPanel.append(this.dayPanel).append(this.hourPanel),this.selector=o(this,this.hourPanel,this.hourTable),this.selector.getDateByIndex=function(a){return new Date(this.view.year,this.view.month,this.view.day)},this.hourAnimator=a.animator(this.hourPanel,{ease:a.AnimationStyle.easeTo,onChange:function(a,b){b.scrollTop(a)}}),this.hourAnimator.duration=800,this.initialled=!0)},_setCurrent:function(){var a=this.calendar.currentDate;this.year=a.getFullYear(),this.month=a.getMonth(),this.day=a.getDate()},_createDay:function(){this.dayTitle=b("<div class='ui-calendar-day-title' />"),this.dayTitle.html("<span class='ui-calendar-day-title-text'>"+this._formatDayText(this.calendar.currentDate)+"</span>"),this.dayPanel.append(this.dayTitle),this.dayTitle.on("click",this.onDayHeadItemClickHandler)},_createHourName:m.prototype._createHourName,_createHour:function(){var a,c,d,e,f,g;for(this.weekHour=b("<div class='week-hour-panel' />"),this.hourTable=b("<table class='week-hour-table unselectable' cellspacing='0' cellpadding='0' />"),a=b("<tbody />"),e=this.calendar._getTimeCellCount(),f=0,g=24*e;f<g;f++)c=b("<tr />"),d=b("<td class='week-hour-cell' style='width:100%' />"),(f+1)%e&&d.addClass("week-hour-cell-odd"),c.append(d),a.append(c);this.hourTable.append(a),this.weekHour.append(this.hourTable),this.hourPanel.append(this.weekHour)},_setCellSize:function(b,c){var d,e=0;b&&c&&(this.width===b&&this.height===c||(this.width=b,this.height=c,c<this.hourPanel[0].scrollHeight&&(e=a.scrollbarWidth),d=b-80-e-2,this.dayTitle.css("width",d+"px"),this.hourTable.css("width",d+"px"),this.selector.cellWidth>1&&this._restoreSchedules(d-this.selector.cellWidth),this.selector.cellWidth=d,this.selector.cancelSelection()))},_addScheduleItem:m.prototype._addScheduleItem,_restoreSchedules:function(a){var b,c,d,e,f;for(e=0;e<this.dayHours.length;e++)f=this.dayHours[e].itemPanel,b=this.dayHours[e].weekIndex,c=parseFloat(f.css("left")),d=parseFloat(f.css("width")),f.css({left:c+b*val+"px",width:d+val+"px"})},_setScheduleInfo:function(a,b){this.dayHours.push(b)},_getScheduleInfo:function(a){return this.dayHours},_changeDay:function(){this._setCurrent(),this.clearSchedules(),this.selector.cancelSelection(),this.dayTitle.html("<span class='ui-calendar-day-title-text'>"+this._formatDayText(this.calendar.currentDate)+"</span>")},_getUnitHourNameHeight:m.prototype._getUnitHourNameHeight,_getPositionAndSize:m.prototype._getPositionAndSize,checkChange:function(){var a=this.calendar.currentDate;return this.calendar.showTimeLine(this.hourPanel,this._getUnitHourNameHeight()),(this.year!=a.getFullYear()||this.month!=a.getMonth()||this.day!=a.getDate())&&(this._changeDay(),!0)},active:function(){this.selector.active()},dormant:function(){this.selector.dormant()},previous:function(){var a=this.calendar.currentDate;this.calendar.currentDate=new Date(a.setDate(a.getDate()-1)),this._changeDay()},next:function(){var a=this.calendar.currentDate;this.calendar.currentDate=new Date(a.setDate(a.getDate()+1)),this._changeDay()},today:function(a){a&&a instanceof Date||(a=new Date),this.calendar.currentDate=new Date(a.getTime()),this._changeDay()},setBeginTime:m.prototype.setBeginTime,addSchedules:function(a,b,c,d,e){m.prototype.addSchedules.call(this,a,b,c,d,function(){return 0})},clearSchedules:function(){for(var a=0;a<this.dayHours.length;a++)this.dayHours[a].itemPanel.remove();this.dayHours=[]},hasSchedule:function(){return this.dayHours.length>0},getSelection:function(){var a,b,c,d,e,f;if(f=[],!(a=this.selector.getSelection()))return f;for(b=new Date(this.year,this.month,this.day),d=0,e=a.timeArray.length;d<e;d++)c=a.timeArray[d],f.push(new Date(b.getFullYear(),b.getMonth(),b.getDate(),c.hours,c.minutes,c.seconds));return f},setSelection:function(b,c){var d,e;b instanceof Date&&c instanceof Date&&(d=a.date.format(b,"hh:mm:ss"),e=a.date.format(c,"hh:mm:ss"),this.selector.setSelectionByTime(0,d,e))},cancelSelection:function(){this.selector.cancelSelection()},setSize:function(a,b){this.hourPanel.css("height",b-25+"px"),this._setCellSize(a,b)},getTitle:function(){return a.str.format("{0}年{1}月{2}日",this.year,this.month+1,this.day)},toString:function(){return"ui.ctrls.CalendarView.DayView"}},o.prototype={constructor:o,initialize:function(a,c,d){this.view=a,this.panel=c,this.grid=d,this.cellWidth=1,this.cellHeight=25,this.grid[0].onselectstart=function(){return!1},this.selectionBox=b("<div class='ui-calendar-selector unselectable click-enabled border-highlight' />"),this.selectionBox.boxTextSpan=b("<span class='ui-calendar-selector-time click-enabled' />"),this.selectionBox.append(this.selectionBox.boxTextSpan),this.panel.append(this.selectionBox),this._initEvents(),this._initAnimator()},_initEvents:function(){this.mouseLeftButtonDownHandler=function(a){1===a.which&&(b(document).on("mousemove",this.mouseMoveHandler),b(document).on("mouseup",this.mouseLeftButtonUpHandler),this.onMouseDown(b(a.target),a.clientX,a.clientY)&&(this._isBeginSelect=!0))}.bind(this),this.mouseMoveHandler=function(a){this._isBeginSelect&&this.onMouseMove(a)}.bind(this),this.mouseLeftButtonUpHandler=function(a){1===a.which&&this._isBeginSelect&&(this._isBeginSelect=!1,b(document).off("mousemove",this.mouseMoveHandler),b(document).off("mouseup",this.mouseLeftButtonUpHandler),this.onMouseUp(a))}.bind(this)},_initAnimator:function(){var b=this;this.selectAnimator=a.animator(this.selectionBox,{ease:a.AnimationStyle.swing,onChange:function(a,c){"up"!==b._selectDirection&&c.css("top",a+"px")}}).add(this.selectionBox,{ease:a.AnimationStyle.swing,onChange:function(a,b){b.css("left",a+"px")}}).add(this.selectionBox,{ease:a.AnimationStyle.swing,onChange:function(a,b){b.css("width",a+"px")}}).add(this.selectionBox,{ease:a.AnimationStyle.swing,onChange:function(a,c){b._selectDirection||c.css("height",a+"px")}}),this.selectAnimator.onEnd=function(){b._isNotCompletedYet&&(b._isNotCompletedYet=!1,b.onSelectCompleted())},this.selectAnimator.duration=200,this.selectAnimator.fps=60},_getSelectedCells:function(){var c,d,e,f,g,h,i,j,k,l,m,n,o=[],p=this.selectionBox;if("none"===p.css("display"))return o;if(c=p.text().split("-"),d=a.str.trim(c[0]||""),e=a.str.trim(c[1]||""),!d||!e)return o;for(d=this.view.calendar.timeToIndex(d),e=this.view.calendar.timeToIndex(e)-1,f=parseFloat(p.css("border-top-width")),g=d*this.cellHeight+1,h=parseFloat(p.css("left"))+f+1,i=this._getCellByPoint(h,g),o.push(i),j=e-d+1,k=this.grid[0],n=1;n<j;n++)l=k.rows[n+i.hourIndex],m=b(l.cells[i.weekIndex]),m.hourIndex=n+i.hourIndex,m.weekIndex=i.weekIndex,o.push(m);return o},_getCellByPoint:function(a,c){var d,e,f,g,h,i;return d=Math.ceil(a/this.cellWidth),e=Math.ceil(c/this.cellHeight),f=24*this.view.calendar._getTimeCellCount(),d<1&&(d=1),d>7&&(d=7),e<1&&(e=1),e>f&&(e=f),e--,d--,g=this.grid[0],h=g.rows[e],i=b(h.cells[d]),i.hourIndex=e,i.weekIndex=d,i},_selectCell:function(a){var b,c,d,e,f,g;return b=this.selectionBox,c=this._getPositionAndSize(a),e=a.hourIndex,f=a.hourIndex+1,arguments.length>1&&arguments[1]&&(f=arguments[1].hourIndex+1,d=this._getPositionAndSize(arguments[1]),c.height=d.top+d.height-c.top),this._selectDirection=null,this._beginTime=this.view.calendar.indexToTime(e),this._endTime=this.view.calendar.indexToTime(f),b.boxTextSpan.text(this._beginTime+" - "+this._endTime),this.selectAnimator.stop(),g=this.selectAnimator[0],g.begin=parseFloat(g.target.css("top")),g.end=c.top,g=this.selectAnimator[1],g.begin=parseFloat(g.target.css("left")),g.end=c.left,g=this.selectAnimator[2],g.begin=parseFloat(g.target.css("width")),g.end=c.width,g=this.selectAnimator[3],g.begin=parseFloat(g.target.css("height")),g.end=c.height,b.css("display","block"),this._isNotCompletedYet=!1,this.selectAnimator.start()},_autoScrollY:function(a,b){var c,d;c=this.panel.scrollTop(),"up"===b?a<c&&this.panel.scrollTop(c<this.cellHeight?0:c-this.cellHeight):"down"===b&&(d=c+this.panel.height(),a>d&&this.panel.scrollTop(c+this.cellHeight))},_isClickInGrid:function(b,c){var d,e,f,g,h,i,j;return d=this.panel.offset(),e=d.left+80,f=d.top,i=this.grid.width(),j=this.panel.height(),g=e+i-1,h=f+j,j<this.panel[0].scrollHeight&&(g-=a.scrollbarWidth),b>=e&&b<=g&&c>=f&&c<=h},_changeToGridPoint:function(a,b){var c=this.panel.offset();return c.left=c.left+80,{gridX:a-c.left+this.panel[0].scrollLeft,gridY:b-c.top+this.panel[0].scrollTop}},_getPositionAndSize:function(a){var b,c;return b=a.position(),b.left=b.left+80,c=a.getBoundingClientRect(),{top:b.top-2,left:b.left-2,width:c.width-1,height:c.height-1}},onMouseDown:function(a,b,c){var d,e,f;if(!this._isClickInGrid(b,c))return void(this._clickInGrid=!1);if(this._clickInGrid=!0,e=this._changeToGridPoint(b,c),"TD"!=a.nodeName()){if(!a.hasClass("click-enabled"))return;d=this._getCellByPoint(e.gridX,e.gridY)}else d=a,d.weekIndex=d[0].cellIndex,d.hourIndex=d.parent()[0].rowIndex;return f={view:this.view,element:this.selectionBox,weekIndex:d.weekIndex,hourIndex:d.hourIndex,originElement:null},!1!==this.view.calendar.fire("selecting",f)?(this._startCell=d,this._selectCell(d),this.checkSelectable(d),this.focusX=e.gridX,this.focusY=e.gridY,!0):void 0},onMouseMove:function(a){var b,c,d,e,f,g,h;b=this._changeToGridPoint(a.clientX,a.clientY),c=this._getCellByPoint(this.focusX,b.gridY),d=this._getPositionAndSize(c),e=this._getPositionAndSize(this._startCell),c.hourIndex<this.selectableMin||c.hourIndex>this.selectableMax||(f=this.selectionBox,b.gridY>this.focusY?(g=this._startCell,h=c,f.css({height:d.top+d.height-e.top+"px"}),this._selectDirection="down",this._autoScrollY(d.top+d.height,this._selectDirection)):(g=c,h=this._startCell,f.css({top:d.top+"px",height:e.top+e.height-d.top+"px"}),this._selectDirection="up",this._autoScrollY(d.top,this._selectDirection)),this._beginTime=this.view.calendar.indexToTime(g.hourIndex),this._endTime=this.view.calendar.indexToTime(h.hourIndex+1),f.boxTextSpan.text(this._beginTime+" - "+this._endTime))},onMouseUp:function(a){this._clickInGrid&&(this.selectAnimator.isStarted?this._isNotCompletedYet=!0:this.onSelectCompleted())},onSelectCompleted:function(){var a,b,c,d,e,f,g;arguments.length>0&&arguments[0]?arguments[0]:this.selectionBox,a=this.getDateByIndex(this._startCell.weekIndex),b=this._beginTime.split(":"),c=parseInt(b[0],10),d=parseInt(b[1],10),b=this._endTime.split(":"),e=parseInt(b[0],10),f=parseInt(b[1],10),this._startCell=null,this._beginTime=null,this._endTime=null,g=this,setTimeout(function(){var b,h={view:g.view,beginTime:new Date(a.getFullYear(),a.getMonth(),a.getDate(),c,d,0),endTime:new Date(a.getFullYear(),a.getMonth(),a.getDate(),e,f,0),originElement:null};b=g.getSelectorInfo(),h.element=b.element,h.top=b.top,h.left=b.left,h.parentWidth=b.parentWidth,h.parentHeight=b.parentHeight,g.view.calendar.fire("selected",h)},50)},checkSelectable:function(a){var b,c,d,e,f,g;if(b=this.view.calendar._getTimeCellCount(),this.selectableMin=0,this.selectableMax=24*b-1,this.view.singleSelect){if(c=this.view._getScheduleInfo(a.weekIndex),d=-1,e=24*b,c)for(g=0;g<c.length;g++)f=c[g],f.beginRowIndex<a.hourIndex?f.beginRowIndex>d&&(d=f.beginRowIndex):f.beginRowIndex<e&&(e=f.beginRowIndex),f.endRowIndex<a.hourIndex?f.endRowIndex>d&&(d=f.endRowIndex):f.endRowIndex<e&&(e=f.endRowIndex);this.selectableMin=d+1,this.selectableMax=e-1}},getSelectorInfo:function(){var a=this.selectionBox,b=this.view.hourTable.getBoundingClientRect();return{element:a,top:parseFloat(a.css("top")),left:parseFloat(a.css("left")),parentWidth:this.view.viewPanel.width()-80,parentHeight:b.height}},getSelection:function(){var a,b,c,d,e,f;if(b=this._getSelectedCells(),0===b.length)return null;for(a={weekIndex:null,timeArray:[]},c=this.view.calendar._getTimeCellCount(),d=function(a){var b,d;return b=Math.floor(a/c),d=60*(a/c-b),{hours:b,minutes:d,seconds:0}},a.weekIndex=b[0].weekIndex,a.timeArray.push(d(b[0].hourIndex)),e=0,f=b.length;e<f;e++)a.timeArray.push(d(b[e].hourIndex+1));return a},setSelectionByTime:function(a,b,c){var d,e,f,g,h;return d=(a+1)*this.cellWidth-1,e=(this.view.calendar.timeToIndex(b)+1)*this.cellHeight-1,f=this.view.calendar.timeToIndex(c)*this.cellHeight-1,g=this._getCellByPoint(d,e),h=this._getCellByPoint(d,f),this.focusX=d,this.focusY=e,this.view.setBeginTime(b),this._startCell=g,this._selectCell(g,h)},cancelSelection:function(){var a=this.selectionBox;a.css("display","none"),this._startCell=null,this.focusX=0,this.focusY=0,this.view.calendar.fire("deselected",{view:this.view,element:a})},active:function(a){a||this.selectionBox.css("display","none"),b(document).on("mousedown",this.mouseLeftButtonDownHandler)},dormant:function(a){
a||this.cancelSelection(),b(document).off("mousedown",this.mouseLeftButtonDownHandler)}},q={YEARVIEW:k,MONTHVIEW:l,WEEKVIEW:m,DAYVIEW:n},a.ctrls.define("ui.ctrls.CalendarView",{_defineOption:function(){return{views:["YearView","MonthView","WeekView","DayView"],defaultView:"WeekView",unitTime:30,sundayFirst:!1,startDate:null,yearMultipleSelect:!1,monthMultipleSelect:!1,weekSingleSelect:!1,daySingleSelect:!1,formatWeekDayHead:null,formatDayHead:null}},_defineEvents:function(){return["viewChanging","viewChanged","changing","changed","selecting","selected","deselected","weekTitleClick","cancel"]},_create:function(){var b;a.core.isNumber(this.option.unitTime)?(b=60/this.option.unitTime)%2&&(b-=1,this.option.unitTime=60/b):this.option.unitTime=30,this.views={},a.core.isString(this.option.defaultView)&&0!==this.option.defaultView.length||(this.option.defaultView="WeekView"),this.option.startDate instanceof Date?this.currentDate=this.option.startDate:this.currentDate=new Date,this.viewChangeAnimator=a.animator({ease:a.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"px")}}),this.viewChangeAnimator.add({ease:a.AnimationStyle.easeFrom,onChange:function(a,b){b.css("opacity",a/100)}}),this.viewChangeAnimator.duration=500},_render:function(){var b,c,d,e;for(this.element.addClass("ui-calendar-view").css("position","relative"),b=0,c=this.option.views.length;b<c;b++)d=this.option.views[b],a.core.isString(d)&&(d=d.toUpperCase(),q.hasOwnProperty(d)&&(this.views[d]=q[d](this)));if(!this.hasView(this.option.defaultView))for(b in this.views)if(this.views.hasOwnProperty(b)){this.option.defaultView=b;break}e=this,setTimeout(function(){e.changeView(e.option.defaultView,!1)})},_getTimeCellCount:function(){return Math.floor(60/this.option.unitTime)||1},_timeToCellNumber:function(a){var b,c,d,e;return b=a.split(":"),c=this._getTimeCellCount(),d=parseInt(b[0],10),e=parseInt(b[1],10),parseInt(b[2],10),(d+e/60)*c},_doChange:function(a){!1!==this.fire("changing",this.currentView,a)&&(this.currentView[a].call(this.currentView),this.fire("changed",this.currentView,a))},isSundayFirst:function(){return!!this.option.sundayFirst},getWeek:function(a){var b,c,d,e,f=null;if(a instanceof Date)for(a=new Date(a.getTime()),f=[],e=7,this.isSundayFirst()?(b=a.getDay(),a.setDate(a.getDate()-b)):(b=a.getDay()||e,a.setDate(a.getDate()-b+1)),c=new Date(a.getTime()),f.push(c),d=1;d<e;d++)f.push(new Date(a.setDate(a.getDate()+1)));return f},getWeekStartEnd:function(a){var b,c=null;a instanceof Date&&(a=new Date(a.getTime()),c={year:a.getFullYear(),month:a.getMonth()+1},this.isSundayFirst()?(b=a.getDay(),a.setDate(a.getDate()-b)):(b=a.getDay()||7,a.setDate(a.getDate()-b+1)),c.weekStartDate=new Date(a.getTime()),c.weekStartDay=c.weekStartDate.getDate(),c.weekEndDate=new Date(a.setDate(a.getDate()+6)),c.weekEndDay=c.weekEndDate.getDate())},getWeekIndexOf:function(a){var b=null;return a instanceof Date&&(b=a.getDay(),this.isSundayFirst()||(0===b?b=6:b--)),b},getWeekendIndexes:function(){var a={saturday:6,sunday:0};return this.isSundayFirst()||(a.saturday=5,a.sunday=6),a},isWeekend:function(a){return this.isSundayFirst()?6===a||0===a:5===a||6===a},getTableIndexOf:function(a){var b,c,d,e=null;return a instanceof Date&&(b=new Date(a.getFullYear(),a.getMonth(),1),c=this.getWeekIndexOf(b),d=a.getDate()+c-1,e={rowIndex:Math.floor(d/7),cellIndex:0},e.cellIndex=d-7*e.rowIndex),e},getWeekNames:function(){return this.isSundayFirst()?r.sundayFirstWeek:r.mondayFirstWeek},indexToTime:function(a){var b,c,e,f;return b=this._getTimeCellCount(),c=d(a/b),e=c.split("."),f=e[0]+":",e.length>1?f+=d(60*parseFloat("0."+e[1])):f+="00",f},timeToIndex:function(a){return a||(a="00:00"),Math.ceil(this._timeToCellNumber(a))},timeToPosition:function(a,b){return a||(a="00:00"),this._timeToCellNumber(a)*b},showTimeLine:function(a,c){var d,f,g;this.currentTimeElement?this.currentTimeElement.css("display","block"):(this.currentTimeElement=b("<div class='ui-current-time border-highlight font-highlight' />"),this.currentTimeElement.css("width","80px"),this.element.append(this.currentTimeElement)),this._timeoutHandler&&(clearTimeout(this._timeoutHandler),this._timeoutHandler=null),a.append(this.currentTimeElement),d=3e4,g=this,f=function(){var a,b,h,i;a=e(new Date),b=g.timeToIndex(a),h=g.timeToPosition(a,c),i=g.currentTimeElement,i.html("<span class='ui-current-time-text'>"+a.substring(0,5)+"</span>"),b<=1?i.addClass("ui-current-time-top").css("top",h+"px"):i.removeClass("ui-current-time-top").css("top",h-17+"px"),g._timeoutHandler=setTimeout(f,d)},this._timeoutHandler=setTimeout(f)},hideTimeLine:function(){this._timeoutHandler&&clearTimeout(this._timeoutHandler),this.currentTimeElement&&this.currentTimeElement.css("display","none")},previous:function(){this._doChange("previous")},next:function(){this._doChange("next")},today:function(){this._doChange("today")},hasView:function(a){return this.views.hasOwnProperty((a+"").toUpperCase())},isView:function(a,b){return!!a&&(b=(b+"").toUpperCase(),-1!==a.toString().toUpperCase().lastIndexOf(b))},getView:function(a){return a=(a+"").toUpperCase(),this.views.hasOwnProperty(a)?this.views[a]:null},changeView:function(b,c){var d,e,f,g,h,i,j;if(!(d=this.views[(b+"").toUpperCase()]))throw new Error(a.str.format("没有注册名为{0}的视图",b));if(!1!==this.fire("viewChanging",this.currentView,d)){if(this.currentView&&(this.viewChangeAnimator.stop(),this.currentView.viewPanel.css({display:"none",opacity:0}),this.currentView.dormant(),this.currentView=null),this.currentView=d,g=this.element.width(),this.currentView.viewPanel.css({display:"block",left:g/3+"px"}),e=!1,d.initialled||(d.render(),e=!0),f=d.checkChange(),d.setSize(this.element.width(),this.element.height()),h=this,j=function(){h.currentView.active(),h.fire("viewChanged",h.currentView),(e||f)&&h.fire("changed",h.currentView)},!1===c)return this.currentView.viewPanel.css({display:"block",left:"0",opacity:1}),void j();i=this.viewChangeAnimator[0],i.target=this.currentView.viewPanel,i.begin=g/3,i.end=0,i=this.viewChangeAnimator[1],i.target=this.currentView.viewPanel,i.begin=0,i.end=100,this.viewChangeAnimator.onEnd=j,this.viewChangeAnimator.start()}},setSize:function(a,b){this.element.css("height",b+"px"),this.currentView&&this.currentView.setSize(a,b)},getTitle:function(){return this.currentView?this.currentView.getTitle():""}}),b.fn.calendarView=function(b){return 0===this.length?null:(t||p(),a.ctrls.CalendarView(b,this))};var s,t=!1;a.page.hlchanged(function(a,b){p(b)})}(ui,ui.$),function(a,b){function c(){}function d(b){return b?a.str.htmlEncode(b):b}function e(b){var d;if("string"===(d=a.core.type(b)))this.option.group={groupField:b,itemsField:"_items",groupListHandler:f,headFormatter:g,headRearrangeHandler:h};else if("object"===d){if(a.core.isFunction(b.groupListHandler)||(b.groupListHandler=f),!b.groupField)throw new TypeError("the groupField can not be null or empty.");b.itemsField||(b.itemsField="_items"),a.core.isFunction(b.headFormatter)||(b.headFormatter=g),a.core.isFunction(b.headRearrangeHandler)||(b.headRearrangeHandler=c)}else this.option.group=!1}function f(b,c,d){return a.trans.listToGroup(b,c,null,d)}function g(b,c){return a.str.format("<span style='margin-left:{0}px;margin-right:{0}px' class='item-head-title font-highlight'>{1}</span>",c,d(b[this.option.group.groupField]))}function h(a,b,c,d){a.children(".item-head-title").css({"margin-left":d+"px","margin-right":d+"px"}),0===b&&a.css("margin-top",d+"px")}function i(b){b.showPageInfo&&(b.pageInfoFormatter||(b.pageInfoFormatter={currentRowNum:function(a){return"<span>本页"+a+"项</span>"},rowCount:function(a){return"<span class='font-highlight'>共"+a+"项</span>"},pageCount:function(a){return"<span>"+a+"页</span>"}})),this.pager=a.ctrls.Pager(b),this.pageIndex=this.pager.pageIndex,this.pageSize=this.pager.pageSize}function j(a){for(var c=b(a.target);!c.hasClass("view-item");){if(c.hasClass("ui-card-view-body"))return;c=c.parent()}c[0]!==a.target&&(c.context=a.target),this._selectItem(c)}var k="ui-card-view-selection";a.ctrls.define("ui.ctrls.CardView",{_defineOption:function(){return{viewData:null,promptText:"没有数据",group:!1,width:!1,height:!1,itemWidth:200,itemHeight:200,renderItemFormatter:null,pager:{pageIndex:1,pageSize:30,pageButtonCount:10,showPageInfo:!1,pageInfoFormatter:null},selection:{multiple:!1}}},_defineEvents:function(){var a=["selecting","selected","deselected","rebind","cancel"];return this.option.pager&&a.push("pagechanging"),a},_create:function(){this._itemBodyList=[],this._selectList=[],this._hasPrompt=!!this.option.promptText,this._currentMarginInfo=null,this.viewBody=null,this.pagerHeight=30,this.option.group&&e.call(this,this.option.group),this.option.pager&&i.call(this,this.option.pager),(!a.core.isNumber(this.option.width)||this.option.width<=0)&&(this.option.width=!1),(!a.core.isNumber(this.option.height)||this.option.height<=0)&&(this.option.height=!1),this.onBodyClickHandler=j.bind(this)},_render:function(){this.element.hasClass("ui-card-view")||this.element.addClass("ui-card-view"),this._initBorderWidth(),this.viewBody=b("<div class='ui-card-view-body' />"),this._initDataPrompt(),this.element.append(this.viewBody),this.option.selection&&this.viewBody.on("click",this.onBodyClickHandler),this._initPagerPanel(),this.setSize(this.option.width,this.option.height),this.option.selection?"disabled"===this.option.selection.type&&(this.option.selection=!1):this.option.selection=!1,Array.isArray(this.option.viewData)&&this.fill(this.option.viewData,this.option.viewData.length)},_initBorderWidth:function(){var a=function(a){return parseInt(this.element.css(a),10)||0};this.borderWidth=0,this.borderHeight=0,this.borderWidth+=a.call(this,"border-left-width"),this.borderWidth+=a.call(this,"border-right-width"),this.borderHeight+=a.call(this,"border-top-width"),this.borderHeight+=a.call(this,"border-bottom-width")},_initDataPrompt:function(){var c;this._hasPrompt&&(this._dataPrompt=b("<div class='data-prompt' />"),c=this.option.promptText,a.core.isString(c)&&c.length>0?this._dataPrompt.html("<span class='font-highlight'>"+d(c)+"</span>"):a.core.isFunction(c)&&(c=c(),this._dataPrompt.append(c)),this.viewBody.append(this._dataPrompt))},_initPagerPanel:function(){this.pager&&(this.gridFoot=b("<div class='ui-card-view-foot clear' />"),this.element.append(this.gridFoot),this.pager.pageNumPanel=b("<div class='page-panel' />"),this.option.pager.showPageInfo?(this.pager.pageInfoPanel=b("<div class='data-info' />"),this.gridFoot.append(this.pager.pageInfoPanel)):this.pager.pageNumPanel.css("width","100%"),this.gridFoot.append(this.pager.pageNumPanel),this.pager.pageChanged(function(a,b){this.pageIndex=a,this.pageSize=b,this.fire("pagechanging",a,b)},this))},_rasterizeItems:function(b,c){var d,e,f,g,h,i,j,k;e=this.getViewData(),0!==e.length&&(f=this.isGroup(),f&&(this._groupData||(g=this.option.group,this._groupData=g.groupListHandler.call(this,e,g.groupField,g.itemsField)),e=this._groupData),d=this._getMargin(e),this._currentMarginInfo=d,0!==d.count&&(k=a.core.isFunction(c),j=[],h=this,this._viewDataIndex=-1,f?e.forEach(function(a,b){i=h._getItemBody(b,f,j,d.margin),h._fillItemBody(a[h.option.group.itemsField],b,i,d,k,c)}):(i=this._getItemBody(0,f,j,d.margin),this._fillItemBody(e,0,i,d,k,c)),delete this._viewDataIndex,j.length>0&&h.viewBody.append(j)))},_getItemBody:function(a,c,d,e){var f,g;return f=this._itemBodyList[a],f?c&&(g=f.prev(),this.option.group.headRearrangeHandler.call(this,g,a,this._groupData[a],e)):(c&&(g=b("<div class='item-head' />"),g.append(this.option.group.headFormatter.call(this,this._groupData[a],e)),0===d.length&&g.css("margin-top",e+"px"),d.push(g)),f=b("<div class='item-body' />"),d.push(f),this._itemBodyList.push(f)),f},_fillItemBody:function(a,b,c,d,e,f){var g,h,i,j,k,l,m;for(g=Math.floor((a.length+d.count-1)/d.count),c.css("height",g*(this.option.itemHeight+d.margin)+d.margin+"px"),h=0;h<g;h++)for(i=0;i<d.count;i++){if((j=h*d.count+i)>=a.length)return;this._viewDataIndex++,k=(h+1)*d.margin+h*this.option.itemHeight,l=(i+1)*d.margin+i*this.option.itemWidth,m=a[j],m._group={index:b,itemIndex:j},e&&f.call(this,c,m,this._viewDataIndex,k,l)}},_getMargin:function(b,c){var d,e,f,g,h,i,j;return d=this.viewBody.width(),e=this.viewBody.height(),i=this.isGroup(),j=function(a,b){var c,d,f;if(0===b.count)return b;if(i)for(c=b.margin,d=0,f=a.length;d<f;d++)c+=30,c+=Math.floor((a[d][this.option.group.itemsField].length+b.count-1)/b.count)*(b.margin+this.option.itemHeight)+b.margin;else c=Math.floor((a.length+b.count-1)/b.count)*(b.margin+this.option.itemHeight)+b.margin;return c>e?this._getMargin(f,c):b},c&&(h=!0,c>e&&(d-=a.scrollbarWidth)),f={count:Math.floor(d/this.option.itemWidth),margin:0},g=d-f.count*this.option.itemWidth,f.margin=Math.floor(g/(f.count+1)),f.margin>=4?h?f:j.call(this,b,f):(f.margin=4,f.count=Math.floor((d-(f.count+1)*f.margin)/this.option.itemWidth),g=d-f.count*this.option.itemWidth,f.margin=Math.floor(g/(f.count+1)),h?f:j.call(this,b,f))},_createItem:function(a,c){var d=b("<div class='view-item' />");return d.css({width:this.option.itemWidth+"px",height:this.option.itemHeight+"px"}),d.attr("data-index",c),d},_renderItem:function(c,d,e){var f,g,h;h=this.option.renderItemFormatter,a.core.isFunction(h)&&(f=h.call(this,d,e))&&c.append(f),g=b("<div class='frame-panel border-highlight'/>"),g.css({width:this.option.itemWidth-8+"px",height:this.option.itemHeight-8+"px"}),c.append(g),c.append("<i class='check-marker border-highlight'></i>"),c.append("<i class='check-icon far fa-check'></i>")},_renderPageList:function(a){this.pager&&(this.pager.data=this.option.viewData,this.pager.pageIndex=this.pageIndex,this.pager.pageSize=this.pageSize,this.pager.renderPageList(a))},_rearrangeItems:function(){var a,c,d;if(0!==this._itemBodyList.length){for(d=[],a=0,c=this._itemBodyList.length;a<c;a++)d.push(this._itemBodyList[a].children());this._rasterizeItems(!1,function(a,c,e,f,g){var h,i;i=c._group,h=d[i.index][i.itemIndex],b(h).css({top:f+"px",left:g+"px"})})}},_getSelectionData:function(a){var b,c,d;return b=parseInt(a.attr("data-index"),10),d=this.getViewData(),c={itemIndex:b,itemData:d[b]},this.isGroup()&&(c.group={index:c.itemData._group.index,itemIndex:c.itemData._group.itemIndex}),c},_selectItem:function(a){var c,d,e;if(c=this._getSelectionData(a),c.element=a,c.originElement=a.context?b(a.context):null,!1!==this.fire("selecting",c))if(this.isMultiple())if(a.hasClass(k)){for(d=0,e=this._selectList.length;d<e;d++)if(this._selectList[d]===a[0]){this._selectList.splice(d,1);break}a.removeClass(k),this.fire("deselected",c)}else this._selectList.push(a[0]),a.addClass(k),this.fire("selected",c);else if(this._current){if(this._current.removeClass(k),this_current[0]===a[0])return this._current=null,void this.fire("deselected",c);this._current=a,a.addClass(k),this.fire("selected",c)}},_getItemElement:function(a){var c,d,e,f,g;return d=this.getViewData(),0===d.length?null:(g=d[a],c=g._group,(e=this._itemBodyList[c.index])?(f=e.children(),g=f[c.itemIndex],g?b(g):null):null)},_updateIndexes:function(a,c,d){var e,f,g,h,i,j;for(f=this.getViewData(),i=a;i<this._itemBodyList.length;i++){for(e=this._itemBodyList[i],g=e.children(),j=c;j<g.length;j++)b(g[j]).attr("data-index",d),h=f[d],h._group={index:i,itemIndex:j},d++;c=0}},_removeGroup:function(a){var b;b=a.prev(),b.length>0&&b.hasClass("item-head")&&b.remove(),a.remove()},_promptIsShow:function(){return this._hasPrompt&&"block"===this._dataPrompt.css("display")},_setPromptLocation:function(){var a=this._dataPrompt.height();this._dataPrompt.css("margin-top",-a/2+"px")},_showDataPrompt:function(){this._hasPrompt&&(this._dataPrompt.css("display","block"),this._setPromptLocation())},_hideDataPrompt:function(){this._hasPrompt&&this._dataPrompt.css("display","none")},fill:function(a,c){var d;d=!1,this._itemBodyList.length>0&&(d=!0,this.viewBody.scrollTop(0),this.clear(!1)),Array.isArray(a)||(a=[]),this.option.viewData=a,0===a.length?this._showDataPrompt():(this._hideDataPrompt(),this._rasterizeItems(!0,function(a,b,c,d,e){var f=this._createItem(b,c);f.css({top:d+"px",left:e+"px"}),this._renderItem(f,b,c),a.append(f)})),b.isNumeric(c)&&this._renderPageList(c),d&&this.fire("rebind")},getSelection:function(){var a,c,d;if(!this.isSelectable())return null;if(this.isMultiple())for(a=[],c=0,d=this._selectList.length;c<d;c++)a.push(this._getSelectionData(b(this._selectList[c])));else a=null,this._current&&(a=this._getSelectionData(this._current));return a},cancelSelection:function(){var a,c,d;if(this.isSelectable()){if(this.isMultiple()){if(0===this._selectList.length)return;for(a=0,c=this._selectList.length;a<c;a++)d=b(this._selectList[a]),fn.call(this,d);this._selectList=[]}else{if(!this._current)return;fn.call(this,this._current),this._current=null}this.fire("cancel")}},removeAt:function(){var b,c,d,e,f,g,h,i;if(c=this.getViewData(),0!==c.length&&0!==(g=arguments.length)){for(e=[],f=0;f<g;f++)d=arguments[f],a.core.isNumber(d)&&d>=0&&d<c.length&&e.push(d);if((g=e.length)>0){for(e.sort(function(a,b){return b-a}),f=0;f<g;f++)if(d=e[f],(b=this._getItemElement(d))&&(i=c[d]._group,this.option.viewData.splice(d,1),this.isGroup()?1===this._groupData[i.index][this.option.group.itemsField].length?(this._groupData.splice(i.index,1),this._itemBodyList.splice(i.index,1),this._removeGroup(b.parent())):(this._groupData[i.index][this.option.group.itemsField].splice(i.index,1),b.remove()):b.remove(),this.isSelectable()))if(this.isMultiple()){for(h=0;h<this._selectList.length;h++)if(this._selectList[h]===b[0]){this._selectList.splice(h,1);break}}else this._current&&this._current[0]===b[0]&&(this._current=null);this._updateIndexes(i.index,i.itemIndex,d),this._rearrangeItems()}}},updateItem:function(b,c){var d;!a.core.isNumber(b)||b<0||b>=this.count()||(d=this._getItemElement(b))&&(d.empty(),this.option.viewData[b]=c,this._renderItem(d,c,b))},addItem:function(a){var b,c,d,e,f,g,h,i,j,k;if(a){if(b=this.option.viewData,!Array.isArray(b)||0===b.length)return this.bodyPanel&&(this.bodyPanel.remove(),this.bodyPanel=null),void this.fill([a]);if(h={},this.isGroup()){for(e=a[this.option.group.groupField]+"",d=-1,j=0,k=this._groupData.length;j<k;j++)if(this._groupData[j][this.option.group.groupField]===e){d=j;break}-1===d?(h.index=this._groupData.length,h.itemIndex=0,g={},g[this.option.group.groupField]=e,g[this.option.group.itemsField]=[a],this._groupData.push(g),i=[],f=this._getItemBody(h.index,!0,i,this._currentMarginInfo.margin),this.viewBody.append(i)):(f=this._itemBodyList[d],h.index=d,h.itemIndex=this._groupData[d][this.option.group.itemsField].length,this._groupData[d][this.option.group.itemsField].push(a))}else h.index=0,h.itemIndex=b.length,f=this._itemBodyList[h.index];a._group=h,c=this._createItem(a,b.length),this._renderItem(c,a,b.length),b.push(a),f.append(c),this._rearrangeItems()}},insertItem:function(a,b){var c,d,e,f;if(b){if(f=this.option.viewData,!Array.isArray(f)||0===f.length)return void this.addItem(b);if(a<0&&(a=0),a>=0&&a<f.length){if(d={},this.isGroup()){if(e=f[a],e[this.option.group.groupField]!==b[this.option.group.groupField])throw new Error("the data not belong to the destination group.");d.index=e._group.index,d.itemIndex=e._group.itemIndex,this._groupData[d.index][this.option.group.itemsField].splice(d.itemIndex,0,b)}else d.index=0,d.itemIndex=a;b._group=d,c=this._createItem(b,a),this._renderItem(c,b,a),this._getItemElement(a).before(c),f.splice(a,0,b),this._updateIndexes(d.index,d.itemIndex,a),this._rearrangeItems()}else this.addItem(b)}},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},getColumnCount:function(){return this._currentMarginInfo?this._currentMarginInfo.count:0},getItemMargin:function(){return this._currentMarginInfo?this._currentMarginInfo.margin:0},count:function(){return Array.isArray(this.option.viewData)?this.option.viewData.length:0},isSelectable:function(){return!!this.option.selection},isMultiple:function(){return!0===this.option.selection.multiple},isGroup:function(){return!!this.option.group},clear:function(){var a;this._itemBodyList.length>0&&(a=this,this._itemBodyList.forEach(function(b){a._removeGroup(b)}),this.isGroup()&&(this._groupData=null),this._itemBodyList=[],this.option.viewData=[],this._selectList=[],this._current=null),this.pager&&this.pager.empty(),!1!==arguments[0]&&this._showDataPrompt()},setSize:function(b,c){var d=!1;1===arguments.length&&(c=b,b=null),a.core.isNumber(c)&&(c-=this.borderHeight,this.pager&&(c-=this.pagerHeight),this.viewBody.css("height",c+"px"),d=!0),a.core.isNumber(b)&&(b-=this.borderWidth,this.element.css("width",b+"px"),d=!0),d&&this._rearrangeItems(),this._promptIsShow()&&this._setPromptLocation()}}),b.fn.cardView=function(b){if(0!==this.length)return a.ctrls.CardView(b,this)}}(ui,ui.$),function(a,b){function c(a){var c,d,e;for(c=b(a.target);"DT"!==c.nodeName()||!c.hasClass("ui-fold-view-title");){if(c.hasClass("ui-fold-view"))return;c=c.parent()}e=c.children(".ui-fold-view-icon"),d=c.next(),"none"===d.css("display")?(e.removeClass("background-highlight").addClass("font-highlight").html("<i class='far fa-angle-up' />"),d.css("display","block")):(e.removeClass("font-highlight").addClass("background-highlight").html("<i class='far fa-angle-down' />"),d.css("display","none"))}function d(a){if(!(this instanceof d))return new d(a);this.initialize(a)}d.prototype={constructor:d,initialize:function(a){this.element=a,this.onFoldTitleClickHandler=c.bind(this)},_render:function(){var a,c,d,e,f,g;for(a=this.element.children("dt"),g=a.length,g>0&&this.element.on("click",this.onFoldTitleClickHandler),f=0;f<g;f++)c=b(a[f]),e=c.text(),c.addClass("ui-fold-view-title"),d=b("<div class='ui-fold-view-icon border-highlight' />"),"none"===c.next().css("display")?d.addClass("background-highlight").html("<i class='far fa-angle-down' />"):d.addClass("font-highlight").html("<i class='far fa-angle-up' />"),c.empty(),c.append(d).append("<span class='font-highlight'>"+e+"</span>")}},b.fn.foldView=function(){var a,c,e;if(0!==this.length)for(a=0;a<this.length;a++)c=b(this[a]),c.isNodeName("dl")&&c.hasClass("ui-fold-view")&&(e=d(c),e._render(),c[0].foldView=e)}}(0,ui.$),function(a,b){function c(a){return{groupText:a}}function d(){return"array"===a.core.type(this.itemIndexes)}function e(a,b,c,d){return d.isFinale=!0,d.attr("colspan",this.option.columns.length),d.addClass("group-cell"),this.group._last_group_index_=a.groupIndex,this.group.groupItemFormatter.apply(this,arguments)}function f(a,c){var d,e,f;e=c,d=this.gridview.getViewData(),f=d[e.parent()[0].rowIndex],e.hasClass("group-fold")?(e.removeClass("group-fold"),this._operateChildren(f.itemIndexes,function(a,c){b(c).css("display","table-row")})):(e.addClass("group-fold"),this._operateChildren(f.itemIndexes,function(a,c){b(c).css("display","none")}))}function g(){if(!(this instanceof g))return new g;this.initialize()}g.prototype={constructor:g,initialize:function(){this.gridview=null},_operateChildren:function(a,b){var c,d,e,f,g,h;for(c=this.gridview.getViewData(),e=this.gridview.bodyTable[0].rows,g=0,h=a.length;g<h;g++)d=a[g],f=c[d],b.call(this,f,e[d])},setGridView:function(b){var c;if(b instanceof a.ctrls.GridView&&(this.gridview=b,this.gridview.group=this,b.clickHandlers)){if(b.clickHandlers.has("group-cell"))return;c=b.clickHandlers.classEventMap.get("ui-table-body-cell"),b.clickHandlers.remove("ui-table-body-cell"),b.clickHandlers.add("group-cell",f.bind(this)),b.clickHandlers.add("ui-table-body-cell",c)}},listGroup:function(a,d,e){var f=[],g={};if(!Array.isArray(a)||0===a.length)return f;e=b.isFunction(e)?e:c;for(var h,i,j,k=0,l=a.length;k<l;k++)h=a[k],i=h[d],g.hasOwnProperty(i)?g[i].itemIndexes.push(k):(j=e.call(h,i),j.itemIndexes=[k],g[i]=j);for(i in g)for(j=g[i],f.push(j),j.groupIndex=f.length-1,k=0,l=j.itemIndexes.length;k<l;k++)f.push(a[j.itemIndexes[k]]),j.itemIndexes[k]=f.length-1;return f},rowNumber:function(a,b,c,f){var g,h;return g=this.getViewData(),h=g[c],d.call(h)?e.call(this,h,b,c,f):"<span>"+(c-this.group._last_group_index_)+"</span>"},formatText:function(b,c,f,g){var h,i;return h=this.getViewData(),i=h[f],d.call(i)?e.call(this,i,c,f,g):a.ColumnStyle.cfn.defaultText.apply(this,arguments)},groupItemFormatter:function(a,b,c,d){return null}},a.ctrls.GridViewGroup=g}(ui,ui.$),function(a,b){function c(a){return this[a]}function d(a){return!!a[g]}function e(a,b){var c,d,e;c=b,d=c.parent().parent()[0].rowIndex,e=this.gridview.getRowData(d),c.hasClass("unfold")?(e._isFolded=!0,c.removeClass("unfold").removeClass("fa-angle-down").addClass("fa-angle-right"),this._hideChildren(e,d)):(e._isFolded=!1,c.addClass("unfold").removeClass("fa-angle-right").addClass("fa-angle-down"),this._showChildren(e,d))}function f(){if(!(this instanceof f))return new f;this.initialize()}var g="_children";f.prototype={constructor:f,initialize:function(){this.lazy=!1,this.loadChildrenHandler=null,this.gridview=null,this.isTreeNode=d},_fixParentIndexes:function(a,b,c){var d=a._parent;if(d){for(var e=d[g],f=e.length,h=0;h<f;h++)e[h]>b&&(e[h]=e[h]+c);b=e[0]-1,b>=0&&this._fixParentIndexes(d,b,c)}},_fixTreeIndexes:function(a,b,c,d){for(var e,f,h,i=a,j=b;i<j;i++)if(e=c[i],this.isTreeNode(e)){if(!(f=e[g]))continue;for(h=0;h<f.length;h++)f[h]=f[h]+d}},_showChildren:function(a,c){a[g]?this._operateChildren(a[g],function(a,c){if(b(c).css("display","table-row"),!0===a._isFolded)return!1}):this.lazy&&b.isFunction(this.loadChildrenHandler)&&this.loadChildrenHandler(a,c)},_hideChildren:function(a){a[g]&&this._operateChildren(a[g],function(a,c){b(c).css("display","none")})},_operateChildren:function(a,b){var c,d,e,f,h,i;if(a)for(c=this.gridview.getViewData(),e=this.gridview.bodyTable[0].rows,h=0,i=a.length;h<i;h++)d=a[h],f=c[d],!1!==b.call(this,f,e[d])&&f[g]&&this._operateChildren(f[g],b)},_changeLevel:function(a,c,d,e){var f=d._level+e;f<0&&(f=0),d._level=f;var g=this.gridview.option.columns[c],h=b(this.gridview.bodyTable.get(0).rows[a].cells[c]);h.empty(),h.append(g.handler.call(this.gridview,this.gridview.prepareValue(d,g),g,a,h))},_sortListTree:function(a,b,c,d){for(var e,f=0,h=a.length;f<h;f++)e=a[f],delete e._fromList,e._level=d,e._parent=c,b.push(e),a[f]=b.length-1,e[g].length>0?this._sortListTree(e[g],b,e,d+1):delete e[g]},setGridView:function(b){if(b instanceof a.ctrls.GridView&&(this.gridview=b,this.gridview.tree=this,b.clickHandlers)){if(b.clickHandlers.has("fold"))return;b.clickHandlers.add("fold",e.bind(this))}},listTree:function(a,d,e){var f=[],h=c,i=c;if(!Array.isArray(a)||0===a.length)return f;b.isFunction(d)&&(h=d),b.isFunction(e)&&(i=e);var j,k,l,m,n,o,p={};for(m=0;m<a.length;m++)l=a[m],o=h.call(l,d)+""||"__",p.hasOwnProperty(o)?(j=p[o],j[g].push(l)):(j={},j[g]=[],j[g].push(l),p[o]=j),n=i.call(l,e)+"",p.hasOwnProperty(n)?(j=p[n],l[g]=j[g],p[n]=l,l._fromList=!0):(l[g]=[],l._fromList=!0,p[n]=l);for(var q in p)if(p.hasOwnProperty(q)&&(j=p[q],!j.hasOwnProperty("_fromList"))){k=j;break}return this._sortListTree(k[g],f,null,0),f},listTreeByLevel:function(a,b,d){var e=[],f=c;if(!Array.isArray(a)||0===a.length)return e;var h,i,j,k,l=[],m=[];for(h=0;h<a.length;h++)i=a[h],i[g]=[],i[b]=null,h>0?i._level-a[h-1]._level>1&&(i._level=a[h-1]._level+1):i._level=0,k=i._level,l[k]=i,0!==k?(j=l[k-1],j[g].push(i),i[b]=f.call(j,d)):m.push(i);return this._sortListTree(m,e,null,0),e},treeNode:function(a,c,d,e){var f,g,h,i;return a?(f=this.getViewData(),g=f[d],b.isNumeric(g._level)||(g._level=0),h=b("<span />").text(a),this.tree.isTreeNode(g)?(g._isFolded=!1,h=[null,h[0]],i=b(this.tree.lazy?"<i class='fold font-highlight-hover far fa-angle-right' />":"<i class='fold unfold font-highlight-hover far fa-angle-down' />"),i.css("margin-left",17*g._level+5+"px"),h[0]=i[0]):h.css("margin-left",17*(g._level+1)+5+"px"),h):null},levelNode:function(c,d,e,f){var g,h,i;return c?(g=this.getViewData(),h=g[e],a.type.isNumber(h._level)||(h._level=0),i=b("<span />").text(c),i.css("margin-left",17*(h._level+1)+5+"px"),i):null},addChildren:function(a,c,d){var e,f,h,i,j,k=c+1;for(a[g]=[],e=this.gridview.getViewData(),i=0,j=d.length;i<j;i++)f=d[i],f._level=a._level+1,f._parent=a,a[g].push(k),h=b("<tr />"),e.splice(k,0,f),this.gridview._createRowCells(h,f,k),k<e.length-1?b(this.gridview.bodyTable[0].rows[k]).before(h):this.gridview.bodyTable.append(h),k++;this.gridview._updateScrollState(),this.gridview._refreshRowNumber(k-1),this._fixParentIndexes(a,c,j),this._fixTreeIndexes(c+1+j,e.length,e,j)},changeLevel:function(b,c,d,e){var f,g,h,i;if(g=this.gridview.getViewData(),!("number"!==a.core.type(b)||b<0||b>=g.length)&&(f=g[b],e=!!e,h=f._level,this._changeLevel(b,c,f,d),e))for(i=b+1;i<g.length;){if(f=g[i],f._level<=h)return;this._changeLevel(i,c,f,d),i++}}},a.ctrls.GridViewTree=f}(ui,ui.$),function(a,b){function c(b){return b?a.str.htmlEncode(b):b}function d(b){b.showPageInfo&&(b.pageInfoFormatter||(b.pageInfoFormatter={currentRowNum:function(a){return"<span>本页"+a+"行</span>"},rowCount:function(a){return"<span class='font-highlight'>共"+a+"行</span>"},pageCount:function(a){return"<span>"+a+"页</span>"}})),this.pager=a.ctrls.Pager(b),this.pageIndex=this.pager.pageIndex,this.pageSize=this.pager.pageSize}function e(b){this.view=b,this.currentSortColumn=null,this.sorter=new a.Introsort,this.sortAfterFn=null,this._resetSortColumnStateHandler=function(){this.resetSortColumnState()}.bind(this)}function f(a){this.handlers=[],this.view=a}function g(a,b){b?a.removeClass("fa-square").addClass("fa-check-square").addClass("font-highlight"):a.removeClass("fa-check-square").removeClass("font-highlight").addClass("fa-square")}function h(a){var c,d,e=!a.hasClass("fa-check-square");if(g(a,e),!this._gridCheckboxAll){if(c=this._getColumnIndexByFormatter(s,"text"),-1===c.columnIndex)return;d=c.headTable[0].tHead.rows,this._gridCheckboxAll=b(d[d.length-1].cells[c.columnIndex]).find("."+o)}e?this._checkedCount++:this._checkedCount--,this._checkedCount===this.count()?g(this._gridCheckboxAll,!0):g(this._gridCheckboxAll,!1)}function i(a,b){var c,d,e;c=this.getViewData(),0!==c.length&&(d=b[0].cellIndex,e=this._getColumn(d),this.sorter.sort(c,b,e))}function j(c,d){var e,f,g,i;if(this.isSelectable()&&(e=b(c.target),!(g=this.option.selection.exclude)||(i=!0,a.core.isString(g)?i=this._excludeElement(e,g):a.core.isFunction(g)&&(i=g.call(this,e)),!1!==i))){if(e.hasClass(n)&&!this.option.selection.isRelateCheckbox)return void h.call(this,e);"row"===this.option.selection.type&&(d=d.parent()),f="cell"===this.option.selection.type?"cell-selected":"row-selected",d.context=c.target,this._selectItem(d,f)}}function k(c){var d,e,f,h,i,j,k,l,m,o,p;if(c.stopPropagation(),0!==this.count()&&(d=b(c.target),-1!==(i=d.parent().prop("cellIndex")))){if(h=!d.hasClass("fa-check-square"),g.call(this,d,h),!0===this.option.selection.isRelateCheckbox&&this.isMultiple())if(k="cell"===this.option.selection.type?"cell-selected":"row-selected",h)l=function(a,b){var c;c="cell"===this.option.selection.type?a:a.parent(),c.context=b[0],this._selectItem(c,k,h)};else{for(m=0,o=this._selectList.length;m<o;m++)b(this._selectList[m]).removeClass(k).removeClass("background-highlight");this._selectList=[]}for(p=d.parent();;){if(p.hasClass("ui-grid-view"))return;if(p.hasClass("ui-grid-head")){p=p.next(),p=p.find("table"),j=0===p.length?[]:p[0].tBodies[0].rows;break}p=p.parent()}for(m=0,o=j.length;m<o;m++)f=b(j[m].cells[i]),e=f.find("."+n),e.length>0&&(a.core.isFunction(l)?l.call(this,f,e):g.call(this,e,h));this._checkedCount=h?this.count():0}}function l(a){var b=this.head[0],c=this.body[0];b.scrollLeft=c.scrollLeft}function m(a,c){this.view=a,this.enabled=!0,c||(this.enabled=!1),this.element=b("<div class='data-prompt' />"),this.setText(c),this.view.body.append(this.element)}
var n="grid-checkbox",o="grid-checkbox-all",p="fa-sort-up",q=/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,r=/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,s=a.ColumnStyle.cnfn.checkAll,t=a.ColumnStyle.cfn.check,u=a.ColumnStyle.cnfn.columnText,v=a.ColumnStyle.cfn.text,w=a.ColumnStyle.cfn.rowNumber;e.prototype={constructor:e,prepareHead:function(){this.sortCells=[],this._isAddedResetSortColumnState=!1,this.view.columnResetter.remove(this._resetSortColumnStateHandler)},setSortColumn:function(b,c,d){(!0===c.sort||a.core.isFunction(c.sort))&&(b.addClass("sort-column"),b.append("<i class='fa fa-sort' />"),this.sortCells.push(b),this._isAddedResetSortColumnState||(this.view.columnResetter.add(this._resetSortColumnStateHandler),this._isAddedResetSortColumnState=!0))},resetSortColumnState:function(){var a,b,c;if(this.sortCells)for(b=0,c=this.sortCells.length;b<c;b++)if(a=this.sortCells[b].find("i"),!a.hasClass("fa-sort"))return void a.attr("class","fa fa-sort")},sort:function(b,c,d){var e,f,g,h,i,j,k,l;if(e=this.view,0!==b.length){if(this.currentSortColumn!==d&&this.resetSortColumnState(),f=this.currentSortColumn===d,this.currentSortColumn=d,i=e.bodyTable.children("tbody"),j=i.children().get(),a.core.isFunction(this.sortAfterFn)&&(k=j.slice(0)),!Array.isArray(j)||j.length!==b.length)throw new Error("data row error");l=c.find("i"),l.hasClass(p)?(this.reverse(b,j),l.removeClass("fa-sort").removeClass(p).addClass("fa-sort-down")):(f?this.reverse(b,j):(h=d.sort,a.core.isFunction(h)||(h=function(a,b){return this.defaultComparer(a,b)}.bind(this)),g=function(a,b){return a=e._prepareValue(a,d),b=e._prepareValue(b,d),h(a,b)},this.sorter.items=j,this.sorter.sort(b,g)),l.removeClass("fa-sort").removeClass("fa-sort-down").addClass(p)),i.append(j),k&&this.sortAfterFn(k),e._refreshRowNumber()}},defaultComparer:function(a,b){var c,d,e;if(Array.isArray(a)){for(c=0,d=0,e=a.length;d<e;d++)if(0!==(c=this.sorting(a[d],b[d])))return c;return c}return this.sorting(a,b)},sorting:function(a,b){return"string"==typeof a?a.localeCompare(b):a<b?-1:a>b?1:0},reverse:function(a,b){var c,d,e,f;for(d=0,e=a.length-1,f=a.length/2;d<f;d++,e--)c=a[d],a[d]=a[e],a[e]=c,c=b[d],b[d]=b[e],b[e]=c},reset:function(){this.currentSortColumn=null,this.sorter.keys=null,this.sorter.items=null}},f.prototype={constructor:f,add:function(b){a.core.isFunction(b)&&this.handlers.push(b)},remove:function(a){var b;for(b=this.handlers.length-1;b>=0;b--)if(this.handlers[b]===a){this.handlers.splice(b,1);break}},reset:function(){var a=this.view;this.handlers.forEach(function(b){try{b.call(a)}catch(a){}})}},m.prototype={constructor:m,isShow:function(){return this.enabled&&"block"===this.element.css("display")},show:function(){this.enabled&&this.element.css("display","block")},hide:function(){this.enabled&&this.element.css("display","none")},setText:function(b){this.enabled&&(a.core.isString(b)&&b.length>0?this.element.html("<span class='font-highlight'>"+c(b)+"</span>"):a.core.isFunction(b)&&(b=b(),this.element.append(b)))}},a.ctrls.define("ui.ctrls.GridView",{_defineOption:function(){return{columns:[],viewData:null,prompt:"没有数据",height:!1,width:!1,textFormatter:null,mouseHoverReaction:!0,pager:{pageIndex:1,pageSize:100,pageButtonCount:10,showPageInfo:!1,pageInfoFormatter:null},selection:{type:"row",exclude:!1,multiple:!1,isRelateCheckbox:!0}}},_defineEvents:function(){var a=["selecting","selected","deselected","rebind","cancel"];return this.option.pager&&a.push("pagechanging"),a},_create:function(){this._selectList=[],this.columnResetter=new f(this),this.sorter=new e(this),this.head=null,this.body=null,this.foot=null,this.rowHeight=30,this.headHeight=this.rowHeight,this.bodyHeight=0,this.footHeight=30,this._checkedCount=0,this.option.pager?d.call(this,this.option.pager):(this.pageIndex=1,this.pageSize=100),this.option.selection?(a.core.isString(this.option.selection.type)?this.option.selection.type=this.option.selection.type.toLowerCase():this.option.selection.type="disabled",this.option.selection.multiple||(this.option.selection.isRelateCheckbox=!1)):this.option.selection={type:"disabled"},(!a.core.isNumber(this.option.width)||this.option.width<=0)&&(this.option.width=!1),(!a.core.isNumber(this.option.height)||this.option.height<=0)&&(this.option.height=!1),this.clickHandlers=this.createClassEventDelegate("click"),this.clickHandlers.add("sort-column",i.bind(this)),this.clickHandlers.add(o,k.bind(this)),this.clickHandlers.add("ui-table-body-cell",j.bind(this)),this.onScrollingHandler=l.bind(this)},_render:function(){if(!this.element)throw new Error("the element is null.");this.element.hasClass("ui-grid-view")||this.element.addClass("ui-grid-view"),this.element.on("click",this.clickHandlers.getDelegateHandler(function(a){return a.hasClass("ui-grid-view")}).bind(this)),this._initBorderWidth(),this.head=b("<div class='ui-grid-head' />"),this.element.append(this.head),this.body=b("<div class='ui-grid-body' />"),this.body.on("scroll",this.onScrollingHandler),this.element.append(this.body),this.prompt=new m(this,this.option.prompt),this._initPagerPanel(),this.createHead(this.option.columns),Array.isArray(this.option.viewData)?this.createBody(this.option.viewData,this.option.viewData.length):this.option.viewData=[],this.setSize(this.option.width,this.option.height)},_initBorderWidth:function(){var a=function(a){return parseInt(this.element.css(a),10)||0};this.borderWidth=0,this.borderHeight=0,this.borderWidth+=a.call(this,"border-left-width"),this.borderWidth+=a.call(this,"border-right-width"),this.borderHeight+=a.call(this,"border-top-width"),this.borderHeight+=a.call(this,"border-bottom-width")},_initPagerPanel:function(){this.pager&&(this.foot=b("<div class='ui-grid-foot clear' />"),this.element.append(this.foot),this.pager.pageNumPanel=b("<div class='page-panel' />"),this.option.pager.showPageInfo?(this.pager.pageInfoPanel=b("<div class='data-info' />"),this.foot.append(this.pager.pageInfoPanel)):this.pager.pageNumPanel.css("width","100%"),this.foot.append(this.pager.pageNumPanel),this.pager.pageChanged(function(a,b){this.pageIndex=a,this.pageSize=b,this.fire("pagechanging",a,b)},this))},_createRowCells:function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o;for(o="cell"!==this.option.selection.type,!this._noBodyHover&&o&&b.addClass("table-body-row-hover"),a.core.isFunction(e)&&(e=null,f=e),Array.isArray(e)||(e=this.option.columns),n=a.core.isFunction(f),g=0,h=e.length;g<h;g++)if(i=e[g],m=i.formatter,a.core.isFunction(i.formatter)||(m=this.option.textFormatter),a.core.isFunction(m)||(m=v),j=this._prepareValue(c,i),k=this._createCell("td",i),k.addClass("ui-table-body-cell"),this._noBodyHover||o||k.addClass("table-body-cell-hover"),l=m.call(this,j,i,d,k),!k.isAnnulment&&(n&&(l=f.call(this,l,i,c)),l&&k.append(l),g===h-1&&k.addClass("last-cell"),b.append(k),k.isFinale)){k.addClass("last-cell");break}},_createCol:function(c){var d=b("<col />");return a.core.isNumber(c.len)&&d.css("width",c.len+"px"),d},_createCell:function(a,c){var d=b("<"+a+" />"),e={};return c.align&&(e["text-align"]=c.align),d.css(e),d},_prepareValue:function(a,b){var c,d,e;if(Array.isArray(b.column))for(c={},d=0,e=b.column.length;d<e;d++)c[d]=c[b.column[d]]=this._getValue(a,b.column[d],b);else c=this._getValue(a,b.column,b);return c},_getValue:function(b,c,d){var e,f,g=0;if(!a.core.isString(c))return null;for(d._columnKeys.hasOwnProperty(c)||(d._columnKeys[c]=c.split(".")),e=d._columnKeys[c],f=b[e[g]],g=1;g<e.length;g++)if(void 0===(f=f[e[g]])||null===f)return f;return f},_getColumn:function(a){return this.option.columns[a]},_renderPageList:function(a){this.pager&&(this.pager.data=this.getViewData(),this.pager.pageIndex=this.pageIndex,this.pager.pageSize=this.pageSize,this.pager.renderPageList(a))},_updateScrollState:function(){var b=this.body[0].scrollHeight,c=this.body.height();this.headTable&&(b-c>1?this._headScrollCol.css("width",a.scrollbarWidth+.1+"px"):this._headScrollCol.css("width","0"))},_refreshRowNumber:function(c,d){var e,f,g,h,i,j,k,l;if(e=this.getViewData(),0!==e.length&&(g=w,f=this._getColumnIndexByFormatter(g),-1!=f.columnIndex))for(a.core.isNumber(c)||(c=0),h=f.bodyTable[0].rows,j=f.columns[f.columnIndex],l=a.core.isNumber(d)?d+1:h.length,k=c;k<l;k++)i=b(h[k].cells[f.columnIndex]),i.html(""),i.append(g.call(this,null,j,k))},_getColumnIndexByFormatter:function(a,b){var c,d,e;for(c={columnIndex:-1,columns:this.option.columns,headTable:this.headTable,bodyTable:this.bodyTable},b||(b="formatter"),d=0,e=c.columns.length;d<e;d++)if(c.columns[d][b]===a)return c.columnIndex=d,c;return c},_getSelectionData:function(a){var b={},c=this.getViewData();return"cell"===this.option.selection.type?(b.rowIndex=a.parent().prop("rowIndex"),b.cellIndex=a.prop("cellIndex"),b.rowData=c[b.rowIndex],b.column=this._getColumn(b.cellIndex).column):(b.rowIndex=a.prop("rowIndex"),b.rowData=c[b.rowIndex]),b},_excludeElement:function(b,c){var d,e,f,g,h=b.nodeName().toLowerCase(),i=c.split(",");for(f=0,g=i.length;f<g;f++)if(d=a.str.trim(i[f]),e=d.match(r)){if((d=d.match(q)[1])===h)return b.attr(e[1])!==e[4]}else if(d.toLowerCase()===h)return!1},_addSelectedState:function(a,b,c){a.addClass(b).addClass("background-highlight"),c&&this.fire("selected",c)},_removeSelectedState:function(a,b,c){a.removeClass(b).removeClass("background-highlight"),c&&this.fire("deselected",c)},_selectItem:function(a,c,d){var e,f,h,i,j,k;if(e=this._getSelectionData(a),e.element=a,e.originElement=a.context?b(a.context):null,!1!==this.fire("selecting",e))if(this.isMultiple()){if(a.hasClass(c)){if(!0===d)return;for(d=!1,i=0,j=this._selectList.length;i<j;i++)if(this._selectList[i]===a[0]){this._selectList.splice(i,1);break}this._removeSelectedState(a,c,e)}else{if(!1===d)return;d=!0,this._selectList.push(a[0]),this._addSelectedState(a,c,e)}this.option.selection.isRelateCheckbox&&(e.originElement&&e.originElement.hasClass(n)&&(h=e.originElement),h||(f=this._getColumnIndexByFormatter(t),f.columnIndex>-1&&(h=b("cell"===this.option.selection.type?a.parent()[0].cells[f.columnIndex]:a[0].cells[f.columnIndex]),h=h.find("."+n))),h&&h.length>0&&g.call(this,h,d))}else{if(this._current&&(k=this._current[0]===a[0],this._removeSelectedState(this._current,c,k?e:null),k))return void(this._current=null);this._current=a,this._addSelectedState(a,c,e)}},createHead:function(c){var d,e,f,g,h,i;for(Array.isArray(c)&&(this.option.columns=c),this.sorter.prepareHead(),this.headTable?this.headTable.html(""):(this.headTable=b("<table class='ui-table-head' cellspacing='0' cellpadding='0' />"),this.head.append(this.headTable)),d=b("<colgroup />"),e=b("<thead />"),f=b("<tr />"),i=0;i<c.length;i++)h=c[i],h._columnKeys||(h._columnKeys={}),d.append(this._createCol(h)),g=this._createCell("th",h),g.addClass("ui-table-head-cell"),a.core.isFunction(h.text)?g.append(h.text.call(this,h,g)):h.text&&g.append(u.call(this,h,g)),this.sorter.setSortColumn(g,h,i),i==c.length-1&&g.addClass("last-cell"),f.append(g);this._headScrollCol=this._createCol({len:0}),d.append(this._headScrollCol),f.append(b("<th class='ui-table-head-cell scroll-cell' />")),e.append(f),this.headTable.append(d),this.headTable.append(e)},createBody:function(c,d){var e,f,g,h,i,j,k,l,m=!1;if(this.bodyTable?(this.body.scrollTop(0),this.clear(!1),m=!0):(this.bodyTable=b("<table class='ui-table-body' cellspacing='0' cellpadding='0' />"),this.body.append(this.bodyTable)),k=this.option.columns,Array.isArray(c)||(c=[]),this.option.viewData=c,0===c.length)this.prompt.show();else{for(this.prompt.hide(),e=b("<colgroup />"),f=b("<tbody />"),this.bodyTable.append(e),i=0,j=k.length;i<j;i++)l=k[i],e.append(this._createCol(l));for(h=0,j=c.length;h<j;h++)g=b("<tr />"),this._createRowCells(g,c[h],h,k),f.append(g);this.bodyTable.append(f),this._updateScrollState()}a.core.isNumber(d)&&this._renderPageList(d),m&&this.fire("rebind")},getCheckedValues:function(){var a,d,e,f,g,h="."+n,i=[];if(a=this._getColumnIndexByFormatter(t),-1===a.columnIndex)return i;for(d=a.bodyTable[0].tBodies[0].rows,f=0,g=d.length;f<g;f++)e=b(d[f].cells[a.columnIndex]).find(h),e.length>0&&i.push(c(e.attr("data-value")));return i},getSelection:function(){var a,c,d;if(!this.isSelectable())return null;if(this.isMultiple())for(a=[],c=0,d=this._selectList.length;c<d;c++)a.push(this._getSelectionData(b(this._selectList[c])));else a=null,this._current&&(a=this._getSelectionData(this._current));return a},cancelSelection:function(){var a,c,d,e,f,h,i;if(this.isSelectable()){if(a="cell"===this.option.selection.type?"cell-selected":"row-selected",this.option.selection.isRelateCheckbox?(e="."+n,d=this._getColumnIndexByFormatter(t),f=function(c){var f,h;-1!==d.columnIndex&&(h=b("cell"===this.option.selection.type?c.parent()[0].cells[d.columnIndex]:c[0].cells[d.columnIndex]),f=h.find(e),g(f,!1)),this._removeSelectedState(c,a)}):f=function(b){this._removeSelectedState(b,a)},this.isMultiple()){if(0===this._selectList.length)return;for(h=0,i=this._selectList.length;h<i;h++)c=b(this._selectList[h]),f.call(this,c);this._selectList=[]}else{if(!this._current)return;f.call(this,this._current),this._current=null}this.fire("cancel")}},removeRowAt:function(){var c,d,e,f,g,h,i,j,k;if(e=this.getViewData(),0!==e.length&&0!==(h=arguments.length)){for(d=[],g=0;g<h;g++)c=arguments[g],a.core.isNumber(c)&&c>=0&&c<e.length&&d.push(c);if((h=d.length)>0){for(d.sort(function(a,b){return b-a}),j=this.option.selection.type,i=this.isMultiple(),"row"===j?k=function(a){var b,c,d;if(i){for(b=0,c=this._selectList.length;b<c;b++)if(d=this._selectList[b],a===d.rowIndex)return void this._selectList.splice(b,1)}else this._current&&this._current[0].rowIndex===a&&(this._current=null)}:"cell"===j&&(k=function(a){var b,c,d;if(i){for(b=0,c=this._selectList.length;b<c;b++)if(d=this._selectList[b],d=d.parentNode,a===d.rowIndex)return void this._selectList.splice(b,1)}else this._current&&(d=this._current.parent(),d[0].rowIndex===a&&(this._current=null))}),g=0;g<h;g++)c=d[g],f=b(this.bodyTable[0].rows[c]),f.remove(),e.splice(c,1),k&&k.call(this,c);this._updateScrollState(),this._refreshRowNumber(c)}}},updateRow:function(a,c){var d,e,f=arguments[2],g=arguments[3];d=this.getViewData(),0!==d.length&&(a<0||a>d.length||(e=b(this.bodyTable[0].rows[a]),0!==e.length&&(e.empty(),d[a]=c,this._createRowCells(e,c,a,f,g))))},addRow:function(a){var c,d,e,f=arguments[1],g=arguments[2];if(a){if(c=this.getViewData(),0===(e=c.length))return this.bodyTable&&(this.bodyTable.remove(),this.bodyTable=null),void this.createBody([a]);d=b("<tr />"),this._createRowCells(d,a,e,f,g),b(this.bodyTable[0].tBodies[0]).append(d),c.push(a),this._updateScrollState()}},insertRow:function(a,c){var d,e,f=arguments[2],g=arguments[3];if(c){if(d=this.getViewData(),0===d.length)return void this.addRow(c);a<0&&(a=0),a<d.length?(e=b("<tr />"),this._createRowCells(e,c,a,f,g),b(this.bodyTable[0].rows[a]).before(e),d.splice(a,0,c),this._updateScrollState(),this._refreshRowNumber()):this.addRow(c)}},currentRowUp:function(){var a;if(this.isMultiple())throw new Error("The currentRowUp can not support for multiple selection");if("cell"===this.option.selection.type)throw new Error("The currentRowUp can not support for cell selection");(a=this.getSelection())&&0!==a.rowIndex&&this.moveRow(a.rowIndex,a.rowIndex-1)},currentRowDown:function(){var a;if(this.isMultiple())throw new Error("The currentRowDown can not support for multiple selection");if("cell"===this.option.selection.type)throw new Error("The currentRowDown can not support for cell selection");!(a=this.getSelection())||a.rowIndex>=this.count()||this.moveRow(a.rowIndex,a.rowIndex+1)},moveRow:function(a,c){var d,e,f,g;d=this.getViewData(),0!==d.length&&(c<0?c=0:c>=d.length&&(c=d.length-1),a!==c&&(e=this.bodyTable[0].tBodies[0].rows,f=b(e[c]),c>a?(f.after(b(e[a])),this._refreshRowNumber(a,c)):(f.before(b(e[a])),this._refreshRowNumber(c,a)),g=d[a],d.splice(a,1),d.splice(c,0,g)))},getRowData:function(b){var c=this.getViewData();return 0===c.length?null:!a.core.isNumber(b)||b<0||b>=c.length?null:c[b]},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return this.getViewData().length},isSelectable:function(){var a=this.option.selection.type;return"row"===a||"cell"===a},isMultiple:function(){return!0===this.option.selection.multiple},clear:function(){this.option.viewData=null,this._selectList=[],this._current=null,this._checkedCount=0,this.bodyTable&&this.bodyTable.html(""),this.headTable&&this.columnResetter.reset(),this.pager&&this.pager.empty(),this.sorter.reset(),!1!==arguments[0]&&this.prompt.show()},setSize:function(b,c){1===arguments.length&&(c=b,b=null),a.core.isNumber(c)?(this.height=c,this.innerHeight=c-this.borderHeight,c=this.innerHeight-this.headHeight,this.pager&&(c-=this.footHeight),this.bodyHeight=c,this.body.css("height",this.bodyHeight+"px")):(this.innerHeight=this.element.height(),this.height=this.innerHeight+this.borderHeight),a.core.isNumber(b)?(this.width=b,this.innerWidth=b-this.borderWidth,this.bodyWidth=this.innerWidth,this.element.css("width",this.innerWidth+"px")):(this.innerWidth=this.element.width(),this.width=this.innerWidth+this.borderWidth),this._updateScrollState()}}),b.fn.gridView=function(b){if(0!==this.length)return a.ctrls.GridView(b,this)}}(ui,ui.$),function(a,b){function c(b){return b?a.str.htmlEncode(b):b}function d(a,b){return"<span class='ui-list-view-item-text'>"+c(a)+"</span>"}function e(a,b){var c=d(a),e=d(b);return c.localeCompare(e)}function f(a){var c,d,e;for(c=b(a.target),d=c.hasClass("ui-item-view-remove");!c.isNodeName("li");){if(c.hasClass("ui-list-view-ul"))return;c=c.parent()}c[0]!==a.target&&(c.context=a.target),e=this._getItemIndex(c[0]),this.option.hasRemoveButton&&d?this._removeItem(c,e):this._selectItem(c,e)}var g="ui-list-view-selection";a.ctrls.define("ui.ctrls.ListView",{_defineOption:function(){return{multiple:!1,viewData:null,itemFormatter:!1,hasRemoveButton:!1,animatable:!0,pager:!1}},_defineEvents:function(){var a=["selecting","selected","deselected","cancel","removing","removed"];return this.option.pager&&a.push("pageChanging"),a},_create:function(){this._selectList=[],this.sorter=new a.Introsort,a.core.isFunction(this.option.itemFormatter)||(this.option.itemFormatter=d),this.option.hasRemoveButton=!!this.option.hasRemoveButton,this.onListItemClickHandler=f.bind(this)},_render:function(){this.element.addClass("ui-list-view"),this.listPanel=b("<ul class='ui-list-view-ul' />"),this.listPanel.on("click",this.onListItemClickHandler),this.element.append(this.listPanel),this.option.pager&&this._initPager(this.option.pager),this._initAnimator(),this.setViewData(this.option.viewData)},_initPager:function(c){this.pagerPanel=b("<div class='ui-list-view-pager clear' />"),this.element.append(this.pagerPanel),this.listPanel.addClass("ui-list-view-pagelist"),this.pager=a.ctrls.Pager(c),this.pageIndex=this.pager.Index,this.pageSize=this.pager.pageSize,this.pager.pageNumPanel=this.pagerPanel,this.pager.pageChanged(function(a,b){this.pageIndex=a,this.pageSize=b,this.fire("pagechanging",a,b)},this)},_initAnimator:function(){this.removeFirstAnimator=a.animator({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("margin-left",a+"px")}}),this.removeFirstAnimator.duration=300,this.removeSecondAnimator=a.animator({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("height",a+"px")}}),this.removeSecondAnimator.duration=300},_fill:function(a){var b,c,d,e=[];for(this.listPanel.empty(),this.option.viewData=[],b=0,c=a.length;b<c;b++)null!==(d=a[b])&&void 0!==d&&(this._createItemHtml(e,d,b),this.option.viewData.push(d));this.listPanel.html(e.join(""))},_createItemHtml:function(b,c,d){var e,f,g;if(b.push("<li ","data-index","='",d,"' class='ui-list-view-item'>"),e=this.option.itemFormatter.call(this,c,d),a.core.isString(e))b.push("<div class='ui-list-view-container'>"),b.push(e),b.push("</div>");else if(a.core.isPlainObject(e)){if(g=b[b.length-1],f=g.lastIndexOf("'"),b[b.length-1]=g.substring(0,f),a.core.isString(e.class)?b.push(" ",e.class):Array.isArray(e.class)&&b.push(" ",e.class.join(" ")),b.push("'"),e.style&&!a.core.isEmptyObject(e.style)){b.push(" style='");for(g in e.style)e.style.hasOwnProperty(g)&&b.push(g,":",e.style[g],";");b.push("'")}b.push(">"),b.push("<div class='ui-list-view-container'>"),e.html&&b.push(e.html),b.push("</div>")}this._appendOperateElements(b),b.push("</li>")},_createItem:function(c,d){var e=[],f=b("<li class='ui-list-view-item' />"),g=b("<div class='ui-list-view-container' />"),h=this.option.itemFormatter.call(this,c,d);return f.attr("data-index",d),a.core.isString(h)?g.append(h):a.core.isPlainObject(h)&&(a.core.isString(h.class)?f.addClass(h.class):Array.isArray(h.class)&&f.addClass(h.class.join(" ")),h.style&&!a.core.isEmptyObject(h.style)&&f.css(h.style),h.html&&g.html(h.html)),f.append(g),this._appendOperateElements(e),f.append(e.join("")),f},_appendOperateElements:function(a){a.push("<b class='ui-list-view-b background-highlight'></b>"),this.option.hasRemoveButton&&a.push("<a href='javascript:void(0)' class='closable-button ui-item-view-remove'>×</a>")},_indexOf:function(a){var b,c,d=this.getViewData();for(b=0,c=d.length;b<c;b++)if(a===d[b])return b;return-1},_getItemIndex:function(a){return parseInt(a.getAttribute("data-index"),10)},_itemIndexAdd:function(a,b){this._itemIndexSet(a,this._getItemIndex(a)+b)},_itemIndexSet:function(a,b){a.setAttribute("data-index",b)},_getSelectionData:function(a){var b=this._getItemIndex(a),c={},d=this.getViewData();return c.itemData=d[b],c.itemIndex=b,c},_removeItem:function(a,c){var d,e,f,g,h=this;if(g=this.getViewData(),e=this._getSelectionData(a[0]),e.element=a,e.originElement=a.context?b(a.context):null,!1!==this.fire("removing",e)){if(1===arguments.length&&(c=this._getItemIndex(a[0])),d=function(){for(var b,d=a.next();d.length>0;)this._itemIndexAdd(d[0],-1),d=d.next();if(this.isMultiple()){for(b=0;b<this._selectList.length;b++)if(a[0]===this._selectList[b]){this._selectList.splice(b,1);break}}else this._current&&this._current[0]===a[0]&&(this._current=null);this.fire("removed",e),a.remove(),g.splice(c,1)},!1===this.option.animatable)return void d.call(this);f=this.removeFirstAnimator[0],f.target=a,f.begin=0,f.end=-f.target.width(),f=this.removeSecondAnimator[0],f.target=a,f.begin=f.target.height(),f.end=0,f.target.css({height:f.begin+"px",overflow:"hidden"}),this.removeFirstAnimator.start().then(function(){return h.removeSecondAnimator.start()}).then(function(){d.call(h)})}},_selectItem:function(a,c,d,e){var f,h;if(f=this._getSelectionData(a[0]),f.element=a,f.originElement=a.context?b(a.context):null,!1!==this.fire("selecting",f)){if(d=2===arguments.length?!a.hasClass(g):!!d,this.isMultiple())if(d)this._selectList.push(a[0]),a.addClass(g);else{for(h=0;h<this._selectList.length;h++)if(this._selectList[h]===a[0]){this._selectList.splice(h,1);break}a.removeClass(g)}else d?(this._current&&this._current.removeClass(g),this._current=a,this._current.addClass(g)):(a.removeClass(g),this._current=null);!1!==e&&(d?this.fire("selected",f):this.fire("deselected",f))}},add:function(a){var b;a&&(b=this._createItem(a,this.option.viewData.length),this.listPanel.append(b),this.option.viewData.push(a))},remove:function(b){var c=a.core.type(b);"undefined"===c&&"null"===c||this.removeAt(this._indexOf(b))},removeAt:function(a){var c;a<0||a>=this.count()||(c=b(this.listPanel.children()[a]),this._removeItem(c))},insert:function(a,c){var d,e,f,g;if(c<0&&(c=0),c>=this.option.viewData.length)return void this.add(a);for(f=this._createItem(a,c),e=this.listPanel.children(),d=b(e[c]),g=c;g<e.length;g++)this._itemIndexAdd(e[g],1);f.insertBefore(d),this.option.viewData.splice(c,0,a)},currentUp:function(){var a;if(this.isMultiple())throw new Error("The currentUp can not support for multiple selection");this._current&&(a=this._getItemIndex(this._current[0]))>0&&this.moveTo(a,a-1)},currentDown:function(){var a;if(this.isMultiple())throw new Error("The currentDown can not support for multiple selection");this._current&&(a=this._getItemIndex(this._current[0]))<this.count()-1&&this.moveTo(a,a+1)},moveTo:function(a,c){var d,e,f,g,h,i,j;if(g=this.getViewData(),0!==(h=this.count())&&!(a<0||a>=h||c<0||c>=h||a===c)){if(d=this.listPanel.children(),e=b(d[a]),f=b(d[c]),a<c){for(j=c;j>a;j--)this._itemIndexAdd(d[j],-1);this._itemIndexSet(e[0],c),f.after(e)}else{for(j=c;j<a;j++)this._itemIndexAdd(d[j],1);this._itemIndexSet(e[0],c),f.before(e)}i=g[a],g.splice(a,1),g.splice(c,0,i)}},getSelection:function(){var a,b=null;if(this.isMultiple())for(b=[],a=0;a<this._selectList.length;a++)b.push(this._getSelectionData(this._selectList[a]));else this._current&&(b=this._getSelectionData(this._current[0]));return b},setSelection:function(a){var c,d,e,f,g;for(this.cancelSelection(),this.isMultiple()?Array.isArray(a)||(a=[a]):a=Array.isArray(a)?[a[0]]:[a],f=this.listPanel.children(),c=0,d=a.length;c<d;c++)e=a[c],(g=f[e])&&this._selectItem(b(g),e,!0,c>=d-1)},cancelSelection:function(){var a,c,d;if(this.isMultiple()){for(c=0,d=this._selectList.length;c<d;c++)a=b(this._selectList[c]),a.removeClass(g);this._selectList=[]}else this._current&&(this._current.removeClass(g),this._current=null);this.fire("cancel")},sort:function(b){var c,d,f,g;if(0!==this.count()){for(a.core.isFunction(b)||(b=e),c=this.listPanel.children(),this.sorter.items=c,this.sorter.sort(this.option.viewData,b),d=document.createDocumentFragment(),f=0,g=c.length;f<g;f++)this._itemIndexSet(c[f],f),d.appendChild(c[f]);this.listPanel.empty(),this.listPanel[0].appendChild(d)}},setViewData:function(a){Array.isArray(a)&&this._fill(a)},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return this.option.viewData.length},isMultiple:function(){return!0===this.option.multiple},clear:function(){this.option.viewData=[],this.listPanel.empty(),this._current=null,this._selectList=[]}}),b.fn.listView=function(b){return 0===this.length?null:a.ctrls.ListView(b,this)}}(ui,ui.$),function(a,b){function c(a,c,d){this.view=a,this.parent=c,this.panel=b("<div class='ui-report-fixed' />"),d&&this.panel.css(d),this.head=b("<div class='ui-grid-head ui-report-fixed-head' />"),this.head.css("height",this.view.headHeight+"px"),this.body=b("<div class='ui-grid-body ui-report-fixed-body' />"),this.body.css("height",this.view.bodyHeight+"px"),this.width=0,this.height=0,this.offsetCellIndex=0,this.panel.append(this.head).append(this.body),this.parent.append(this.panel)}function d(a){this.view=a,this.left=null,this.right=null}function e(a,b){var c,d,e;c=this.getViewData(),0!==c.length&&(d=parseInt(b.attr("data-columnIndex"),10)||b[0].cellIndex,e=this._getColumn(d),this.sorter.sort(c,b,e))}function f(a){var b=this.reportDataBody[0],c=this.reportDataHead[0],d=b.scrollTop,e=b.scrollLeft;c.scrollLeft=e,this.fixed.syncScroll(d,e,b.scrollWidth)}var g="border-highlight",h=a.ColumnStyle.cnfn.columnText,i=(a.ColumnStyle.cfn.text,a.ColumnStyle);c.prototype={constructor:c,setHead:function(a){var c=0;this.columns=[],this.headTable=b("<table class='ui-table-head' cellspacing='0' cellpadding='0' style='left:0' />"),this.view._createHeadTable(this.headTable,this.columns,a,!0,function(a,b,d,e){a.len||(a.len=40),c+=a.len}),this.width=c,this.head.html("").append(this.headTable),this.head.css("width",this.width+"px")},setBody:function(a){this.bodyTable=b("<table class='ui-table-body' cellspacing='0' cellpadding='0' style='left:0' />"),this.view._createBodyTable(this.bodyTable,a,this.columns),this.body.scrollTop(0),this.body.html("").append(this.bodyTable),this.body.css("width",this.width+"px"),this.panel.removeClass("ui-report-fixed-empty")},clear:function(){this.bodyTable&&(this.bodyTable.remove(),delete this.bodyTable),this.panel.removeClass(g).addClass("ui-report-fixed-empty")},destroy:function(){this.panel.remove()},findColumnInfo:function(a,b){var c,d;for(c=0,d=this.columns.length;c<d;c++)if(this.columns[c][b]===a)return{columnIndex:c,columns:this.columns,headTable:this.headTable,bodyTable:this.bodyTable}},getElement:function(c,d){var e=b(this.bodyTable[0].tBodies[0].rows[c]);return a.core.isNumber(d)&&(d-=this.offsetCellIndex,e=d<0||d>=e[0].cells.length?null:b(e[0].cells[d])),e},updateRow:function(a,c){var d=b(this.bodyTable[0].rows[a]);0!==d.length&&(d.empty(),this.view._createRowCells(d,c,a,this.columns))},appendRow:function(a){var c=b("<tr />"),d=this.view.count();this.view._createRowCells(c,a,d,this.columns),b(this.bodyTable[0].tBodies[0]).append(c)},insertRow:function(a,c){var d=b("<tr />");this.view._createRowCells(d,c,a,this.columns),b(this.bodyTable[0].rows[a]).before(d)},moveRow:function(a,c){var d=this.bodyTable[0].tBodies[0].rows,e=b(d[a]),f=b(d[c]);c>a?f.after(e):f.before(e)}},d.prototype={constructor:d,clear:function(){this.left&&this.left.clear(),this.right&&this.right.clear()},setBodyHeight:function(a){this.left&&this.left.body.css("height",a+"px"),this.right&&this.right.body.css("height",a+"px")},reset:function(){this.left&&(this.left.destroy(),this.left=null),this.right&&(this.right.destroy(),this.right=null)},findColumnInfo:function(a,b){var c;return this.left&&null!=(c=this.left.findColumnInfo(a,b))?c:(this.right&&(c=this.right.findColumnInfo(a,b)),c)},syncScroll:function(a,b,c){this.left&&(this.left.body.scrollTop(a),b>0?this.left.panel.addClass(g):this.left.panel.removeClass(g)),this.right&&(this.right.body.scrollTop(a),Math.ceil(this.view.innerWidth+b)<c?this.right.panel.addClass(g):this.right.panel.removeClass(g))},syncSelectedState:function(a,b,c){var d,e,f,g;this.left&&this.right&&("row"===this.view.option.selection.type?d=a[0].rowIndex:(e=a[0].cellIndex,d=a.parent()[0].rowIndex),f=function(a,b){var c;a&&(c=a.getElement(d,e))&&b(c)},c?(g=function(a){a.addClass(b).addClass("background-highlight")},f(this.left,g),f(this.right,g)):(g=function(a){a.removeClass(b).removeClass("background-highlight")},f(this.left,g),f(this.right,g)))},sortSync:function(a){var b,c,d,e,f,g,h,i;if(this.left||this.right)for(this.left&&(f=this.left.bodyTable.children("tbody"),b=f[0].rows,d=new Array(b.length)),this.right&&(g=this.right.bodyTable.children("tbody"),c=g[0].rows,e=new Array(c.length)),h=0,i=a.length;h<i;h++)d&&(d[a[h].rowIndex]=b[h]),e&&(e[a[h].rowIndex]=c[h])}},a.ctrls.define("ui.ctrls.ReportView",a.ctrls.GridView,{_defineOption:function(){var a=this._super();return a.adjustable=!0,a},_create:function(){var c=this;this._super(),this._headScrollColumn={addScrollCol:function(a,c,d){var e,f,g;this.scrollCol=d._createCol({len:0}),c.append(this.scrollCol),e=a.parent().children(),f=e.length,g=b("<th class='ui-table-head-cell scroll-cell' />"),f>1&&g.attr("rowspan",f),b(e[0]).append(g)},addFixedScrollColumn:function(d){this.scrollBlock=b("<div class='ui-report-fixed-block' />"),this.scrollBlock.css({width:a.scrollbarWidth+"px",height:c.headHeight-2+"px"}),d.append(this.scrollBlock)},show:function(){this.scrollCol&&this.scrollCol.css("width",a.scrollbarWidth+.1+"px"),this.scrollBlock&&(this.scrollBlock.css("display","block"),c.fixed.right.panel.css("right",a.scrollbarWidth+1+"px"))},hide:function(){this.scrollCol&&this.scrollCol.css("width",0),this.scrollBlock&&(this.scrollBlock.css("display","none"),c.fixed.right.panel.css("right",0))}},this.fixed=new d(this),this.sorter.sortAfterFn=function(a){this.fixed.sortSync(a)}.bind(this),this.clickHandlers.add("sort-column",e.bind(this)),this.onScrollingHandler=f.bind(this)},_render:function(){this._super(),this.element.addClass("ui-report-view"),this.head.addClass("ui-report-head"),this.body.addClass("ui-report-body"),this._initAdjustColumn()},_initAdjustColumn:function(){this.option.adjustable&&(this._adjustLine=b("<hr class='adjust-line background-highlight' />"),this.element.append(this._adjustLine),this.dragger=a.MouseDragger({context:this,target:this._adjustLine,handle:this.head,onBeginDrag:function(a){var c,d,e,f,g,h;if(c=b(a.target),!c.isNodeName("b"))return!1;e=this.option,d=e.context,f=c.offset(),g=d.element.offset(),
h=f.left-g.left+c.width(),e.th=c.parent(),e.beginLeft=h,e.endLeft=h,e.leftLimit=0,e.rightLimit=d.element.width(),e.target.css({left:h+"px",display:"block"})},onMoving:function(a){var b,c;b=this.option,b.context,c=parseFloat(b.target.css("left")),c+=a.x,c<b.leftLimit?c=b.leftLimit:c>b.rightLimit&&(c=b.rightLimit),b.endLeft=c,b.target.css("left",c+"px")},onEndDrag:function(a){var c,d,e,f,g,h;c=this.option,d=c.context,c.target.css("display","none"),e=parseInt(c.th.attr("data-columnIndex"),10),(f=d._getColumn(e))&&c.endLeft!==c.beginLeft&&(g=f.len+(c.endLeft-c.beginLeft),g<30&&(g=30),f.len=g,h=function(a){var c;a&&(c=a.children("colgroup").children()[e])&&(c=b(c),c.css("width",f.len+"px"))},h(d.headTable),h(d.bodyTable),d._updateScrollState())}}),this.dragger.on())},_createFixedHead:function(a){var b,d,e,f,g,h,j,k=[],l=[];for(b=0,d=a.length;b<d;b++){for(g=a[b],f=g.length,h=[],e=0;;){if(e>=f||!g[e].fixed)break;h.push(g[e]),e++}if(h.length>0&&(k.push(h),h.length<f)){for(j=[],e=f;e>=0&&!(--e<0);)if(!i.isEmpty(g[e])){if(!g[e].fixed)break;j.push(g[e])}j.length>0&&l.push(j)}}this._noBodyHover=!1,k.length>0&&(this._noBodyHover=!0,this.fixed.left||(this.fixed.left=new c(this,this.element,{"border-right-width":"1px","border-right-style":"solid",left:0})),this.fixed.left.setHead(k)),l.length>0&&(this._noBodyHover=!0,this.fixed.right||(this.fixed.right=new c(this,this.element,{"border-left-width":"1px","border-left-style":"solid",right:0}),this.fixed.right.offsetCellIndex=e+1,this._headScrollColumn.addFixedScrollColumn(this.head)),this.fixed.right.setHead(l))},_createDataHead:function(a,c){this.reportDataHead?this.reportDataHead.html(""):(this.reportDataHead=b("<div class='data-head'>"),this.head.append(this.reportDataHead)),this.headTable=b("<table class='ui-table-head' cellspacing='0' cellpadding='0' />"),this._createHeadTable(this.headTable,a,c,!1,null,function(a,b,c){this._headScrollColumn.addScrollCol(b,c,this)}),this.reportDataHead.append(this.headTable)},_createFixedBody:function(a){0!==a.length&&(this.fixed.left&&this.fixed.left.setBody(a),this.fixed.right&&this.fixed.right.setBody(a))},_createDataBody:function(c,d,e){var f=!1;this.reportDataBody?(this.reportDataBody.html(""),f=!0):(this.reportDataBody=b("<div class='data-body' />"),this.reportDataBody.on("scroll",this.onScrollingHandler),this.body.append(this.reportDataBody)),this.bodyTable=b("<table class='ui-table-body' cellspacing='0' cellpadding='0' />"),0===c.length?this.prompt.show():(this.prompt.hide(),this._createBodyTable(this.bodyTable,c,d,function(a,b){return b.fixed?null:a}),this.reportDataBody.append(this.bodyTable),this._updateScrollState(),a.setTask(function(){var a=this.reportDataBody[0],b=a.scrollLeft,c=a.scrollWidth;this.fixed.syncScroll(0,b,c)}.bind(this))),a.core.isNumber(e)&&this._renderPageList(e),f&&this.fire("rebind")},_createHeadTable:function(c,d,e,f,g,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(j=a.core.isFunction(g),l=b("<thead />"),Array.isArray(e))for(u=e.length,q=0;q<u;q++){for(t=e[q],m=b("<tr />"),s=t.length,t&&0!==s||m.addClass("empty-row"),w=0,r=0;r<s;r++){if(o=t[r],o.rowspan>u&&(o.rowspan=u),n=this._createCell("th",o),n.addClass("ui-table-head-cell"),r===s-1&&n.addClass("last-cell"),o.rowspan+q===u||q===u-1){for(o._columnKeys||(o._columnKeys={});d[w];)w++;o.hasOwnProperty("columnIndex")?n.attr("data-columnIndex",o.columnIndex):(n.attr("data-columnIndex",w),o.columnIndex=w),o.cell=n,d[w]=o}o.fixed&&!f||(a.core.isFunction(o.text)?p=o.text.call(this,o,n):o.text&&(p=h.call(this,o,n)),p&&n.append(p),this.sorter.setSortColumn(n,o,r),this.option.adjustable&&!f&&n.append("<b class='adjust-column-handle'></b>")),m.append(n),w+=o.colspan||1}l.append(m)}for(k=b("<colgroup />"),q=0,s=d.length;q<s;q++)o=d[q],k.append(this._createCol(o)),v=[o,o.cell],delete o.cell,j&&(v.push(q),v.push(s),g.apply(this,v));a.core.isFunction(i)&&i.call(this,c,m,k),c.append(k),c.append(l)},_createBodyTable:function(c,d,e,f,g){var h,i,j,k,l,m,n,o,p;for(o=e.length,p=a.core.isFunction(g),h=b("<colgroup />"),n=0;n<o;n++)l=e[n],h.append(this._createCol(l));for(i=b("<tbody />"),m=0;m<d.length;m++)k=b("<tr />"),j=d[m],this._createRowCells(k,j,m,e,f),p&&!1===g.call(this,k,j)||i.append(k);c.append(h),c.append(i)},_createCell:function(b,c){var d=this._super(b,c);return a.core.isNumber(c.colspan)&&d.prop("colspan",c.colspan),a.core.isNumber(c.rowspan)&&(d.prop("rowspan",c.rowspan),c.rowspan>1&&d.css("height",c.rowspan*this.rowHeight-1)),d},_getColumn:function(a){return this.dataColumns[a]},_updateScrollState:function(){var b,c,d,e;this.reportDataBody&&this.headTable&&(b=this.reportDataBody.width(),c=this.reportDataBody.height(),d=this.reportDataBody[0].scrollWidth,e=this.reportDataBody[0].scrollHeight,e-c>1?this._headScrollColumn.show():this._headScrollColumn.hide(),d>b?this.fixed.setBodyHeight(this.bodyHeight-a.scrollbarWidth):this.fixed.setBodyHeight(this.bodyHeight))},_getColumnIndexByFormatter:function(a,b){var c,d,e;if(b||(b="formatter"),e=this.fixed.findColumnInfo(a,b))return e;if(this.dataColumns)for(c=0,d=this.dataColumns.length;c<d;c++)if(this.dataColumns[c][b]===a)return{columnIndex:c,columns:this.dataColumns,headTable:this.headTable,bodyTable:this.bodyTable};return{columnIndex:-1}},_addSelectedState:function(a,b,c){this.fixed.syncSelectedState(a,b,!0),this._super(a,b,c)},_removeSelectedState:function(a,b,c){this.fixed.syncSelectedState(a,b,!1),this._super(a,b,c)},_selectItem:function(a,c,d){for(var e,f,g=a;;){if(g.isNodeName("div"))break;g=g.parent()}g.hasClass("ui-report-fixed-body")&&("row"===this.option.selection.type?(e=a[0].rowIndex,a=b(this.bodyTable[0].tBodies[0].rows[e])):(e=a.parent()[0].rowIndex,f=a[0].cellIndex,g[0]===this.fixed.left.body[0]?f+=this.fixed.left.offsetCellIndex:g[0]===this.fixed.right.body[0]&&(f+=this.fixed.right.offsetCellIndex),a=b(this.bodyTable[0].tBodies[0].rows[e].cells[f]))),this._super(a,c,d)},createHead:function(a){Array.isArray(a)&&(this.dataColumns=[],Array.isArray(a[0])||(a=[a]),this.headHeight=this.rowHeight*a.length,this.fixed.reset(),this.sorter.prepareHead(),this._createDataHead(this.dataColumns,a),this._createFixedHead(a),this.dataColumns.forEach(function(a){delete a.rowspan,delete a.colspan}),this.head.css("height",this.headHeight+"px"))},createBody:function(a,b){Array.isArray(a)||(a=[]),this.clear(),0!==a.length&&(this.option.viewData=a,this.dataColumns&&Array.isArray(this.dataColumns)&&this._createDataBody(a,this.dataColumns,b),this._createFixedBody(a))},removeRowAt:function(){var c,d,e,f;if(viewData=this.getViewData(),0!==viewData.length&&0!==(f=arguments.length)){for(d=[],e=0;e<f;e++)c=arguments[e],a.core.isNumber(c)&&c>=0&&c<viewData.length&&d.push(c);if(0!==(f=d.length)){for(d.sort(function(a,b){return b-a}),e=0;e<f;e++)c=d[e],this.fixed.left&&b(this.fixed.left.bodyTable[0].rows[c]).remove(),this.fixed.right&&b(this.fixed.right.bodyTable[0].rows[c]).remove();this._super.apply(this,d)}}},updateRow:function(a,b){var c,d;c=this.getViewData(),0!==(d=c.length)&&(a<0||a>d||(this.fixed.left&&this.fixed.left.updateRow(a,b),this.fixed.right&&this.fixed.right.updateRow(a,b),this._super(a,b,this.dataColumns,function(a,b){return b.fixed?null:a})))},addRow:function(a){var b;if(a){if(b=this.getViewData(),0===b.length)return void this._super(a);this.fixed.left&&this.fixed.left.appendRow(a),this.fixed.right&&this.fixed.right.appendRow(a),this._super(a,this.dataColumns,function(a,b){return b.fixed?null:a})}},insertRow:function(a,b){var c,d;if(b){if(c=this.getViewData(),0===(d=c.length))return void this.addRow(b);a<0&&(a=0),a<d&&(this.fixed.left&&this.fixed.left.insertRow(a,b),this.fixed.right&&this.fixed.right.insertRow(a,b)),this._super(a,b,this.dataColumns,function(a,b){return b.fixed?null:a})}},moveRow:function(a,b){var c;c=this.getViewData(),0!==c.length&&(b<0?b=0:b>=c.length&&(b=c.length-1),a!==b&&(this.fixed.left&&this.fixed.left.moveRow(a,b),this.fixed.right&&this.fixed.right.moveRow(a,b),this._super(a,b)))},clear:function(){this._super(),this.bodyTable&&delete this.bodyTable,this.fixed.clear()}}),b.fn.reportView=function(b){if(0!==this.length)return a.ctrls.ReportView(b,this)}}(ui,ui.$),function(a,b){function c(a){if(!(this instanceof c))return new c(a);this.initialize(a)}function d(a){if(!(this instanceof d))return new d(a);this.initialize(a)}function e(a,b,c){if(!(this instanceof e))return new e(a,b,c);this.initialize(a,b,c)}c.prototype={constructor:c,initialize:function(b){var c;this.tabView=b,this.animationCssItem=b.isHorizontal?"left":"top",c=this,this.animator=a.animator({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css(c.animationCssItem,a+"px")}}).add({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css(c.animationCssItem,a+"px")}}),this.animator.onEnd=function(){c.currentIndex=c.nextIndex,b._current.css("display","none"),b._current=c.nextView,c.nextIndex=null,c.nextView=null,b.fire("changed",c.currentIndex)},a.core.isNumber(b.option.duration)?this.animator.duration=b.option.duration:this.animator.duration=500,this._initBodies()},_initBodies:function(){var a,c,d;for(a=this.tabView,a._current=b(a.bodies[0]),c=1,d=a.bodies.length;c<d;c++)b(a.bodies[c]).css("display","none")},_setCurrent:function(a,b,c){var d,e,f,g;if(d=this.tabView,f=0,this.animator.isStarted&&(this.animator.stop(),f=parseFloat(d._current.css(this.animationCssItem)),e=this.animator[1],e.target&&e.target.css("display","none")),this.currentIndex===b)return d._current.css(this.animationCssItem,0),this.nextIndex=null,void(this.nextView=null);if(!1!==d.fire("changing",b)){if(!1===c)return this.bodySet(b),void d.fire("changed",b);g=d.isHorizontal?d.bodyWidth:d.bodyHeight,0===f&&(this.animator.isNext=b>this.currentIndex),this.nextIndex=b,this.nextView=a,this.animator.isNext?this.nextView.css(this.animationCssItem,g+f+"px"):this.nextView.css(this.animationCssItem,-g+f+"px"),e=this.animator[0],e.target=d._current,e.begin=f,this.animator.isNext?e.end=-g:e.end=g,e=this.animator[1],e.target=this.nextView,e.begin=parseFloat(e.target.css(this.animationCssItem)),e.end=0,e.target.css("display","block"),this.animator.start()}},bodySet:function(a){var c,d;d=this.tabView,c=d.bodies,d._current&&d._current.removeClass("ui-tab-selection").css("display","none"),this.currentIndex=a,d._current=b(c[a]),d._current.css({display:"block",top:"0",left:"0"})},showIndex:function(a,c){var d,e;d=this.tabView,e=d.bodies,a>=0&&a<e.length&&this._setCurrent(b(e[a]),a,c)},putBodies:function(a,b){},restore:function(a){}},d.prototype={constructor:d,initialize:function(b){var c;this.tabView=b,this.animator=a.animator({target:b.bodyPanel,ease:a.AnimationStyle.easeFromTo}),a.core.isNumber(b.option.duration)?this.animator.duration=b.option.duration:this.animator.duration=800,c=this,b.isHorizontal?(this.animator[0].onChange=function(a){b.bodyPanel[0].scrollLeft=a},this.bodyShow=function(a){return c.animator.stop(),c.animator[0].begin=b.bodyPanel[0].scrollLeft,c.animator[0].end=a*b.bodyWidth,c.animator.start()}):(this.animator[0].onChange=function(a){b.bodyPanel.scrollTop(a)},this.bodyShow=function(a){return c.animator.stop(),c.animator[0].begin=b.bodyPanel.scrollTop(),c.animator[0].end=a*b.bodyHeight,c.animator.start()}),this._initTabs(),this._initBodies()},_initTabs:function(){var a,c;c=this.tabView,c.tabPanel&&0!==c.tabPanel.length&&(c.tabs=c.tabPanel.find(".ui-tab-button"),c.tabs.addClass("font-highlight-hover"),a=this,c.tabPanel.on("click",function(d){for(var e=b(d.target);!e.hasClass("ui-tab-button");){if(e[0]===c.tabPanel[0])return;e=e.parent()}a._setCurrent(e)}))},_initBodies:function(){},_setCurrent:function(b,c,d){var e;e=this.tabView,e._current&&e._current[0]===b[0]||(a.core.isNumber(c)||(c=e.getViewIndex(b)),!1!==e.fire("changing",c)&&(e._current&&e.tabs&&e._current.removeClass("ui-tab-selection").removeClass("border-highlight").removeClass("font-highlight"),e._current=b,e._current.addClass("ui-tab-selection"),e.tabs&&e._current.addClass("border-highlight").addClass("font-highlight"),!1===d?(this.bodySet(c),e.fire("changed",c)):this.bodyShow(c).then(function(){e.fire("changed",c)})))},bodySet:function(a){var b=this.tabView;b.isHorizontal?b.bodyPanel[0].scrollLeft=b.bodyWidth*a:b.bodyPanel[0].scrollTop=b.bodyHeight*a},showIndex:function(a,c){var d,e;d=this.tabView,e=d.tabs||d.bodies,a>=0&&a<e.length&&this._setCurrent(b(e[a]),a,c)},putBodies:function(a,c){var d,e,f,g,h=0;if(d=this.tabView,d.isHorizontal)for(e=0,f=d.bodies.length;e<f;e++)g=b(d.bodies[e]),g.css("left",h+"px"),h+=a||0;else for(e=0,f=d.bodies.length;e<f;e++)g=b(d.bodies[e]),g.css("top",h+"px"),h+=c||0},restore:function(a){var b,c;c=this.tabView,c._current&&(b=c.getViewIndex(c._current),!1===a?this.bodySet(b):this.bodyShow(b))}},a.ctrls.define("ctrls.TabView",{_defineOption:function(){return{type:"tab",tabPanel:null,bodyPanel:null,bodies:null,direction:"horizontal",duration:800}},_defineEvents:function(){return["changing","changed"]},_create:function(){this.tabPanel=null,this.bodyPanel=null,this.option.tabPanel&&(this.tabPanel=a.getJQueryElement(this.option.tabPanel)),this.option.bodyPanel&&(this.bodyPanel=a.getJQueryElement(this.option.bodyPanel)),this.bodies=this.option.bodies,this.bodies?this.bodyPanel||(this.bodyPanel=this.bodies.parent()):this.bodies=this.bodyPanel.children(".ui-tab-body"),this.isHorizontal="vertical"!==this.option.direction},_render:function(){"view"===this.option.type?this.model=c(this):this.model=d(this)},getCurrentIndex:function(){return this.getViewIndex(this._current)},getViewIndex:function(a){var b,c,d;if(d=this.tabs||this.bodies,a=a||this._current,d&&a)for(b=0,c=d.length;b<c;b++)if(d[b]===a[0])return b;return 0},showIndex:function(b,c){a.core.isNumber(b)||(b=0),!1!==c&&(c=!0),this.model.showIndex(b,c)},putBodies:function(b,c){a.core.isNumber(b)||(b=this.bodyPanel.width()),a.core.isNumber(c)||(c=this.bodyPanel.height()),this.bodyWidth=b,this.bodyHeight=c,this.model.putBodies(b,c)},restore:function(a){this.model.restore(a)}}),e.prototype={constructor:e,initialize:function(b,c,d){this.tabView=b,this.tabTools=[],this.tabLoadStates=[],a.core.isFunction(d)||(d=c,c=null),a.core.isFunction(c)||(c=function(a,b){this.showTools(b)}),this.tabView&&(this.tabView.changing(c.bind(this)),a.core.isFunction(d)&&this.tabView.changed(d.bind(this)))},addTools:function(){var c,d,e,f,g;for(c=0,d=arguments.length;c<d;c++){if(f=arguments[c],a.core.isString(f))e=b("#"+f),0===e.length&&(e=void 0);else if(Array.isArray(f)){for(e=[],g=0;g<f.length;g++)e.push(b("#"+f[g])),0===e[e.length-1].length&&e.pop();1===e.length&&(e=e[0])}this.tabTools.push(e)}},showTools:function(a){var b,c,d,e,f;for(b=0,c=this.tabTools.length;b<c;b++)if(e=this.tabTools[b])if(f=b===a?"block":"none",Array.isArray(e))for(d=0;d<e.length;d++)e[d].css("display",f);else e.css("display",f)},callWithCache:function(b,c,d){var e,f,g;if(a.core.isFunction(c)){for(e=[],g=arguments.length,f=3;f<g;f++)e.push(arguments[f]);this.tabLoadStates[b]||(c.apply(d,e),this.tabLoadStates[b]=!0)}},resetAt:function(a){a<0||a>=this.tabLoadStates.length||(this.tabLoadStates[a]=!1)},reset:function(){var a,b;for(a=0,b=this.tabLoadStates.length;a<b;a++)this.tabLoadStates[a]=!1}},a.ctrls.TabView.TabManager=e}(ui,ui.$),function(a,b){a.ctrls.define("ui.ctrls.TreeView",a.ctrls.SelectionTree,{_render:function(){var a;this.treePanel=this.element,a=this.treePanel.css("position"),this.treePanel.addClass("ui-selection-tree-panel").addClass("ui-tree-view-panel").css("position",a),this.treePanel.on("click",this.onTreeItemClickHandler),Array.isArray(this.option.viewData)&&this._fill(this.option.viewData)}}),b.fn.treeView=function(b){if(0!==this.length)return a.ctrls.TreeView(b,this)}}(ui,ui.$),function(a,b){function c(){}function d(b){var c=this.option.checkHandler,d=this;this.disabled||(clearTimeout(this.backTimeHandler),a.core.isFunction(c)&&!1===c.call(this)||(0===this.state?(this._next(),this.backTimeHandler=setTimeout(function(){d._back()},this.option.backTime)):1===this.state&&(this._next(),this.option.handler.call(this))))}a.ctrls.define("ui.ctrls.ConfirmButton",{_defineOption:function(){return{disabled:!1,backTime:3e3,checkHandler:!1,handler:!1,color:"#fff",backgroundColor:"#990000"}},_create:function(){this.state=0,("number"!==a.core.type(this.option.backTime)||this.option.backTime<=0)&&(this.option.backTime=5e3),a.core.isFunction(this.option.handler)||(this.option.handler=c),this.option.disabled=!!this.option.disabled,this.onButtonClickHandler=d.bind(this),this.defineProperty("disabled",this.getDisabled,this.setDisabled),this.defineProperty("text",this.getText,this.setText)},_render:function(){var a,c,d;a=this.element.text().trim(),c=b("<span class='text-state' />"),d=b("<i class='confirm-state' />"),c.text(a),d.text("确定"),this.option.backgroundColor&&d.css("background-color",this.option.backgroundColor),this.option.color&&d.css("color",this.option.color),this.element.addClass("confirm-button"),this.element.css("width",this.element.width()+"px"),this.element.empty().append(c).append(d),this.element.on("click",this.onButtonClickHandler),this._initAnimation(c,d),this.disabled=this.option.disabled},_initAnimation:function(b,c){this.changeAnimator=a.animator({target:b,ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("margin-left",a+"%")}}).add({target:c,ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("left",a+"%")}}),this.changeAnimator.duration=200},_back:function(){var a;this.changeAnimator.isStarted||(this.state=0,a=this.changeAnimator[0],a.target.css("margin-left","-200%"),a.begin=-200,a.end=0,a=this.changeAnimator[1],a.target.css("left","0%"),a.begin=0,a.end=100,this.changeAnimator.start())},_next:function(a){var b;this.changeAnimator.isStarted||(0===this.state?(b=this.changeAnimator[0],b.target.css("margin-left","0%"),b.begin=0,b.end=-200,b=this.changeAnimator[1],b.target.css("left","100%"),b.begin=100,b.end=0,this.state=1):(b=this.changeAnimator[0],b.target.css("margin-left","100%"),b.begin=100,b.end=0,b=this.changeAnimator[1],b.target.css("left","0%"),b.begin=0,b.end=-100,this.state=0),this.changeAnimator.start())},getDisabled:function(){return this.option.disabled},setDisabled:function(a){this.option.disabled=!!a,this.option.disabled?this.element.attr("disabled","disabled"):this.element.removeAttr("disabled")},getText:function(){return this.element.children(".text-state").text()},setText:function(b){this.element.children(".text-state").text(a.str.trim(b+""))}}),b.fn.confirmClick=function(b){return this&&0!==this.length?(a.core.isFunction(b)&&(b=a.core.isFunction(arguments[1])?{checkHandler:b,handler:arguments[1]}:{handler:b}),a.ctrls.ConfirmButton(b,this)):null}}(ui,ui.$),function(a,b){a.ctrls.define("ui.ctrls.ExtendButton",{_defineOption:function(){return{buttonSize:32,centerIcon:"close",centerSize:null,buttons:[],parent:null}},_defineEvents:function(){return["showing","shown","hiding","hidden"]},_create:function(){this.parent=a.getJQueryElement(this.option.parent),this.parent?this.isBodyInside=!1:(this.parent=b(document.body),this.isBodyInside=!0),this.buttonPanelBGBorderWidth=0,"number"!==a.core.type(this.option.buttonSize)&&(this.option.buttonSize=32),this.centerSize=this.option.centerSize,"number"!==a.core.type(this.centerSize)&&(this.centerSize=this.option.buttonSize),"array"!==a.core.type(this.option.buttons)&&(this.option.buttons=[]),this.buttonPanel=b("<div class='extend-button-panel' />"),this.buttonPanelBackground=b("<div class='extend-button-background border-highlight' />"),this.hasCloseButton=!1,"close"===this.option.centerIcon?(this.hasCloseButton=!0,this.centerIcon=b("<a class='center-icon closable-button font-highlight' style='font-size:24px !important;' title='关闭'>×</a>")):"none"===this.option.centerIcon?(this.centerIcon=b("<a class='center-icon center-none border-highlight' />"),this.backgroundColorPanel=b("<div class='background-panel' />"),this.buttonPanelBackground.append(this.backgroundColorPanel),this.buttonPanelBackground.append(this.centerIcon),this.buttonPanelBackground.css("background-color","transparent")):(this.centerIcon=b("<a class='center-icon' />"),a.str.isEmpty(this.option.centerIcon)||this.centerIcon.append(this.option.centerIcon)),this._createAnimator()},_render:function(){var c,d=0,e=this;for(this._caculateSize(),this.buttonPanel.append(this.buttonPanelBackground),"none"===this.option.centerIcon?(this.backgroundColorPanel.css({width:this.centerSize+"px",height:this.centerSize+"px"}),this.buttonPanelAnimator[2].onChange=function(a){var b=(e.buttonPanelSize-e.centerSize)/2;b=a>e.centerSize?Math.ceil(b*(a/e.buttonPanelSize)):0,this.target.css({width:a+"px",height:a+"px"}),e.backgroundColorPanel.css("border-width",b+"px")},this.centerIcon.css({width:this.centerSize+"px",height:this.centerSize+"px","margin-left":-(this.centerSize/2+1)+"px","margin-top":-(this.centerSize/2+1)+"px"})):(this.centerIcon.css({width:this.centerSize+"px",height:this.centerSize+"px","line-height":this.centerSize-2+"px",top:this.centerTop-this.centerSize/2+"px",left:this.centerLeft-this.centerSize/2+"px"}),this.buttonPanel.append(this.centerIcon)),c=this.option.buttons.length;d<c;d++)this._createButton(this.option.buttons[d],this.deg*d);b.isFunction(this.element.addClass)&&this.element.addClass("extend-element"),this.parent.append(this.buttonPanel),this.buttonPanelBGBorderWidth=parseFloat(this.buttonPanelBackground.css("border-top-width"))||0,this.element.on("click",function(a){a.stopPropagation(),e.show()}),this.hasCloseButton?this.centerIcon.on("click",function(a){e.hide()}):a.page.htmlclick(function(a){e.hide()}),this.buttonPanel.on("click",function(a){a.stopPropagation()})},_createAnimator:function(){this.buttonPanelAnimator=a.animator({target:this.buttonPanelBackground,onChange:function(a){this.target.css("top",a+"px")}}).add({target:this.buttonPanelBackground,onChange:function(a){this.target.css("left",a+"px")}}).add({target:this.buttonPanelBackground,onChange:function(a){this.target.css({width:a+"px",height:a+"px"})}}).add({target:this.buttonPanelBackground,onChange:function(a){this.target.css("opacity",a/100)}}),this.buttonPanelAnimator.duration=240,this.buttonAnimator=a.animator(),this.buttonAnimator.duration=240},_getElementCenter:function(){var a=this.isBodyInside?this.element.offset():this.element.position(),b=this.element.getBoundingClientRect();return a.left=a.left+b.width/2,a.top=a.top+b.height/2,a},_setButtonPanelAnimationOpenValue:function(b){var c,d;c=b[0],d=c.target,c.begin=this.centerTop-this.centerSize/2,c.end=0-this.buttonPanelBGBorderWidth,c.ease=a.AnimationStyle.easeTo,c=b[1],c.begin=this.centerLeft-this.centerSize/2,c.end=0-this.buttonPanelBGBorderWidth,c.ease=a.AnimationStyle.easeTo,c=b[2],c.begin=this.centerSize,c.end=this.buttonPanelSize,c.ease=a.AnimationStyle.easeTo,c=b[3],c.begin=0,c.end=100,c.ease=a.AnimationStyle.easeFrom,d.css({left:this.centerLeft-this.buttonSize/2+"px",top:this.centerTop-this.buttonSize/2+"px",width:this.buttonSize+"px",height:this.buttonSize+"px"})},_setButtonPanelAnimationCloseValue:function(b){for(var c,d,e=0,f=b.length;e<f;e++)c=b[e],d=c.begin,c.begin=c.end,c.end=d,c.ease=a.AnimationStyle.easeFrom},_setButtonAnimationOpenValue:function(b){for(var c,d,e=0,f=b.length;e<f;e++)d=this.option.buttons[e],c=b[e],c.begin=0,c.end=100,c.ease=a.AnimationStyle.easeTo,c.target.css({top:d.startTop+"px",left:d.startLeft+"px"})},_setButtonAnimationCloseValue:function(b){for(var c,d=0,e=b.length;d<e;d++)this.option.buttons[d],c=b[d],c.begin=100,c.end=0,c.ease=a.AnimationStyle.easeFrom},_caculateSize:function(){var a=this.option.buttons.length;this.deg=360/a;var b=this.deg/180*Math.PI,c=this.option.buttonSize,d=c/2/Math.tan(b/2);d<=c/2&&(d=c/2+4),this.centerRadius=d+c/2,this.insideRadius=d+c,this.outsideRadius=Math.sqrt(this.insideRadius*this.insideRadius+c/2*(c/2)),this.outsideRadius+=20,this.buttonSize=c,this.buttonPanelSize=Math.ceil(2*this.outsideRadius),this.centerTop=this.centerLeft=this.buttonPanelSize/2},_setButtonPanelLocation:function(){var a=this._getElementCenter(),b=Math.floor(a.top-this.buttonPanelSize/2),c=Math.floor(a.left-this.buttonPanelSize/2);this.buttonPanel.css({top:b+"px",left:c+"px",width:this.buttonPanelSize+"px",height:this.buttonPanelSize+"px"})},_caculatePositionByCenter:function(a,b){var c={left:0,top:0};return c.left=a-this.buttonSize/2,c.top=b-this.buttonSize/2,c},_createButton:function(c,d){var e,f,g,h,i=this;c.elem=b("<a href='javascript:void(0)' class='extend-button background-highlight' />"),c.icon&&c.elem.append(c.icon),a.str.isEmpty(c.title)&&c.elem.prop("title",c.title),c.centerStartLeft=0,c.centerStartTop=0,e=d/180*Math.PI,g=this.centerRadius*Math.sin(e)+c.centerStartLeft,h=this.centerRadius*Math.cos(e)+c.centerStartTop,c.centerLeft=Math.floor(this.centerLeft+g),c.centerTop=Math.floor(this.centerTop-h),f=this._caculatePositionByCenter(this.centerLeft,this.centerTop),c.startLeft=f.left,c.startTop=f.top,c.elem.css({width:this.buttonSize+"px",height:this.buttonSize+"px","line-height":this.buttonSize-2+"px"}),this.buttonPanel.append(c.elem),this.buttonAnimator.add({target:c.elem,button:c,that:this,onChange:function(a){var b=(this.button.centerLeft-this.that.centerLeft)*a/100+this.that.centerLeft,c=(this.button.centerTop-this.that.centerTop)*a/100+this.that.centerTop,d=this.that._caculatePositionByCenter(b,c);this.target.css({left:d.left+"px",top:d.top+"px"})}}),a.core.isFunction(c.handler)&&c.elem.on("click",function(a){c.handler.call(i,c)})},isShow:function(){return"block"===this.buttonPanel.css("display")},show:function(a){var b=this;this.isShow()||!1!==this.fire("showing")&&(this._setButtonPanelLocation(),!1===a?this.buttonPanel.css("display","block"):(this.buttonPanel.css("display","block"),this._setButtonPanelAnimationOpenValue(this.buttonPanelAnimator),this._setButtonAnimationOpenValue(this.buttonAnimator),this.buttonPanelAnimator.start(),this.buttonAnimator.delayHandler=setTimeout(function(){b.buttonAnimator.delayHandler=null,b.buttonAnimator.start().then(function(){b.fire("shown")})},100)))},hide:function(a){var b=this;this.isShow()&&!1!==this.fire("hiding")&&(!1===a?this.buttonPanel.css("display","none"):(this._setButtonPanelAnimationCloseValue(this.buttonPanelAnimator),this._setButtonAnimationCloseValue(this.buttonAnimator),this.buttonAnimator.start(),this.buttonPanelAnimator.delayHandler=setTimeout(function(){b.buttonPanelAnimator.delayHandler=null,b.buttonPanelAnimator.start().then(function(){b.buttonPanel.css("display","none"),b.fire("hidden")})},100)))}}),b.fn.extendButton=function(b){return 0===this.length?null:a.ctrls.ExtendButton(b,this)}}(ui,ui.$),function(a,b){function c(a){for(var c,d=b(a.target);"LABEL"!==(c=d.nodeName());){if("DIV"===c)return;d=d.parent()}this._selectItem(d)}var d=0;a.ctrls.define("ui.ctrls.FilterButton",{_defineOption:function(){return{viewData:[],defaultIndex:0,filterCss:null}},_defineEvents:function(){return["selected","deselected"]},_create:function(){var e,f,g,h;for(this.filterPanel=b("<div class='filter-button-panel'>"),this.parent=this.element,this.radioName="filter_button_"+d++,this._current=null,this.onItemClickHandler=c.bind(this),h=this.getViewData(),e=0,f=h.length;e<f;e++)g=h[e],!0===g.selected&&(this.option.defaultIndex=e),this._createTool(g,e);this.option.filterCss&&this.filterPanel.css(this.option.filterCss),this.filterPanel.on("click",this.onItemClickHandler),this.parent.append(this.filterPanel),(!a.core.isNumber(this.option.defaultIndex)||this.option.defaultIndex>=f||this.option.defaultIndex<0)&&(this.option.defaultIndex=0),this.setIndex(this.option.defaultIndex)},_createTool:function(c,d){var e,f,g;a.core.isPlainObject(c)&&(e=b("<label class='filter-button-item' />"),f=b("<input type='radio' class='filter-button-item-radio' name='"+this.radioName+"'/>"),g=b("<span class='filter-button-item-text' />"),e.append(f).append(g),e.attr("data-index",d),0===d&&e.addClass("filter-button-item-first"),e.addClass("font-highlight").addClass("border-highlight"),f.prop("value",c.value||""),g.text(c.text||"tool"+d),this.filterPanel.append(e))},_getSelectionData:function(a){var b=parseInt(a.attr("data-index"),10);return{itemIndex:b,itemData:this.getViewData()[b]}},_selectItem:function(a){var b;if(this._current){if(a[0]===this._current[0])return;this._current.addClass("font-highlight").removeClass("background-highlight"),b=this._getSelectionData(this._current),this.fire("deselected",b)}this._current=a,a.find("input").prop("checked",!0),this._current.addClass("background-highlight").removeClass("font-highlight"),b=this._getSelectionData(this._current),this.fire("selected",b)},_getIndexByValue:function(a){var b,c,d;for(b=this.getViewData(),c=-1,d=b.length-1;d>=0;d--)if(b[d].value===a){c=d;break}return c},_setDisplayIndex:function(c,d){var e,f;e=this.getViewData(),0!==e.length&&(a.core.isNumber(c)||(c=0),c>=0&&c<e.length&&(f=b(this.filterPanel.children()[c]),d?f.addClass("filter-button-item-hide"):f.removeClass("filter-button-item-hide"),this._updateFirstClass()))},_updateFirstClass:function(){var a,c,d,e,f;for(a=this.filterPanel.children(),d=a.length;c<d;c++)e=b(a[c]),e.hasClass("filter-button-item-hide")||(f?e.removeClass("filter-button-item-first"):f=e);f&&f.addClass("filter-button-item-first")},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},getSelection:function(){return this._current?this._getSelectionData(this._current):null},setIndex:function(a){var c,d;c=this.getViewData(),0!==c.length&&(b.isNumeric(a)||(a=0),a>=0&&a<c.length&&(d=b(this.filterPanel.children()[a]),this._selectItem(d)))},setValue:function(a){var b=this._getIndexByValue(a);b>-1&&this.setIndex(b)},hideIndex:function(a){this._setDisplayIndex(a,!0)},hideValue:function(a){var b=this._getIndexByValue(a);b>-1&&this.hideIndex(b)},showIndex:function(a){this._setDisplayIndex(a,!1)},showValue:function(a){var b=this._getIndexByValue(a);b>-1&&this.showIndex(b)}}),b.fn.filterButton=function(b){return 0===this.length?null:a.ctrls.FilterButton(b,this)}}(ui,ui.$),function(a,b){function c(a){var b=a.clientX,c=a.clientY;if(!this.animator.isStarted){var d=this.target.offset(),e={top:Math.floor(d.top),left:Math.floor(d.left)};e.bottom=e.top+this.targetHeight,e.right=e.left+this.targetWidth,d=this.viewPanel.offset();var f={top:Math.floor(d.top),left:Math.floor(d.left)};f.bottom=f.top+this.height,f.right=f.left+this.width;var g,h,i=-1,j=-1,k=e.top<f.top?e.top:f.top,l=e.bottom>f.bottom?e.bottom:f.bottom;if(e.left<f.left?(g=e.left,h=f.right):(g=f.left,h=e.right),b<g?i=g-b:b>h&&(i=b-h),c<k?j=k-c:c>l&&(j=c-l),-1===i&&-1===j&&(i=0,b>=e.left&&b<=e.right?(c<=e.top-this.buffer||c>=e.bottom+this.buffer)&&(j=this.buffer):b>=f.left&&b<=f.right&&(c<f.top?j=f.top-c:c>f.bottom&&(j=c-f.bottom)),-1===j))return void this.viewPanel.css("opacity",1);if(i>this.buffer||j>this.buffer)return void this.hide();var m=1-(i>j?i:j)/this.buffer;if(m<.2)return void this.hide();this.viewPanel.css("opacity",m)}}var d=1;a.ctrls.define("ui.ctrls.HoverView",{buffer:30,_defineOption:function(){return{width:160,height:160}},_defineEvents:function(){return["showing","shown","hiding","hidden"]},_create:function(){(!a.core.isNumber(this.option.width)||this.option.width<=0)&&(this.option.width=160),(!a.core.isNumber(this.option.height)||this.option.height<=0)&&(this.option.height=160),this.viewPanel=b("<div class='hover-view-panel border-highlight' />"),this.viewPanel.css({width:this.option.width+"px","max-height":this.option.height+"px"}),b(document.body).append(this.viewPanel),this.width=this.option.width,this.height=this.option.height,this.target=null,this.targetWidth=null,this.targetHeight=null,this.hasDocMousemoveEvent=!1,this.isShow=!1,this.onDocumentMousemoveHander=c.bind(this),this.onDocumentMousemoveHander.guid="hoverView"+d++,this.animator=a.animator({target:this.viewPanel,ease:a.AnimationStyle.easeFrom,onChange:function(a){this.target.css("opacity",a/100)}}).add({target:this.viewPanel,ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}}).add({target:this.viewPanel,
ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css("top",a+"px")}}),this.animator.duration=300},clear:function(){return this.viewPanel.empty(),this},append:function(a){return this.viewPanel.append(a),this},addDocMousemove:function(){this.hasDocMousemoveEvent||(this.hasDocMousemoveEvent=!0,b(document).on("mousemove",this.onDocumentMousemoveHander))},removeDocMousemove:function(){this.hasDocMousemoveEvent&&(this.hasDocMousemoveEvent=!1,b(document).off("mousemove",this.onDocumentMousemoveHander))},setLocation:function(){a.setLeft(this.target,this.viewPanel)},getLocation:function(){return a.getLeftLocation(this.target,this.width,this.height)},show:function(a){var b,c,d,e=this;this.target=a,!1!==this.fire("showing")&&(this.animator.stop(),b=this.getLocation(),this.isShow?(c=this.animator[0],c.current<100?(c.begin=c.current,c.end=100):c.begin=c.end=100,c=this.animator[1],c.begin=parseFloat(this.viewPanel.css("left")),c.end=b.left,c=this.animator[2],c.begin=parseFloat(this.viewPanel.css("top")),c.end=b.top):(this.viewPanel.css({top:b.top+"px",left:b.left+"px"}),c=this.animator[0],c.begin=0,c.end=100,c=this.animator[1],c.begin=c.end=b.left,c=this.animator[2],c.begin=c.end=b.top),this.isShow=!0,this.viewPanel.css("display","block"),d=this.target.getBoundingClientRect(),this.targetWidth=d.width,this.targetHeight=d.height,d=this.viewPanel.getBoundingClientRect(),this.width=d.width,this.height=d.height,this.animator.start().then(function(){e.addDocMousemove(),e.fire("shown")}))},hide:function(){var a,b=this;!1!==this.fire("hiding")&&(this.removeDocMousemove(),this.animator.stop(),a=this.animator[0],a.begin=100*(parseFloat(this.viewPanel.css("opacity"))||1),a.end=0,a=this.animator[1],a.begin=a.end=0,a=this.animator[2],a.begin=a.end=0,this.animator.start().then(function(){b.isShow=!1,b.viewPanel.css("display","none"),b.fire("hidden")}))}}),a.createHoverView=function(b){return a.ctrls.HoverView(b)},b.fn.addHoverView=function(b){if(0===this.length)return null;var c=this;b instanceof a.ctrls.HoverView&&this.mouseover(function(a){b.show(c)})}}(ui,ui.$),function(a,b){function c(a){return document.createElementNS(l,a)}function d(a,b,c){2===arguments.length&&b?Object.keys(b).forEach(function(c){a.setAttribute(c,b[c])}):arguments.length>2&&a.setAttribute(b,c)}function e(a,b,c){2===arguments.length&&b?Object.keys(b).forEach(function(c){a.style[c]=b[c]}):arguments.length>2&&(a.style[b]=c)}function f(){return"<span class='ui-progress-indication' style='color:"+this.progressColor+"'>"+this.percent+"%</span>"}function g(a){var b=this;Object.keys(a).forEach(function(c){Object.defineProperty(b,c,{get:function(){return a[c]},set:function(b){a[c]=b,this.update(c)},enumerable:!0,configurable:!0})})}function h(a){var b;if(a.type=(a.type||"circle").toLowerCase(),"circle"===a.type)g.prototype=i,b=new g(a);else if("dashboard"===a.type)g.prototype=j,b=new g(a);else{if("bar"!==a.type)return null;g.prototype=k,b=new g(a)}return b}var i,j,k,l="http://www.w3.org/2000/svg";i={render:function(){var a,f,g,h,i;return a=b("<div class='ui-progress-container' />"),a.css({width:this.size+"px",height:this.size+"px"}),f=b("<svg viewBox='0 0 100 100'></svg>"),i=50-Math.max(this.trackWidth,this.progressWidth)/2,this.trackLength=2*Math.PI*i,h=["M 50,50 m 0,",-i," a ",i,",",i," 0 1 1 0,",2*i," a ",i,",",i," 0 1 1 0,",2*-i],h=h.join(""),g=c("path"),d(g,{d:h,"fill-opacity":0,stroke:this.trackColor,"stroke-width":this.trackWidth}),f.append(g),g=c("path"),d(g,{d:h,"fill-opacity":0,"stroke-linecap":"round",stroke:this.progressColor,"stroke-width":this.progressWidth}),e(g,{"stroke-dasharray":this.trackLength+"px,"+this.trackLength+"px","stroke-dashoffset":(100-this.percent)/100*this.trackLength+"px",transition:"stroke-dashoffset 0.6s ease 0s, stroke 0.6s ease"}),f.append(g),a.append(f),this.textElem=b("<div class='ui-progress-text' />"),this.updateText(),a.append(this.textElem),this.contianer=a,this.progressElem=g,a},update:function(a){"percent"===a?(e(this.progressElem,"stroke-dashoffset",(100-this.percent)/100*this.trackLength+"px"),this.updateText()):"progressColor"===a&&(d(this.progressElem,"stroke",this.progressColor),this.updateText())},updateText:function(){!1!==this.textTemplate&&(a.core.isFunction(this.textTemplate)?this.textElem.html(this.textTemplate()):this.textElem.html(f.call(this)))},show:function(){this.contianer.css("display","block")},hide:function(){this.contianer.css("display","none")}},j={render:function(){var a,f,g,h,i;return a=b("<div class='ui-progress-container' />"),a.css({width:this.size+"px",height:this.size+"px"}),f=b("<svg viewBox='0 0 100 100'></svg>"),i=50-Math.max(this.trackWidth,this.progressWidth)/2,this.trackLength=2*Math.PI*i,this.gap=75,h=["M 50,50 m 0,",i," a ",i,",",i," 0 1 1 0,",2*-i," a ",i,",",i," 0 1 1 0,",2*i],h=h.join(""),g=c("path"),d(g,{d:h,"fill-opacity":0,stroke:this.trackColor,"stroke-width":this.trackWidth}),e(g,{"stroke-dasharray":this.trackLength-this.gap+"px,"+this.trackLength+"px","stroke-dashoffset":-this.gap/2+"px",transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s"}),f.append(g),g=c("path"),d(g,{d:h,"fill-opacity":0,"stroke-linecap":"butt",stroke:this.progressColor,"stroke-width":this.progressWidth}),e(g,{"stroke-dasharray":this.percent/100*(this.trackLength-this.gap)+"px,"+this.trackLength+"px","stroke-dashoffset":-this.gap/2+"px",transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .6s ease 0s, stroke .6s, stroke-width .06s ease .6s"}),f.append(g),a.append(f),this.textElem=b("<div class='ui-progress-text' />"),this.updateText(),a.append(this.textElem),this.contianer=a,this.progressElem=g,a},update:function(a){"percent"===a?(e(this.progressElem,"stroke-dasharray",percent/100*(this.trackLength-this.gap)+"px,"+this.trackLength+"px"),this.updateText()):"progressColor"===a&&(d(this.progressElem,"stroke",this.progressColor),this.updateText())},updateText:i.updateText,show:i.show,hide:i.hide},k={render:function(){var a,c;return a=b("<div class='ui-progress-track' />"),a.css({width:this.size+"px",height:this.progressWidth+"px"}),c=b("<div class='ui-progress-bar background-highlight' />"),c.css("width",this.percent+"%"),a.append(c),this.progressElem=c,a},update:function(a){"percent"===a&&this.progressElem.css("width",this.percent+"%")},show:function(){this.progressElem.parent().css("display","block")},hide:function(){this.progressElem.parent().css("display","none")}},a.ctrls.define("ui.ctrls.Progress",{_defineOption:function(){return{type:"circle",size:100,percent:0,trackColor:"#f1f1f1",trackWidth:5,progressColor:"#ff0066",progressWidth:6,textTemplate:f}},_create:function(){if(a.core.isNumber(this.option.percent)||(this.option.percent=0),this.view=h(this.option),!this.view)throw new TypeError("the option.type: "+this.option.type+" is invalid.");this.defineProperty("percent",this.getPercent,this.setPercent)},_render:function(){this.element.addClass("ui-progress"),this.element.append(this.view.render())},getPercent:function(){return this.view.percent},setPercent:function(b){a.core.isNumber(b)&&(this.view.percent=b)},show:function(){this.view.show()},hide:function(){this.view.hide()}}),b.fn.progress=function(b){return 0===this.length?null:a.ctrls.Progress(b,this)}}(ui,ui.$),function(a,b){function c(a){var b,c=a.option;b=this.isHorizontal()?this.track.width():this.track.height(),c.lengthValue=b}function d(a){var b,c=a.option;b=this.thumb.width()/2,this.isHorizontal()?e.call(this,a.x,b,c.lengthValue):f.call(this,a.y,b,c.lengthValue)}function e(a,b,c){var d,e;e=parseFloat(this.thumb.css("left"))||0,e+=a,d=i.call(this,e+b,0,c),this.percent!==d&&(this.percent=d,this.valuebar.css("width",this.percent+"%"),this.thumb.css("left",c*(this.percent/100)-b+"px"),this.fire("changed",d))}function f(a,b,c){var d,e;e=parseFloat(this.thumb.css("top"))||0,e+=a,d=i.call(this,e+b,0,c),this.percent!==d&&(this.percent=100-d,this.valuebar.css({top:d+"%",height:this.percent+"%"}),this.thumb.css("top",c*(d/100)-b+"px"),this.fire("changed",d))}function g(a){var b,c,e;this.mouseDragger._isDragStart||(e={},b=this.track.offset(),this.isHorizontal()?(c=this.track.width(),e.x=a.pageX-b.left,e.x-=parseFloat(this.thumb.css("left"))||0):(c=this.track.height(),e.y=a.pageY-b.top,e.y-=parseFloat(this.thumb.css("top"))||0),e.option={lengthValue:c},d.call(this,e))}function h(a){var b,c,e,f;a.stopPropagation(),this.mouseDragger._isDragStart||(c={},f=Math.trunc(a.deltaY||-a.wheelDelta),e=5*f,this.isHorizontal()?(b=this.track.width(),c.x=e):(b=this.track.height(),c.y=e),c.option={lengthValue:b},d.call(this,c))}function i(b,c,d){return b>d?100:b<c?0:a.fixedNumber(b/d*100,2)}a.ctrls.define("ui.ctrls.Slidebar",{_defineOption:function(){return{direction:"horizontal",iframeShield:!1,thickness:8,readonly:!1,disabled:!1}},_defineEvents:function(){return["changed"]},_create:function(){var a;this.percent=0,a=this.element.css("position"),"absolute"!==a&&"relative"!==a&&"fixed"!==a&&this.element.css("position","relative"),this.element.addClass("ui-slidebar"),this.defineProperty("readonly",this.getReadonly,this.setReadonly),this.defineProperty("disabled",this.getDisabled,this.setDisabled),this.defineProperty("percentValue",this.getPercent,this.setPercent),this.onMouseupHandler=g.bind(this),this.onMouseWheelHandler=h.bind(this)},_render:function(){this.track=b("<div class='ui-slidebar-track' />"),this.valuebar=b("<div class='ui-slidebar-value' />"),this.thumb=b("<b class='ui-slidebar-thumb' />"),this.track.append(this.valuebar),this.element.append(this.track).append(this.thumb),this._initScale(),this._initMouseDragger(),this.track.on("mouseup",this.onMouseupHandler),this.element.on("wheel",this.onMouseWheelHandler),this.readonly=this.option.readonly,this.disabled=this.option.disabled},_initScale:function(){var a=this.option.thickness,b=2*a;this.thumb.css({width:b+"px",height:b+"px"}),this.isHorizontal()?(this.track.css({width:"100%",height:a+"px",top:(b-a)/2+"px"}),this.valuebar.css("width","0"),this.thumb.css("left",-b/2+"px"),this.element.css("height",b+"px")):(this.track.css({width:a+"px",height:"100%",left:(b-a)/2+"px"}),this.valuebar.css({top:"100%",height:"0"}),this.thumb.css("top",this.track.height()-b/2+"px"),this.element.css("width",b+"px"))},_initMouseDragger:function(){var b={target:this.thumb,handle:this.thumb,context:this,onBeginDrag:function(a){var b=a.option,d=b.context;c.call(d,a)},onMoving:function(a){var b=a.option,c=b.context;d.call(c,a)}};this.mouseDragger=new a.MouseDragger(b)},isHorizontal:function(){return"horizontal"===this.option.direction},getReadonly:function(){return this.option.readonly},setReadonly:function(a){this.option.readonly=!!a,this.option.readonly?(this.mouseDragger.off(),this.valuebar.removeClass("background-highlight"),this.thumb.removeClass("background-highlight")):(this.mouseDragger.on(),this.valuebar.addClass("background-highlight"),this.thumb.addClass("background-highlight"))},getDisabled:function(){return this.option.disabled},setDisabled:function(a){this.option.disabled=!!a,this.option.disabled?(this.mouseDragger.off(),this.valuebar.removeClass("background-highlight"),this.thumb.removeClass("background-highlight")):(this.mouseDragger.on(),this.valuebar.addClass("background-highlight"),this.thumb.addClass("background-highlight"))},getPercent:function(){return this.percent},setPercent:function(b){var c,e={option:{}};c=b,a.core.isNumber(c)&&(c<0?c=0:c>100&&(c=100),this.isHorizontal()?(e.option.lengthValue=this.track.width(),e.x=e.option.lengthValue*c/100):(e.option.lengthValue=this.track.height(),e.y=e.option.lengthValue*(0-c)/100),d.call(this,e))}}),b.fn.slidebar=function(b){return 0===this.length?null:a.ctrls.Slidebar(b,this)}}(ui,ui.$),function(a,b){var c,d,e;c={open:function(){var a;this.animator.stop(),this.switchBox.addClass("switch-open"),this.inner.addClass("border-highlight").addClass("background-highlight"),a=this.animator[0],a.beginColor=this.option.thumbColor,a.endColor="#FFFFFF",a.begin=0,a.end=100,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=this.width-this.thumbSize-4,this.animator.start()},close:function(){var a;this.animator.stop(),this.switchBox.removeClass("switch-open"),this.inner.removeClass("border-highlight").removeClass("background-highlight"),a=this.animator[0],a.beginColor="#FFFFFF",a.endColor=this.option.thumbColor,a.begin=0,a.end=100,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=4,this.animator.start()},thumbSize:16},d={init:function(){this.switchBox.addClass("switch-lollipop")},open:function(){var a;this.animator.stop(),this.switchBox.addClass("switch-open"),this.inner.addClass("background-highlight"),this.thumb.addClass("border-highlight").addClass("background-highlight"),a=this.animator[0],a.begin=0,a.end=0,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=this.option.width-this.thumbSize,this.animator.start()},close:function(){var a;this.animator.stop(),this.switchBox.removeClass("switch-open"),this.inner.removeClass("background-highlight"),this.thumb.removeClass("border-highlight").removeClass("background-highlight"),a=this.animator[0],a.begin=0,a.end=0,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=0,this.animator.start()},thumbSize:24},e={init:function(){this.switchBox.addClass("switch-marshmallow")},open:d.open,close:d.close,thumbSize:24},a.ctrls.define("ui.ctrls.SwitchButton",{_defineOption:function(){return{width:44,height:24,thumbColor:null,readonly:!1,style:null}},_defineEvents:function(){return["changed"]},_create:function(){var f,g;this.switchBox=b("<label class='ui-switch-button' />"),this.inner=b("<div class='switch-inner' />"),this.thumb=b("<div class='switch-thumb' />"),g=a.core.isString(this.option.style)?"lollipop"===this.option.style?d:"marshmallow"===this.option.style?e:c:a.core.isObject(this.option.style)?this.option.style:c,a.core.isFunction(g.init)&&g.init.call(this),this._open=g.open,this._close=g.close,this.thumbSize=g.thumbSize,this._createAnimator(),this.element.wrap(this.switchBox),this.switchBox=this.element.parent(),this.switchBox.append(this.inner).append(this.thumb),this.option.thumbColor?this.thumb.css("background-color",this.option.thumbColor):this.option.thumbColor=this.thumb.css("background-color"),this.width=this.option.width||parseFloat(this.switchBox.css("width")),this.height=this.option.height||parseFloat(this.switchBox.css("height")),f=this,this.element.change(function(a){f.onChange()}),this.defineProperty("readonly",this.getReadonly,this.setReadonly),this.defineProperty("value",this.getValue,this.setValue),this.defineProperty("checked",this.getChecked,this.setChecked),this.readonly=!!this.option.readonly,this.checked&&this._open()},_createAnimator:function(){this.animator=a.animator({target:this.thumb,ease:a.AnimationStyle.easeTo,onChange:function(b){var c=a.color.overlay(this.beginColor,this.endColor,b/100);c=a.color.rgb2hex(c.red,c.green,c.blue),this.target.css("background-color",c)}}).add({target:this.thumb,ease:a.AnimationStyle.easeFromTo,onChange:function(a,b){b.css("left",a+"px")}}),this.animator.duration=200},onChange:function(){var a=this.element.prop("checked");if(this.readonly)return void this.element.prop("checked",!a);a?this._open():this._close(),this.fire("changed")},_isOpen:function(){return this.switchBox.hasClass("switch-open")},getReadonly:function(){return!!this.option.readonly},setReadonly:function(a){this.option.readonly=!!a,this.option.readonly?this.element.attr("readonly","readonly"):this.element.removeAttr("readonly")},getValue:function(){return this.element.val()},setValue:function(a){this.element.val(a)},getChecked:function(){return this.element.prop("checked")},setChecked:function(a){var b=this.element.prop("checked");!!arguments[0]!==b?(this.element.prop("checked",arguments[0]),this.onChange()):b&&!this._isOpen()?this._open():!b&&this._isOpen()&&this._close()}}),b.fn.switchButton=function(b){if(0===this.length)return null;if("INPUT"!==this.nodeName()&&"checkbox"!==this.prop("type"))throw new TypeError("the element is not checkbox");return a.ctrls.SwitchButton(b,this)}}(ui,ui.$),function(a,b){function c(){Object.keys(g).forEach(function(a){d(a,g[a])})}function d(b,c){var d,e=a.theme.backgroundColor||"#FFFFFF";d=a.color.overlay(e,c,.2),d=a.color.rgb2hex(d.red,d.green,d.blue),h||(h=a.StyleSheet.createStyleSheet("uiTagStyle")),h.setRule(a.str.format(".ui-tag-{0}",b),{"background-color":d,"border-color":c,color:c}),h.setRule(a.str.format(".ui-tag-{0} .ui-tag-close:hover",b),{"background-color":c,color:d})}var e,f={mini:16,small:20,normal:24,big:28},g={green:"#00AE6E",red:"#DE2B18",yellow:"#CCA700",purple:"#6064C5",blue:"#026AD8"},h=null;e=function(){a.on("click",".ui-tag",function(a){var c=b(a.target);if(c.hasClass("ui-tag-close"))c.parent().data("ui.ctrls.Tag").remove();else{for(;!c.hasClass("ui-tag");){if("BODY"===c.nodeName())return;c=c.parent()}c.data("ui.ctrls.Tag").fire("click")}}),e=function(){}},a.ctrls.define("ui.ctrls.Tag",{_defineOption:function(){return{color:"highlight",size:"normal",closable:!1,noBorder:!1,text:"Tag",marginRight:!1}},_defineEvents:function(){return["click","close"]},_create:function(){a.core.isNumber(this.option.size)?this.height=this.option.size:this.height=f[this.option.size||"normal"]||f.normal,this.contentMargin=this.height/2,this.option.noBorder?this.borderWidth=0:this.borderWidth=1,this.defineProperty("text",this.getText,this.setText),c.isInitialized||(c(),c.isInitialized=!0),e()},_render:function(){var c=this.height-2*this.borderWidth;this.label=b("<label class='ui-tag' />"),this.label.css({height:this.height+"px","line-height":c+"px","border-radius":this.height/2+"px"}),this.option.marginRight&&this.label.css("margin-right",this.contentMargin+"px"),a.core.isString(this.option.color)?this.label.addClass(a.str.format("ui-tag-{0}",this.option.color)):this.label.addClass("ui-tag-highlight"),this.label.append(this._createContent()),this.option.closable&&this.label.append(this._createCloseButton()),this.option.noBorder&&this.label.addClass("ui-tag-noborder"),this.label.data(this.fullName,this),this.element&&this.element.append(this.label)},_createContent:function(){var a=b("<span />");return a.css("margin-left",this.contentMargin+"px"),this.option.closable||a.css("margin-right",this.contentMargin+"px"),this.content=a,this.setText(this.option.text),a},_createCloseButton:function(){var a,c,d,e,f,g;return c=this.height-2*this.borderWidth,d=e=c-6,f=g=3,e<14&&(d=e=14,f=g=(c-e)/2),a=b("<i href='javascript:void(0)'>×</i>"),a.addClass("ui-tag-close"),this.height<=20&&a.css("font-size","14px"),a.css({width:d+"px",height:e+"px","line-height":e-2+"px","margin-top":f+"px","margin-left":g+"px","margin-right":g+"px"}),this.closeButton=a,a},addTo:function(b){var b=a.getJQueryElement(b);b&&b.append(this.label)},remove:function(){this.fire("close"),this.label.removeData(this.fullName),this.label.remove()},setText:function(b){this.option.text=b||"Tag",a.core.isFunction(b)?this.content.append(b.call(null)):this.content.text(b)},getText:function(){return this.option.text}}),a.ctrls.Tag.addColor=function(b,c){if(g[b])throw new TypeError("the name "+b+" is exists.");a.core.isString(c)&&c&&(g[b]=c,d(b,c))}}(ui,ui.$),function(a,b){function c(){}function d(a){return 400===a?"上传文件请求格式错误":401===a?"需要登录以后才能上传文件":403===a?"您没有上传文件的权限，请联系管理员":404===a?"上传地址不存在，请联系管理员":"上传文件发生错误"}function e(a){this._reset(),this.fire("selected",this._inputFile[0]),this.option.autoUpload&&this.upload()}var f,g,h,i=0,j=a.core.global();h=j.FormData?function(){function b(b,h,i,j,k){var l,m,n,o;f.percent=Math.floor(h/j*1e3)/10,f.fire("progressing",f.percent),l=!1,g===c?(l=!0,m=j,n=i):(m=h+f.chunkSize,n=null,m>=j&&(m=j,l=!0),n=g.call(i,h,m)),o={fileInfo:{isEnd:l,isAbort:f.isAbort,fileName:b,index:h,end:m,total:j,fileId:k||""},file:i},a.upload(f.option.url,n,o.fileInfo,function(a){e(a.data,a.ajaxRequest,o)},function(a){var b;b=a.ajaxRequest.status,d(b),f.fire()},"json")}function e(c,e,g){var h,i=e.getResponseHeader("X-Responded-JSON");if(a.str.isEmpty(i))g.isEnd?(f.percent=100,f.fire("progressing",f.percent),f.fire("uploaded",c)):(h=g.fileInfo,h.isAbort?this.fire("uploaded",h):(h.fileId=c.fileId,b(h.fileName,h.end,h.file,h.total,h.fileId)));else try{i=JSON.parse(i),d(i.status)}catch(a){i=null,d()}}var f=this;this._upload=function(){var a,d,e,f,h,i,j,k;if((a=this._inputFile[0].files)&&0!==a.length){if(d=a[0],e=d.fileName||d.name,f=0,h=d.size,!g){for(k=["slice","webkitSlice","mozSlice"],i=0;i<k.length;i++)if((j=k[i])in d){g=function(a,b){return this[j](a,b)};break}g||(g=c)}b(e,f,d,h)}}}:function(){var a=b("<div class='ui-uploader-panel' />"),c="uploadFrameId_"+this._uploaderId;this._iframe=b("<iframe class='form-upload-iframe' />"),this._iframe.prop("id",c),this._iframe.prop("name",c),this._form=b("<form />"),this._form.attr("method","post"),this._form.attr("action",this.option.url),this._form.attr("enctype","multipart/form-data"),this._form.attr("target",c),this._form.append(this._inputFile),a.append(this._iframe),a.append(this._form),b(document.body).append(a),this._iframe[0].onload=function(){var a,b,c;if(this.percent=100,this.fire("progressing",this.percent),a=this._iframe[0].contentWindow,b=a.fileInfo,c=a.error,!b&&!c)return void this.fire("error",d());c?(c=error.errorMessage||d(),this.fire("error",c)):this.fire("uploaded",b)}.bind(this),f||(f=b("<input type='text' value='' style='position:absolute;left:-99px;top:-1px;width:0;height:0;' />"),(document.body||document.documentElement).insertBefore(f[0],null)),this._upload=function(){this.percent=20,this.fire("progressing",this.percent),this._form.submit(),f.focus()}},a.ctrls.define("ui.ctrls.Uploader",{_defineOption:function(){return{url:null,autoUpload:!0,chunkSize:512,filter:"*.*"}},_defineEvents:function(){return["selected","uploading","uploaded","progressing","error"]},_create:function(){this._uploaderId=++i,this._form=null,this._inputFile=null,this.chunkSize=1024*this.option.chunkSize||524288,this.onInputFileChangeHandler=e.bind(this),this._reset()},_render:function(){this._initUploadButton(),h.call(this)},_initUploadButton:function(){var a="inputFile_"+this._uploaderId;if(this.element||(this.element=b("<label />")),"LABEL"!==this.element.nodeName())throw TypeError("the element must be label element");this.element.addClass("ui-uploader-button"),this.element.prop("for",a),this._inputFile=b("<input type='file' class='ui-uploader-input-file' value='' />"),this._inputFile.prop("id",a),this._inputFile.prop("name",this._uploaderId),this._inputFile.change(this.onInputFileChangeHandler),this.element.append(this._inputFile)},_reset:function(){this.filePath=null,this.extension=null,this.fileName=null,this.percent=0,this.isAbort=!1},checkFile:function(a){var b=a.lastIndexOf(".");return-1!==b&&(this.fileName=a.substring(a.lastIndexOf("\\")+1,b),this.extension=a.substring(b).toLowerCase().trim(),"*.*"===this.option.filter||-1!==this.option.filter.indexOf(this.extension))},upload:function(){var a=this._inputFile.val();if(0===a.length)return void this.fire("error","没有选择要上传的文件");if(!this.checkFile(a))return void this.fire("error","不支持上传当前选择的文件格式");if(!this.option.url)throw new TypeError("the upload url is null.");!1!==this.fire("uploading",a)&&(this._upload(),this._inputFile.val(""))},abort:function(){this.isAbort=!0}}),b.fn.uploader=function(b){return 0===this.length?null:a.ctrls.Uploader(b,this)}}(ui,ui.$),function(a,b){function c(a){var c,d=b(a.target),e=d.nodeName();d.hasClass("chooser-queue")||("IMG"===e&&(d=d.parent()),c=parseInt(d.attr("data-index"),10),!1!==this.fire("changing",c)&&!1!==this.selectItem(c)&&this.imageViewer.showImage(c))}a.ctrls.define("ui.ctrls.ImagePreview",{_defineOption:function(){return{chooserButtonSize:16,imageMargin:10,chooserSize:48,direction:"horizontal"}},_defineEvents:function(){return["changing","changed","ready"]},_create:function(){if(this.element.addClass("image-preview"),this.viewer=this.element.children(".image-view-panel"),this.chooser=this.element.children(".image-preview-chooser"),0===this.viewer.length)throw new TypeError("需要设置一个class为image-view-panel的元素");if(0===this.chooser.length)throw new TypeError("需要设置一个class为image-preview-chooser的元素");this.isHorizontal="horizontal"===this.option.direction,(!a.core.isNumber(this.option.chooserButtonSize)||this.option.chooserButtonSize<2)&&(this.option.chooserButtonSize=16),a.core.isNumber(this.option.chooserSize)||(this.option.chooserSize=48),this.item=[],this._onChooserItemClickHandler=c.bind(this)},_render:function(){var c,d,e;this.chooserQueue=b("<div class='chooser-queue' />"),this.chooserPrev=b("<a href='javascript:void(0)' class='chooser-button font-highlight-hover'></a>"),this.chooserNext=b("<a href='javascript:void(0)' class='chooser-button font-highlight-hover'></a>"),this.chooser.append(this.chooserPrev).append(this.chooserQueue).append(this.chooserNext),e=this,this.chooserPrev.on("click",function(a){e.beforeItems()}),this.chooserNext.on("click",function(a){e.afterItems()}),this.chooserAnimator=a.animator({target:this.chooserQueue,ease:a.AnimationStyle.easeFromTo}),c=this.option.chooserButtonSize,this.isHorizontal?(this.smallImageSize=this.option.chooserSize,this.chooser.css({height:this.smallImageSize+"px"}),this.chooserAnimator[0].onChange=function(a){this.target[0].scrollLeft=a},d={width:c+"px",height:"100%","line-height":this.smallImageSize-4+"px"},this.chooserPrev.append("<i class='far fa-angle-left'></i>").css(d),this.chooserNext.append("<i class='far fa-angle-right'></i>").css(d).css("right","0px"),this.isOverflow=function(){return this.chooserQueue[0].scrollWidth>this.chooserQueue.width()},this.showChooserButtons=function(){this.chooserPrev.css("display","block"),this.chooserNext.css("display","block"),this.chooserQueue.css({left:c+"px",width:this.chooser.width()-2*this.option.chooserButtonSize+"px"})},this.hideChooserButtons=function(){this.chooserPrev.css("display","none"),this.chooserNext.css("display","none"),this.chooserQueue.css({left:"0px",width:"100%"})}):(this.smallImageSize=this.option.chooserSize,this.chooser.css({width:this.smallImageSize+"px"}),this.chooserAnimator[0].onChange=function(a){this.target.scrollTop(a)},d={height:c+"px",width:"100%","line-height":c+"px"},this.chooserPrev.append("<i class='far fa-angle-up'></i>").css(d),this.chooserNext.append("<i class='far fa-angle-down'></i>").css(d).css("bottom","0px"),d={display:"block"},this.isOverflow=function(){return this.chooserQueue[0].scrollHeight>this.chooserQueue.height()},this.showChooserButtons=function(){this.chooserPrev.css("display","block"),this.chooserNext.css("display","block"),this.chooserQueue.css({top:c+"px",height:this.chooser.height()-2*c+"px"})},this.hideChooserButtons=function(){this.chooserPrev.css("display","none"),this.chooserNext.css("display","none"),this.chooserQueue.css({top:"0px",height:"100%"})}),this.chooserQueue.on("click",this._onChooserItemClickHandler),this.setImages(this.option.images)},_initImages:function(a){var c,d,e,f,g,h,i,j,k;for(e=0,d=this.smallImageSize-4,c=d,this.imageSource=a,f=0,g=a.length;f<g;f++)h=a[f],k=this._getImageDisplay(c,d,h.width,h.height),i=b("<div class='small-img' />"),i.attr("data-index",f),i.css({width:c+"px",height:d+"px"}),j=b("<img alt='' />"),j.css({width:k.width,height:k.height,"margin-top":k.top,"margin-left":k.left}),j.prop("src",h.src),i.append(j),this.chooserQueue.append(i),this.isHorizontal?(i.css("left",e+"px"),e+=this.option.imageMargin+c):(i.css("top",e+"px"),e+=this.option.imageMargin+d),this.items.push(i);this.isOverflow()?this.showChooserButtons():this.hideChooserButtons(),this.imageViewer.currentIndex>=0&&(this.selectItem(this.imageViewer.currentIndex),this.fire("changed",this.imageViewer.currentIndex))},_getImageDisplay:function(b,c,d,e){var f={width:b,height:c,originalWidth:d,originalHeight:e};return a.ImageLoader.centerCrop.call(f),{width:f.displayWidth+"px",height:f.displayHeight+"px",top:f.marginTop+"px",left:f.marginLeft+"px"}},selectItem:function(a){var b=this.items[a];if(this.currentChooser){if(this.currentChooser[0]===b[0])return!1;this.currentChooser.removeClass("chooser-selected").removeClass("border-highlight")}this.currentChooser=b,this.currentChooser.addClass("chooser-selected").addClass("border-highlight"),this.isOverflow()&&this._moveChooserQueue(a)},clear:function(){this.items=[],this.chooserQueue.empty(),this.imageViewer&&this.imageViewer.clear()},setImages:function(a){var b;Array.isArray(a)&&0!==a.length&&(this.clear(),this.option.images=a,this.imageViewer?this.imageViewer.setImages(a):(this.imageViewer=this.viewer.imageViewer(this.option),b=this,this.imageViewer.ready(function(a,c){b._initImages(c),b.fire("ready")}),this.imageViewer.changed(function(a,c){b.selectItem(c),b.fire("changed",c)})))},_caculateScrollValue:function(a){var b,c,d,e;return this.isHorizontal?(d=this.chooserQueue.width(),b=this.chooserQueue[0].scrollLeft,e=this.chooserQueue[0].scrollWidth):(d=this.chooserQueue.height(),b=this.chooserQueue.scrollTop(),e=this.chooserQueue[0].scrollHeight),c=a.call(this,d,b),c<0?c=0:c>e-d&&(c=e-d),{from:b,to:c}},_moveChooserQueue:function(a){var b=this._caculateScrollValue(function(b,c){var d=this.smallImageSize+this.option.imageMargin,e=Math.floor(b/d),f=Math.floor(e/2),g=a-f;return g<0?0:g+e>this.items.length-1?this.items.length*d:g*d});this._setScrollValue(b)},_setScrollValue:function(a){var b;isNaN(a.to)||(this.chooserAnimator.stop(),b=this.chooserAnimator[0],Math.abs(a.from-a.to)<this.smallImageSize?b.onChange.call(b,a.to):(b.begin=a.from,b.end=a.to,this.chooserAnimator.start()))},beforeItems:function(){var a=this._caculateScrollValue(function(a,b){var c=this.smallImageSize+this.option.imageMargin,d=Math.floor(a/c);return(Math.floor(b/c)+-1*d)*c});this._setScrollValue(a)},afterItems:function(){var a=this._caculateScrollValue(function(a,b){var c=this.smallImageSize+this.option.imageMargin,d=Math.floor(a/c);return(Math.floor(b/c)+d)*c});this._setScrollValue(a)}}),b.fn.imagePreview=function(b){if(0!==this.length)return a.ctrls.ImagePreview(b,this)}}(ui,ui.$),function(a,b){a.ctrls.define("ui.ctrls.ImageViewer",{_defineOption:function(){return{hasSwitchButtom:!1,interval:2e3,direction:"horizontal",images:[]}},_defineEvents:function(){return["changed","ready"]},_create:function(){Array.isArray(this.option.images)||(this.option.images=[]),!a.core.isNumber(this.option.interval)||this.option.interval<=0?this.isAutoView=!1:this.isAutoView=!0,this.stopAutoView=!1,this.currentIndex=-1,this.images=[],this.isHorizontal="horizontal"===this.option.direction,this.animationCssItem=this.isHorizontal?"left":"top"},_render:function(){var a=this;this.element.addClass("image-view-panel"),this.currentView=null,this.nextView=null,this._initAnimator(),this._loadImages(this.option.images),this.isAutoView&&(this.element.mouseenter(function(b){a.stopAutoView=!0,a._autoViewHandler&&clearTimeout(a._autoViewHandler)}),this.element.mouseleave(function(b){a.stopAutoView=!1,a._autoViewHandler=setTimeout(function(){a.next()},a.option.interval)}))},_initAnimator:function(){var b=this;this.viewAnimator=a.animator({ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css(b.animationCssItem,a+"px")}}).add({ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css(b.animationCssItem,a+"px")}}),this.viewAnimator.onEnd=function(){b.currentView.css("display","none"),b.currentView=b.nextView,b.nextView=null,b.isAutoView&&!b.stopAutoView&&(b._autoViewHandler=setTimeout(function(){b.next()},b.option.interval)),b.fire("changed",b.currentIndex,b.images[b.currentIndex])},this.viewAnimator.duration=500},setImages:function(){if(0!==arguments.length){this.clear();for(var b=[],c=0,d=arguments.length,e=null;c<d;c++)e=arguments[c],Array.isArray(e)?b=b.concat(e):"string"===a.core.type(e)&&b.push(e);this._loadImages(b)}},_loadImages:function(a){if(0!==a.length){
!0===this.option.hasSwitchButtom&&(this.prevBtn=b("<a href='javascript:void(0)' class='image-switch-button switch-button-prev font-highlight-hover'><i class='far fa-angle-left'></i></a>"),this.nextBtn=b("<a href='javascript:void(0)' class='image-switch-button switch-button-next font-highlight-hover'><i class='far fa-angle-right'></i></a>"),this.prevBtn.on("click",function(a){this.prev()}.bind(this)),this.nextBtn.on("click",function(a){this.next()}.bind(this)),this.element.append(this.prevBtn).append(this.nextBtn));for(var c=[],d=0,e=this;d<a.length;d++)c.push(this._loadImage(a[d]));Promise.all(c).then(function(a){for(var c,d=0,f=a.length;d<f;d++)(c=a[d])&&(c.view=b("<div class='image-view' />"),c.view.append("<img src='"+c.src+"' alt='' />"),e.element.append(c.view),e.images.push(c));e.images.length>0&&e.showImage(0),e.fire("ready",e.images)})}},_loadImage:function(b){if("string"===a.core.type(b)&&0!==b.length){return new Promise(function(a,c){var d=new Image;d.onload=function(){d.onload=null,a({src:b,width:d.width,height:d.height})},d.onerror=function(){a(null)},d.src=b})}},_startView:function(a){this.viewAnimator.stop();var b,c=this.element.width(),d=this.element.height(),e=this.isHorizontal?c:d;b=this.viewAnimator[0],b.target=this.currentView,b.begin=parseFloat(b.target.css(this.animationCssItem)),b.end=a?-e:e,b=this.viewAnimator[1],b.target=this.nextView,b.begin=parseFloat(b.target.css(this.animationCssItem)),b.end=0,this.viewAnimator.start()},_setImage:function(a,b){var c,d,e=this.images[a],f=this.element.width(),g=this.element.height(),h=null;b=b||this.currentView,h=b.children("img"),f>g?(d=g,c=Math.floor(e.width*(d/e.height)),c>f?(c=f,d=Math.floor(e.height*(c/e.width)),h.css("top",Math.floor((g-d)/2)+"px")):h.css("left",Math.floor((f-c)/2)+"px")):(c=f,d=Math.floor(e.height*(c/e.width)),d>g?(d=g,c=Math.floor(e.width*(d/e.height)),h.css("left",Math.floor((f-c)/2)+"px")):h.css("top",Math.floor((g-d)/2)+"px")),h.css({width:c+"px",height:d+"px"})},showImage:function(a){if(0!==this.images.length){this._autoViewHandler&&clearTimeout(this._autoViewHandler);var b,c=this.element.width(),d=this.element.height(),e=this,f={display:"block"},g=this.isHorizontal?c:d;if(this.element.css("overflow","hidden"),this.currentIndex<0)return this.currentIndex=a,this.currentView=this.images[this.currentIndex].view,this._setImage(a),this.currentView.css("display","block"),void(this.isAutoView&&(this._autoViewHandler=setTimeout(function(){e.next()},this.option.interval)));this.nextView&&(this.currentView.css("display","none").css(this.animationCssItem,-g+"px"),this.currentView=this.nextView,this.currentView.css(this.animationCssItem,"0px")),a>this.currentIndex?(a>=this.images.length&&(a=0),f[this.animationCssItem]=g+"px",b=!0):(a<0&&(a=this.images.length-1),f[this.animationCssItem]=-g+"px",b=!1),this.nextView=this.images[a].view,this.nextView.css(f),this._setImage(a,this.nextView),this.currentIndex=a,this._startView(b)}},prev:function(){this.currentIndex>=0?this.showImage(this.currentIndex-1):this.showImage(0)},next:function(){this.currentIndex>=0?this.showImage(this.currentIndex+1):this.showImage(0)},clear:function(){this.images=[],this.currentIndex=-1,this.viewAnimator.stop(),clearTimeout(this._autoViewHandler),this.element.empty(),this.prevBtn=null,this.nextBtn=null,this.currentView=null,this.nextView=null}}),b.fn.imageViewer=function(b){if(0!==this.length)return a.ctrls.ImageViewer(b,this)}}(ui,ui.$),function(a,b){a.ctrls.define("ui.ctrls.ImageWatcher",{_defineOption:function(){return{position:"right",zoomWidth:null,zoomHeight:null}},_create:function(){this.borderWidth=1,this.viewMargin=10,this.option.position=this.option.position.toLowerCase(),this.zoomWidth=this.option.zoomWidth,this.zoomHeight=this.option.zoomHeight,this.element.addClass("image-watch-panel"),this.focusView=b("<div class='focus-view border-highlight' />"),this.zoomView=b("<div class='zoom-view border-highlight' />"),this.zoomImage=b("<img alt='' />"),this.zoomView.append(this.zoomImage),this.element.append(this.focusView).append(this.zoomView)},_render:function(){this._initImage(),this._initZoomer()},_initImage:function(){if(this.image=b(this.element.children("img")[0]),0===this.image.length)throw new Error("元素中没有图片，无法使用图片局部查看器");this.imageOffsetWidth=this.image.width(),this.imageOffsetHeight=this.image.height(),this.image.css({width:"auto",height:"auto"}),this.imageWidth=this.image.width(),this.imageHeight=this.image.height(),this.image.css({width:this.imageOffsetWidth+"px",height:this.imageOffsetHeight+"px"}),this.zoomImage.prop("src",this.image.prop("src"))},_initZoomer:function(){var b=this;a.core.isNumber(this.option.zoomHeight)||(this.zoomHeight=this.element.height()),a.core.isNumber(this.option.zoomWidth)||(this.zoomWidth=this.zoomHeight),this.zoomView.css({width:this.zoomWidth-2*this.borderWidth+"px",height:this.zoomHeight-2*this.borderWidth+"px"}),this.element.mouseenter(function(a){b.start=!0,b._setFocusView(a),b._setZoomView()}).mousemove(function(a){b.start&&(b._setFocusView(a),b._setZoomView())}).mouseleave(function(a){b.start=!1,b.focusView.css("display","none"),b.zoomView.css("display","none")})},_setFocusView:function(a){var b,c,d=this.image.offset(),e=a.clientX-d.left,f=a.clientY-d.top,g=this.imageOffsetWidth/this.imageWidth,h=this.zoomWidth*g,i=this.zoomHeight*g,j=this.element.offset(),k=d.top-j.top,l=d.left-j.left;if(e<0||e>this.imageOffsetWidth||f<0||f>this.imageOffsetHeight)return void this.focusView.css("display","none");c=e+l-h/2,c<l?c=l:c+h>this.imageOffsetWidth+l&&(c=this.imageOffsetWidth+l-h),b=f+k-i/2,b<k?b=k:b+i>this.imageOffsetHeight+k&&(b=this.imageOffsetHeight+k-i),this.focusView.css({display:"block",width:h-2*this.borderWidth+"px",height:i-2*this.borderWidth+"px",top:b+"px",left:c+"px"}),this.topRatio=(b-k)/this.imageOffsetHeight,this.leftRatio=(c-l)/this.imageOffsetWidth},_setZoomView:function(){var a,b,c;if("none"===this.focusView.css("display"))return void this.zoomView.css("display","none");c=this.element.getBoundingClientRect(),"top"===this.option.position?(b=0,a=-(this.zoomHeight+this.viewMargin)):"bottom"===this.option.position?(b=0,a=c.height+this.viewMargin):"left"===this.option.position?(b=-(this.zoomWidth+this.viewMargin),a=0):(b=c.width+this.viewMargin,a=0),this.zoomView.css({display:"block",top:a+"px",left:b+"px"}),this.zoomImage.css({top:-this.imageHeight*this.topRatio+"px",left:-this.imageWidth*this.leftRatio+"px"})}}),b.fn.imageWatcher=function(b){if(0!==this.length)return a.ctrls.ImageWatcher(b,this)}}(ui,ui.$),function(a,b){function c(a){var b=a.attr("data-large-src");return b||(b=a.prop("src")),b}function d(a){return new Promise(function(b,c){var d=new Image,e={src:a,width:-1,height:-1};d.onload=function(){d.onload=null,e.width=d.width,e.height=d.height,b(e)},d.onerror=function(){c(e)},d.src=a})}a.ctrls.define("ui.ctrls.ImageZoomer",{_defineOption:function(){return{parentContent:b(document.body),getNext:null,getPrev:null,hasNext:null,hasPrev:null,getLargeImageSrc:null}},_defineEvents:function(){return["hided"]},_create:function(){var d=this;this.parentContent=this.option.parentContent,this.closeButton=null,this.mask=null,this.width=null,this.height=null,this.target=null,this.targetTop=null,this.targetLeft=null,b.isFunction(this.option.getLargeImageSrc)?this._getLargeImageSrc=this.option.getLargeImageSrc:this._getLargeImageSrc=c,this._isKeydownEnabled=!1,["getNext","getPrev","hasNext","hasPrev"].forEach(function(b){var c=d.option[b];a.core.isFunction(c)?d.option[b]=c.bind(d):d.option[b]=null})},_render:function(){var c=this;this.imagePanel=b("<div class='show-image-panel' />"),this.currentView=b("<div class='image-view-panel' style='display:none;' />"),this.nextView=b("<div class='image-view-panel' style='display:none;' />"),this.currentView.append("<img class='image-view-img' />"),this.nextView.append("<img class='image-view-img' />"),this.closeButton=b("<a class='closable-button font-highlight-hover' href='javascript:void(0)'>×</a>"),this.closeButton.on("click",function(){c.hide()}),this.imagePanel.append(this.currentView).append(this.nextView).append(this.closeButton),this.option.getNext&&(this.nextButton=b("<a class='next-button font-highlight-hover disabled-button' style='right:10px;' href='javascript:void(0)'><i class='far fa-angle-right'></i></a>"),this.nextButton.on("click",function(a){c._doNextView()}),this.imagePanel.append(this.nextButton)),this.option.getPrev&&(this.prevButton=b("<a class='prev-button font-highlight-hover disabled-button' style='left:10px;' href='javascript:void(0)'><i class='far fa-angle-left'></i></a>"),this.prevButton.on("click",function(a){c._doPrevView()}),this.imagePanel.append(this.prevButton)),b(document.body).append(this.imagePanel),a.page.resize(function(a){c.resizeZoomImage()},a.eventPriority.ctrlResize),b(document).keydown(function(b){c._isKeydownEnabled&&(b.which===a.keyCode.LEFT?c._doPrevView():b.which===a.keyCode.RIGHT?c._doNextView():b.which===a.keyCode.ESCAPE&&c.hide())}),this.zoomAnimator=a.animator({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("top",a+"px")}}).add({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("left",a+"px")}}).add({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("width",a+"px")}}).add({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("height",a+"px")}}),this.zoomAnimator.duration=300,(this.prevButton||this.nextButton)&&(this.changeViewAnimator=a.animator({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("left",a+"px")}}).add({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("left",a+"px")}}))},_showOptionButtons:function(){this.prevButton&&this.prevButton.removeClass("disabled-button"),this.nextButton&&this.nextButton.removeClass("disabled-button")},_hideOptionButtons:function(){this.prevButton&&this.prevButton.addClass("disabled-button"),this.nextButton&&this.nextButton.addClass("disabled-button")},_updateButtonState:function(){this.option.hasNext&&(this.option.hasNext()?this.nextButton.removeClass("disabled-button"):this.nextButton.addClass("disabled-button")),this.option.hasPrev&&(this.option.hasPrev()?this.prevButton.removeClass("disabled-button"):this.prevButton.addClass("disabled-button"))},show:function(b){var c,d,e,f,g,h;this.target=b;var i=this._setImageSize();i&&(d={width:this.target.width(),height:this.target.height()},this._isKeydownEnabled=!0,c=this.currentView.children("img"),c.prop("src",this.target.prop("src")),c.css({width:d.width+"px",height:d.height+"px",left:this.targetLeft+"px",top:this.targetTop+"px"}),this.imagePanel.css({display:"block",width:i.parentW+"px",height:i.parentH+"px",left:i.parentLoc.left+"px",top:i.parentLoc.top+"px"}),this.currentView.css("display","block"),g=(i.parentW-this.width)/2,h=(i.parentH-this.height)/2,e=this,a.mask.open({opacity:.8}),f=this.zoomAnimator[0],f.target=c,f.begin=this.targetTop,f.end=h,f=this.zoomAnimator[1],f.target=c,f.begin=this.targetLeft,f.end=g,f=this.zoomAnimator[2],f.target=c,f.begin=d.width,f.end=this.width,f=this.zoomAnimator[3],f.target=c,f.begin=d.height,f.end=this.height,this.zoomAnimator.start().then(function(){e._updateButtonState()}))},hide:function(){var b,c=this,d=this.currentView.children("img");this.target.width(),this.target.height(),this._isKeydownEnabled=!1,a.mask.close(),b=this.zoomAnimator[0],b.target=d,b.begin=parseFloat(d.css("top")),b.end=this.targetTop,b=this.zoomAnimator[1],b.target=d,b.begin=parseFloat(d.css("left")),b.end=this.targetLeft,b=this.zoomAnimator[2],b.target=d,b.begin=parseFloat(d.css("width")),b.end=this.target.width(),b=this.zoomAnimator[3],b.target=d,b.begin=parseFloat(d.css("height")),b.end=this.target.height(),this.zoomAnimator.start().then(function(){c._hideOptionButtons(),c.imagePanel.css("display","none"),c.currentView.css("display","none"),c.fire("hided",c.target)})},_doNextView:function(){var a;this.changeViewAnimator.isStarted||(a=this.option.getNext())&&this._doChangeView(a,function(){this.target=a,this._updateButtonState(),this._changeView(-this.parentContent.width())})},_doPrevView:function(){var a;this.changeViewAnimator.isStarted||(a=this.option.getPrev())&&this._doChangeView(a,function(){this.target=a,this._updateButtonState(),this._changeView(this.parentContent.width())})},_doChangeView:function(a,b){var c=a.data("LargeSize"),e=this;c?b.call(this):d(this._getLargeImageSrc(a)).then(function(c){a.data("LargeSize",c),b.call(e)},function(a){b.call(e)})},_changeView:function(a){var b,c,d,e,f,g;b=this.currentView,this.currentView=this.nextView,this.nextView=b,c=this._getLargeImageSrc(this.target),(d=this._setImageSize())&&(e=this.currentView.children("img"),e.prop("src",c),e.css({left:(d.parentW-this.width)/2+"px",top:(d.parentH-this.height)/2+"px",width:this.width+"px",height:this.height+"px"}),this.currentView.css("display","block"),this.currentView.css("left",-a+"px"),f=this.changeViewAnimator[0],f.target=this.nextView,f.begin=0,f.end=a,f=this.changeViewAnimator[1],f.target=this.currentView,f.begin=-a,f.end=0,g=this,this.changeViewAnimator.start().then(function(){g.nextView.css("display","none")}))},resizeZoomImage:function(){var a,b,c,d;(a=this._setImageSize())&&(b=(a.parentW-this.width)/2,c=(a.parentH-this.height)/2,this.imagePanel.css({width:a.parentW+"px",height:a.parentH+"px"}),d=this.currentView.children("img"),d.css({left:b+"px",top:c+"px",width:this.width+"px",height:this.height+"px"}))},_getActualSize:function(a){var b,c,d,e=a.data("LargeSize");return e||(b={w:a.width(),h:a.height()},a.css({width:"auto",height:"auto"}),c=a.width(),d=a.height(),a.css({width:b.w+"px",height:b.h+"px"}),e={width:c,height:d}),e},_setImageSize:function(){var a,b,c,d,e,f,g;if(this.currentView&&this.target)return this.currentView.children("img"),this.zoomAnimator.stop(),a=this._getActualSize(this.target),c=this.parentContent.height(),b=this.parentContent.width(),d=a.width,e=a.height,d/b<e/c?(this.height=e>=c?c:e,this.width=Math.floor(d*(this.height/e))):(this.width=d>=b?b:e,this.height=Math.floor(e*(this.width/d))),f=this.target.offset(),g=this.parentContent.offset(),this.targetTop=f.top-g.top,this.targetLeft=f.left-g.left,{parentW:b,parentH:c,parentLoc:g}}}),b.fn.addImageZoomer=function(c){0!==this.length&&c instanceof a.ctrls.ImageZoomer&&this.on("click",function(a){var e=b(a.target);e.data("LargeSize")?c.show(e):d(c._getLargeImageSrc(e)).then(function(a){e.data("LargeSize",a),c.show(e)},function(a){c.show(e)})})}}(ui,ui.$),function(a,b){function c(a){var c,d,e,f,g;for(a.stopPropagation(),c=b(a.target);"DT"!==(d=c.nodeName());){if("DL"===d||"A"===d)return;c=c.parent()}if(e=function(){var a;this._currentMenu=c,this._currentMenu.addClass(h).addClass(i),(a=this._getSubmenuElement())&&(a.addClass(h).addClass(i),this.subShow(a,this.hasAnimation()))}.bind(this),f=function(){var a;this._currentMenu.removeClass(h).removeClass(i),a=this._getSubmenuElement(),a.removeClass(h).removeClass(i),a.css("display","none"),this._currentMenu[0]!==c[0]?(this._currentMenu=null,e()):this._currentMenu=null}.bind(this),this._currentMenu){if(g=this._getSubmenuElement())return void this.subHide(g,this.hasAnimation(),f);this._currentMenu.removeClass(h).removeClass(i)}e()}function d(a){var c,d,e,f,g;for(a.stopPropagation(),c=b(a.target);"DT"!==(d=c.nodeName());){if("DL"===d||"A"===d)return;c=c.parent()}e=c.next(),0!==e.length&&"DD"===e.nodeName()&&(f=function(){var a;this._currentMenu=c,this._currentMenu.addClass(h).addClass(i),a=this._getSubmenuElement(),a.addClass(h).addClass(i),this.subShow(a,this.hasAnimation())}.bind(this),g=function(){var a;this._currentMenu.removeClass(h).removeClass(i),a=this._getSubmenuElement(),a.removeClass(h).removeClass(i),a.css("display","none"),this._currentMenu=null}.bind(this),this._currentMenu?this._currentMenu[0]===c[0]?this.subHide(this._getSubmenuElement(),this.hasAnimation(),g):(this._currentMenu.removeClass(h).removeClass(i),this._currentMenu=null,f()):f())}var e,f,g="ui-menu-button-show",h="current-menu",i="head-color";e={show:function(a){var b,c,d,e;return!1===a?(this.resize(),void this._fireResize()):(b=this.menuPanelAnimator,b.stop(),c=b[0],(d=parseInt(c.target.css("left"),10))>=0?void c.target.css("left","0px"):(c.begin=d,c.end=0,b.length>1&&(c=b[1],c.begin=parseInt(c.target.css("left"),10),c.end=this.menuWidth,c=b[2],c.begin=parseInt(c.target.css("width"),10),c.end=document.documentElement.clientWidth-this.menuWidth),e=this,void b.start().then(function(){e.hideState=!1,1===b.length&&e.fire("shown")})))},hide:function(a){var b,c,d,e;return!1===a?(this.resize(),void this._fireResize()):(b=this.menuPanelAnimator,b.stop(),c=b[0],(d=parseInt(c.target.css("left"),10))<=-this.menuWidth?void c.target.css("left",-this.menuWidth+"px"):(b[0].begin=d,b[0].end=-this.menuWidth,b.length>1&&(c=b[1],c.begin=parseInt(c.target.css("left"),10),c.end=0,c=b[2],c.begin=parseInt(c.target.css("width"),10),c.end=document.documentElement.clientWidth),e=this,void b.start().then(function(){e.hideState=!0,1===b.length&&e.fire("hidden")})))},subShow:function(b,c){var d,e,f,g,h,i;if(e=b.children("ul"),0!==(f=e.children().length))return d=30*f,b.prev().find(".allow").removeClass("fa-angle-down").addClass("fa-angle-up"),!1===c?(b.css({display:"block",height:d+"px"}),void e.css("top","0px")):(g=this.submenuAnimator,g.stop(),g.duration=360,h=g[0],h.target=b,h.begin=b.height(),h.end=d,h.ease=a.AnimationStyle.easeTo,h.target.css("display","block"),i=h.end-h.begin,h=g[1],h.target=e,h.begin=-i,h.end=0,h.ease=a.AnimationStyle.easeTo,h.target.css("top",-i+"px"),g.onEnd=null,g.start())},subHide:function(b,c,d){var e,f,g,h;return b.prev().find(".allow").removeClass("fa-angle-up").addClass("fa-angle-down"),e=b.children("ul"),f=30*e.children().length,a.core.isFunction(c)&&(d=c,c=void 0),!1===c?(b.css({display:"none",height:"0px"}),e.css("top",-f),void(a.core.isFunction(d)&&d())):(g=this.submenuAnimator,g.stop(),h=g[0],h.target=b,g.duration=360,h.begin=b.height(),h.end=0,h.ease=a.AnimationStyle.easeFrom,h=g[1],h.target=e,h.begin=parseFloat(h.target.css("top")),h.end=-f,h.ease=a.AnimationStyle.easeFrom,g.onEnd=d,g.start())},resize:function(a,b){this.isShow()?(this.isExtrusion()&&(a||(a=document.documentElement.clientWidth),this.option.contentContainer.css({width:a-this.menuWidth+"px",left:this.menuWidth+"px"})),this.option.menuPanel.css("left","0"),this.fire("shown")):(this.isExtrusion()&&this.option.contentContainer.css({width:"100%",left:"0"}),this.option.menuPanel.css({left:-this.menuWidth+"px"}),this.fire("hidden"))}},f={show:function(a){var b;this.onMenuItemClickHandler=this.onMenuItemNormalClickHandler,this._currentMenu&&(this.submenuPanel.removeClass(h).removeClass(i),this.submenuPanel.css("display","none"),this.submenuList.html(""),(b=this._getSubmenuElement(!1))&&(b.addClass(h).addClass(i),e.subShow.call(this,b,!1))),this._updateStatusToSrc(!1),this.resize(),this._fireResize()},hide:function(a){var b;this.onMenuItemClickHandler=this.onMenuItemModernClickHandler,this._currentMenu&&(b=this._getSubmenuElement(!1),b&&e.subHide.call(this,b,!1,function(){b.removeClass(h).removeClass(i),b.css("display","none")}),this._currentMenu.removeClass(h).removeClass(i),this._currentMenu=null),this._updateStatusToSrc(!0),this.resize(),this._fireResize()},subShow:function(a,b){var c,d,f;if(this.isShow())e.subShow.apply(this,arguments);else{if(!1===b)return this._setSubmenuList(),void this.submenuPanel.css("display","block");if(c=this.submenuPanelAnimator,c.isStarted)return;c.onEnd=null,f=function(){var a;this.submenuList.css("display","none"),this._setSubmenuList(),a=this,setTimeout(function(){var b;a.submenuList.css({display:"block",left:-a.menuWidth+"px"}),b=a.submenuListAnimator[0],b.begin=-a.menuWidth,b.end=0,a.submenuListAnimator.start()})}.bind(this),"none"===a.css("display")?(d=c[0],d.begin=-(this.menuWidth-this.menuNarrowWidth)+this.menuNarrowWidth,d.end=this.menuNarrowWidth,d.target.css("display","block"),c.onEnd=f,c.start()):f()}},subHide:function(a,b,c){var d,f,g;if(this.isShow())e.subHide.apply(this,arguments);else{if(!1===b)return this.submenuPanel.css("display","none"),c(),void this.submenuList.html("");if(d=this.submenuPanelAnimator,d.isStarted)return;f=d[0],f.begin=this.menuNarrowWidth,f.end=-(this.menuWidth-this.menuNarrowWidth),g=this,d.onEnd=c,d.start().then(function(){g.submenuList.html("")})}},resize:function(a,b){a||(a=document.documentElement.clientWidth-this.menuNarrowWidth),this.isShow()?(this.isExtrusion()&&this.option.contentContainer.css({width:a-(this.menuWidth-this.menuNarrowWidth)+"px",left:this.menuWidth+"px"}),this.option.menuPanel.removeClass("ui-menu-panel-narrow"),this.option.menuPanel.css("width",this.menuWidth+"px"),this.fire("shown")):(this.isExtrusion()&&this.option.contentContainer.css({width:a+(this.menuWidth-this.menuNarrowWidth)+"px",left:this.menuNarrowWidth+"px"}),this.option.menuPanel.addClass("ui-menu-panel-narrow"),this.option.menuPanel.css("width",this.menuNarrowWidth+"px"),this.fire("hidden"))},_setSubmenuList:function(){var a,b,c,d,e;if(a=this._getSubmenuElement(!1)){for(b=[],e=a.children().children(),c=0,d=e.length;c<d;c++)b.push(e[c].outerHTML);this.submenuList.html(b.join(""))}}},a.ctrls.define("ui.ctrls.Menu",{_defineOption:function(){return{style:"normal",urlPrefix:"",menuPanel:null,contentContainer:null,extendMethod:"extrusion",menuButton:null,defaultShow:!1,animation:!0}},_defineEvents:function(){return["shown","hidden"]},_create:function(){var a,g;this.menuWidth=240,this.menuNarrowWidth=48,this._menuButtonBg=null,this.hasMenuButton=this.option.menuButton&&this.option.menuButton.length,this.hasMenuButton&&(this._menuButtonBg=b("<b class='menu-button-background title-color'></b>"),this.option.menuButton.addClass("ui-menu-button"),this.option.menuButton.append(this._menuButtonBg),this.option.menuButton.append("<b class='menu-inner-line a'></b>").append("<b class='menu-inner-line b'></b>").append("<b class='menu-inner-line c'></b>")),"modern"!==this.option.style&&(this.option.style="normal"),this.isModern()?(a=f,this.hamburgButton="modern-hamburg",this.hamburgCloseButton="modern-hamburg-close",this._initSubmenuPanel()):(a=e,this.hamburgButton="normal-hamburg",this.hamburgCloseButton="normal-hamburg-close");for(g in a)a.hasOwnProperty(g)&&(this[g]=a[g]);this.hasAnimation()&&(this._initMenuPanelAnimator(),this._initSubmenuAnimator()),this.onMenuItemNormalClickHandler=c.bind(this),this.onMenuItemModernClickHandler=d.bind(this),this.onMenuItemClickHandler=this.onMenuItemNormalClickHandler},_render:function(){this.menuList=b("<dl class='menu-list title-color' />"),this.option.menuPanel.addClass("title-color"),this.option.menuPanel.css("width",this.menuWidth+"px"),this.option.menuPanel.append(this.menuList),this.hasMenuButton&&this.option.menuButton.addClass(this.hamburgButton),this._initMenuList(),this.defaultShow()?this.hasMenuButton&&this.option.menuButton.addClass(g).addClass(this.hamburgCloseButton):this.hide(!1)},_initMenuPanelAnimator:function(){var b=this;this.menuPanelAnimator=a.animator({target:this.option.menuPanel,ease:a.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"px")}}),this.isExtrusion()&&this.menuPanelAnimator.add({target:this.option.contentContainer,ease:a.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"px")}}).add({target:this.option.contentContainer,ease:a.AnimationStyle.easeTo,onChange:function(a,c){c.css("width",a+"px"),mp.contentBodyWidth=a,b._fireResize()}}),this.menuPanelAnimator.duration=300},_initSubmenuAnimator:function(){this.submenuAnimator=a.animator({onChange:function(a,b){b.css("height",parseInt(a,10)+"px")}}).add({onChange:function(a,b){b.css("top",parseInt(a,10)+"px")}})},_initSubmenuPanel:function(){this.submenuPanel=b("<div class='submenu-slide-panel' />"),this.submenuPanel.css({left:this.menuNarrowWidth+"px",width:this.menuWidth-this.menuNarrowWidth+"px"}),this.submenuPanel.addClass("title-color"),this.submenuList=b("<ul class='submenu-list' />"),this.submenuPanel.append("<b class='submenu-background'></b>"),this.submenuPanel.append(this.submenuList),this.option.menuPanel.prepend(this.submenuPanel),this.hasAnimation()&&this._initSubmenuPanelAnimator()},_initSubmenuPanelAnimator:function(){this.submenuPanelAnimator=a.animator({target:this.submenuPanel,ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a)}}),this.submenuPanelAnimator.duration=200,this.submenuListAnimator=a.animator({target:this.submenuList,ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}}),this.submenuListAnimator.duration=100},_initMenuList:function(){var a,b;this._updateMenuSelectedStatus(),b=this,this.menuList.on("click",function(a){b.onMenuItemClickHandler(a)}),this.hasMenuButton&&(a=this.option.menuButton,a.on("click",function(c){a.hasClass(g)?(a.removeClass(g).removeClass(b.hamburgCloseButton),b.hide(b.hasAnimation())):(a.addClass(g).addClass(b.hamburgCloseButton),b.show(b.hasAnimation()))}))},_updateMenuSelectedStatus:function(){var a;this._currentMenu=this.option.menuPanel.find("dt."+h),0===this._currentMenu.length&&(this._currentMenu=null),this._isCloseStatus()?(this.option.menuButton.removeClass(g).removeClass(this.hamburgCloseButton),this.hide(!1)):this._currentMenu&&(a=this._currentMenu.next(),"DD"===a.nodeName()&&this.subShow(a,!1))},_getSubmenuElement:function(b){var c;return a.core.isBoolean(b)||(b=!this.isShow()),this.isModern()&&b?c=this.submenuPanel:(c=this._currentMenu.next(),0!==c.lenght&&"DD"===c.nodeName()||(c=null)),c},_fireResize:function(){this.disableResizeable=!0,a.page.fire("resize"),this.disableResizeable=!1},_parentCode:function(a){var b;return a?(b=a.lastIndexOf("_"),b<0?null:a.substring(0,b)):null},_getUrl:function(b){var c,d=/^(http|https):\/\/\w*/i;return a.str.isEmpty(b)?"":0===b.indexOf("javascript:")?b:(c=d.test(b)?b:""+b,this.option.urlPrefix+c)},_addMenuCodeToSrc:function(b,c){var d=this._getUrl(b);return 0===d.indexOf("javascript:")?d:a.str.isEmpty(d)?"javascript:void(0)":(a.str.isEmpty(c)||(d.indexOf("?")>-1?d+="&_m="+a.str.base64Encode(c):d+="?_m="+a.str.base64Encode(c)),d)},_updateStatusToSrc:function(a){var c,d,e,f,g,h,i;for(i=a?this._addMenuStatus:this._removeMenuStatus,c=this.option.menuPanel.children(".menu-list").children(".menu-item"),d=0,e=c.length;d<e;d++)if(f=b(c[d]),"DD"===f.next().nodeName())for(d++,h=f.next().children().children(),g=0;g<h.length;g++)i.call(this,b(h[g]).children(".menu-item-container").children("a"));else i.call(this,f.children(".menu-item-container").children("a"))},_addMenuStatus:function(a){var b,c;b=this._getUrl(a.attr("href")),0!==b.indexOf("javascript:")&&(c=b.indexOf("?"),b+=-1==c?"?_s=close":"&_s=close",a.attr("href",b))},_removeMenuStatus:function(a){var b,c,d,e;if(b=this._getUrl(a.attr("href")),0!==b.indexOf("javascript:")&&(c=b.split("?"),1!==c.length)){d=c[1].split("&");for(var f=0,g=d.length;f<g;f++)if((e=d[f])&&0===e.indexOf("_s=")){d.splice(f,1);break}a.attr("href",c[0]+"?"+d.join("&"))}},_isCloseStatus:function(){return"close"===a.url.getLocationParam("_s")},setMenuList:function(b,c,d){var e,f,g,h,j,k,l;if(this.menuList.empty(),Array.isArray(b)&&0!==b.length){for(e=[],a.str.isEmpty(c)&&(c=a.url.getLocationParam("_m"),c=a.str.base64Decode(c)),a.str.isEmpty(d)&&(d=this._parentCode(c)),j=0,k=b.length;j<k;j++)if(f=b[j],h=a.str.isEmpty(d)?f.resourceCode===c?" current-menu "+i+" selection-menu":"":f.resourceCode===d?" current-menu "+i:"",e.push("<dt class='menu-item",h,"'>"),e.push("<b class='menu-item-background'><b class='menu-item-color'></b></b>"),e.push("<u class='menu-item-container'>"),e.push("<i class='icon'>"),e.push("<img class='icon-img' src='",f.icon?this.option.urlPrefix+f.icon:"","' />"),e.push("</i>"),e.push("<span class='menu-item-text'>",f.resourceName,"</span>"),Array.isArray(f.children)&&0!==f.children.length?e.push("<i class='allow far fa-angle-down'></i>"):e.push("<a class='direct' href='",this._addMenuCodeToSrc(f.url,f.resourceCode),"'></a>"),e.push("</u></dt>"),Array.isArray(f.children)&&f.children.length>0){for(e.push("<dd class='submenu-panel",h,"'>"),e.push("<ul class='submenu-list'>"),l=0;l<f.children.length;l++)g=f.children[l],h=g.resourceCode===c?" selection-menu":"",e.push("<li class='submenu-item",h,"'>"),e.push("<b class='menu-item-background'><b class='menu-item-color'></b></b>"),e.push("<u class='menu-item-container'>"),e.push("<span class='submenu-item-text'>",g.resourceName,"</span>"),e.push("<a class='direct' href='",this._addMenuCodeToSrc(g.url,g.resourceCode),"'></a>"),e.push("</u>"),e.push("</li>");e.push("</ul></dd>")}this.menuList.html(e.join("")),a.setTask(function(){this._updateMenuSelectedStatus()}.bind(this))}},hasAnimation:function(){return!!this.option.animation},isModern:function(){return"modern"===this.option.style},isShow:function(){return!this.hasMenuButton||this.option.menuButton.hasClass(g)},defaultShow:function(){return!!this.option.defaultShow},isExtrusion:function(){return"extrusion"===this.option.extendMethod&&this.option.contentContainer&&this.option.contentContainer.length>0}})}(ui,ui.$),function(a,b){function c(b){b.rank=++d,a.page.plugin(b)}var d=10;a.page.getUrl=function(a){var b,c=this.contextUrl||"/";return a?(a=a.trim(),b=c.charAt(c.length-1),"/"!==b&&"\\"!==b||(c=c.substring(0,c.length-1)+"/"),b=a.charAt(0),"/"!==b&&"\\"!==b||(a=a.substring(1)),c+a):c},a.page.hasMenu=function(){return!!this.menu},c({name:"master",handler:function(c){function d(){var a,b;this.menu&&this.menu.disableResizeable||(a=document.documentElement.clientWidth,b=document.documentElement.clientHeight,this.head&&this.head.length>0?b-=this.head.height():this.head=null,this.foot&&this.foot.length>0?b-=this.foot.height():this.foot=null,this.body&&this.body.length>0?this.body.css("height",b+"px"):this.body=null,this.contentBodyHeight=b,this.contentBodyWidth=a,this.menu&&this.menu.isShow()&&this.menu.resize(this.contentBodyWidth,this.contentBodyHeight))}this.head=b("#head"),this.body=b("#body"),this.foot=b("#foot"),this.sidebarManager=a.SidebarManager(),d.call(this),a.page.resize(d.bind(this),a.eventPriority.bodyResize),a.core.isFunction(c)&&c.call(this)}}),c({name:"homeButton",handler:function(c){var d=b(".ui-home-button");0!==d.length&&a.core.isFunction(c)&&c.call(this,d)}}),c({name:"menu",handler:function(c){var d,e=this;a.core.isFunction(c)?this.menu=c.call(this):c&&(d=b(".ui-home-button"),d.empty(),this.menu=a.ctrls.Menu({style:"normal",menuPanel:b(".ui-menu-panel"),contentContainer:b(".content-container"),extendMethod:"cover",menuButton:d.length>0?d:null}),this.menu.shown(function(a){this.isExtrusion()&&(this.isModern()?e.contentBodyWidth-=this.menuWidth-this.menuNarrowWidth:e.contentBodyWidth-=this.menuWidth)}),this.menu.hidden(function(a){this.isExtrusion()&&(this.isModern()?e.contentBodyWidth+=this.menuWidth-this.menuNarrowWidth:e.contentBodyWidth+=this.menuWidth)}))}}),c({name:"userPanel",handler:function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p={name:"姓名",department:"部门",position:"职位",changeHighlightUrl:"",operateList:[{text:"个性化"},{text:"修改密码"},{text:"退出"}]};if(a.core.isFunction(c)&&(p=a.extend(p,c.call(this))),d=b("#user"),0!==d.length){if(o=this,e=b("<section class='user-settings' />"),f=b("<div class='user-info' />"),h=b("<div class='operate-list' />"),j=[],j.push("<div class='protrait-cover'>","<img class='protrait-img' src='",d.children("img").prop("src"),"' alt='用户头像' /></div>","<div class='user-info-panel'>","<span class='user-info-text' style='font-size:18px;line-height:36px;'>",a.str.htmlEncode(p.name),"</span><br />"),p.department&&j.push("<span class='user-info-text'>",a.str.htmlEncode(p.department),"</span><br />"),p.position&&j.push("<span class='user-info-text'>",a.str.htmlEncode(p.position),"</span>"),j.push("</div>","<br clear='left' />"),f.append(j.join("")),e.append(f),a.theme.currentHighlight||a.theme.initHighlight(),Array.isArray(a.theme.highlights)){for(g=b("<div class='highlight-panel' />"),j=[],
j.push("<h3 class='highlight-group-title font-highlight'>个性色</h3>"),j.push("<div style='width:100%;height:auto'>"),k=0,l=a.theme.highlights.length;k<l;k++)m=a.theme.highlights[k],j.push("<a class='highlight-item"),m.Id===a.theme.currentHighlight.Id&&j.push(" highlight-item-selected"),j.push("' href='javascript:void(0)' style='background-color:",m.Color,";"),j.push("' title='",m.Name,"' data-index='",k,"'>"),j.push("<i class='fa fa-check-circle highlight-item-checker'></i>"),j.push("</a>");j.push("</div>"),g.append(j.join("")),a.setTask(function(){o._currentHighlightItem=g.find(".highlight-item-selected"),0===o._currentHighlightItem.length&&(o._currentHighlightItem=null)}),g.on("click",function(c){var d,e;for(d=b(c.target);!d.hasClass("highlight-item");){if(d.hasClass("highlight-panel"))return;d=d.parent()}e=a.theme.highlights[parseInt(d.attr("data-index"),10)],o._currentHighlightItem&&o._currentHighlightItem.removeClass("highlight-item-selected"),o._currentHighlightItem=d,o._currentHighlightItem.addClass("highlight-item-selected"),a.core.isFunction(p.changeHighlightUrl)?p.changeHighlightUrl.call(null,e):p.changeHighlightUrl&&a.theme.changeHighlight(p.changeHighlightUrl,e)}),e.append(g),e.append("<hr class='horizontal' />")}j=[],p.operateList&&p.operateList.length>0&&(i={},j.push("<ul class='operate-list-ul'>"),p.operateList.forEach(function(b,c){b.text&&(j.push("<li class='operate-list-li theme-panel-hover'>","<span class='operate-text'>",a.str.htmlEncode(b.text),"</span>","<a class='operate-list-anchor' href='javascript:void(0)' data-index='",c,"'></a>","</li>"),a.core.isFunction(b.handler)?i[c]=b.handler:a.core.isString(b.handler)&&(i[c]=function(){location.href=b.handler}))}),j.push("</ul>"),h.on("click",function(c){var d,e,f=b(c.target);f.hasClass("operate-list-anchor")&&(d=f.attr("data-index"),e=i[d],a.core.isFunction(e)&&e())})),h.append(j.join("")),e.append(h),n=this.sidebarManager.setElement("userSidebar",{parent:"body",width:240},e),n._closeButton.attr("style","color:#fff !important;width:32px;height:32px;"),e.before("<div class='user-settings-background title-color' />"),n.animator[0].ease=a.AnimationStyle.easeFromTo,n.contentAnimator=a.animator({target:e,begin:100,end:0,ease:a.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"%")}}),n.contentAnimator.duration=200,n.showing(function(){e.css("display","none")}),n.shown(function(){e.css({display:"block",left:"100%"}),this.contentAnimator.start()}),d.on("click",function(a){o.sidebarManager.show("userSidebar")})}}}),c({name:"toolbar",handler:function(b){var c,d=!1;if(a.core.isFunction(b))return void(this.toolbar=b.call(this));if(a.core.isString(b)||a.core.isDomObject(b))c=b;else{if(!a.core.isPlainObject(b))return;c=b.id,d=!!b.extendShow}this.toolbar=a.Toolbar({toolbarId:c,defaultExtendShow:d})}})}(ui,ui.$),function(a,b){function c(){if(!(this instanceof c))return new c;this.initialize()}c.prototype={constructor:c,initialize:function(){return this.sidebars=new a.KeyArray,this},setElement:function(b,c,d){var e=null,f=this;if(!a.str.isEmpty(b)){if(this.sidebars.containsKey(b))e=this.sidebars.get(b),d&&e.set(d);else{if(!c||!c.parent)throw new Error("option is null");e=a.ctrls.SidebarBase(c,d),e.hiding(function(a){f.currentBar=null}),this.sidebars.set(b,e)}return e}},get:function(b){return a.str.isEmpty(b)?null:this.sidebars.containsKey(b)?this.sidebars.get(b):null},remove:function(b){a.str.isEmpty(b)||this.sidebars.containsKey(b)&&this.sidebars.remove(b)},isShow:function(){return this.currentBar&&this.currentBar.isShow()},show:function(b){if(!a.str.isEmpty(b)){var c=null,d=this;return this.sidebars.containsKey(b)?(c=this.sidebars.get(b),c.isShow()?null:this.currentBar?this.currentBar.hide().then(function(){d.currentBar=c,c.show()}):(this.currentBar=c,c.show())):null}},hide:function(){var b=this.currentBar;return a.str.isEmpty(name)?b=this.currentBar:this.sidebars.containsKey(name)&&(b=this.sidebars.get(name)),b.isShow()&&b?(this.currentBar=null,b.hide()):null}},a.SidebarManager=c}(ui,ui.$),function(a,b){function c(a,b){if(!(this instanceof c))return new c(a,b);this.initialize(a,b)}function d(a,b){if(!(this instanceof d))return new d(a,b);this.initialize(a,b)}function e(a){if(!(this instanceof e))return new e(a);this.initialize(a)}var f,g={small:{width:62,height:62,iconSize:32,countX:1,countY:1},medium:{width:128,height:128,iconSize:64,countX:2,countY:2},wide:{width:260,height:128,iconSize:64,countX:4,countY:2},large:{width:260,height:260,iconSize:64,countX:4,countY:4}},h=a.ctrls.ControlBase.prototype.defineProperty,i=["name","title","icon","link","color"];f={rotate:{render:function(){this.tileInnerBack=b("<div class='tile-inner' style='display:none'>"),this.tileInnerBack.css("background-color",this.color),this.updatePanel=b("<div class='update-panel' />"),this.tileInnerBack.append(this.updatePanel).append(function(){var a=b("<div class='tile-title' />"),c=b("<span class='tile-title-text' />");return c.text(this.title),a.append(c),a}.call(this)),this.smallIconImg=b("<img class='tile-small-icon' />"),this.smallIconImg.prop("src",this.icon),this.tileInnerBack.append(this.smallIconImg),this.tilePanel.append(this.tileInnerBack),this.updateStyle._createAnimator.call(this)},_createAnimator:function(){var b,c;c=2*this.width,b=function(a){var b={},d="perspective("+c+"px) rotateX("+a+"deg)";return["-ms-","-moz-","-webkit-","-o-",""].forEach(function(a){b[a+"transform"]=d}),b},this.animator=a.animator({ease:a.AnimationStyle.easeFrom,begin:0,end:-90,duration:500,onChange:function(a){this.target.css(b(a))}}).add({ease:function(a){return(a-=1)*a*(4*a+3)+1},begin:90,end:0,delay:500,duration:500,onChange:function(a){var c=b(a);c.display="block",this.target.css(c)}}),this.animator.onEnd=function(){this[0].target.css("display","none")}},_play:function(){var a=this;this.link&&this.link.css("display","none"),this.animator.start().then(function(){var b;b=a.tileInnerBack,a.tileInnerBack=a.tileInner,a.tileInner=b,a.link&&a.link.css("display","block")})},update:function(a){var b;a&&this.updatePanel.html(a),this.isDynamicChanged||(b=this.animator[0],b.target=this.tileInner,b.begin=0,b.end=-90,b=this.animator[1],b.target=this.tileInnerBack,b.begin=90,b.end=0,this.updateStyle._play.call(this))},restore:function(){var a;this.isDynamicChanged&&(a=this.animator[0],a.target=this.tileInner,a.begin=0,a.end=90,a=this.animator[1],a.target=this.tileInnerBack,a.begin=-90,a.end=0,this.updateStyle._play.call(this))}},moveup:{render:function(){this.updatePanel=b("<div class='update-panel' />"),this.updatePanel.css("top","100%"),this.contentPanel.append(this.updatePanel),this.smallIconImg=b("<img class='tile-small-icon' />"),this.smallIconImg.prop("src",this.icon),this.animator=a.animator({target:this.contentPanel,ease:a.AnimationStyle.easeFromTo,duration:800,begin:0,end:this.height,onChange:function(a){this.target.scrollTop(a)}})},update:function(a){var b;a&&this.updatePanel.html(a).append(this.smallIconImg),this.isDynamicChanged||(this.animator.stop(),b=this.animator[0],b.begin=0,this.animator.start())},restore:function(){var a;this.isDynamicChanged&&(this.animator.stop(),a=this.animator[0],0!==a.target.scrollTop()&&(a.begin=a.target.scrollTop(),a.end=0,this.animator.start()))}}},c.prototype={constructor:c,initialize:function(b,c){var d,e;if(this.type=(b.type+"").toLowerCase(),!(d=g[this.type]))throw new TypeError("Invalid tile type: "+this.type);this.group=c,this.isDynamic=!1,this.isActivated=!1,this.isDynamicChanged=!1,this.width=d.width,this.height=d.height,this.iconSize=d.iconSize,this.countX=d.countX,this.countY=d.countY,this.locationX=0,this.locationY=0,this.tileInfo=b||{},e=this,i.forEach(function(c){var d,f,g;b.hasOwnProperty(c)&&(d=function(){return e.tileInfo[c]},g="_set"+c.charAt(0).toUpperCase()+c.substring(1),a.core.isFunction(e[g])&&(f=function(a){e.tileInfo[c]=a,e[g](a)}),h.call(e,c,d,f))}),"moveup"===this.tileInfo.updateStyle?this.updateStyle=f.moveup:this.updateStyle=f.rotate,this.updateFn=a.core.isFunction(this.tileInfo.updateFn)?this.tileInfo.updateFn:null,this.updateFn&&(this.isDynamic=!0,this.interval=a.core.isNumber(this.tileInfo.interval)?this.tileInfo.interval:60,this.interval<=0&&(this.interval=60)),this._render()},_render:function(){this.tilePanel=b("<div class='ui-tile tile-"+this.type+"' />"),this.tileInner=b("<div class='tile-inner' />"),this._setColor(this.color),this.tilePanel.append(this.tileInner),this.iconImg=b("<img class='tile-icon' />"),this.iconImg.prop("src",this.icon),this.iconImg.css({width:this.iconSize+"px",height:this.iconSize+"px",left:(this.width-this.iconSize)/2+"px",top:(this.height-this.iconSize)/2+"px"}),this.smallIconImg=null,"small"!==this.type?(this.contentPanel=b("<div class='tile-content' />"),this.contentPanel.append(this.iconImg),this.titlePanel=b("<div class='tile-title' />"),this._setTitle(this.title),this.tileInner.append(this.contentPanel).append(this.titlePanel),this.isDynamic&&this.updateStyle.render.call(this)):this.tileInner.append(this.iconImg),this.linkAnchor=null,a.core.isString(this.link)&&this.link.length>0&&(this.linkAnchor=b("<a class='tile-link "+this.type+"' />"),this.linkAnchor.prop("href",this.link),this.tilePanel.append(this.linkAnchor))},_setColor:function(a){a&&a.length>0&&this.tileInner.css("background-color",a)},_setTitle:function(a){this.titlePanel&&this.titlePanel.html("<span class='tile-title-text'>"+a+"</span>")},update:function(b){var c,d,e;if(a.core.isString(b))c=["<p class='update-inner'><span>",b,"</span></p>"],c=c.join("");else if(Array.isArray(b)){for(c=[],c.push("<p class='update-inner'>"),d=0,e=b.length;d<e;d++)c.push("<span>",b[d],"</span>"),e<e-1&&c.push("<br />");c.push("</p>"),c=c.join("")}else a.core.isFunction(b)&&(c=b.call(this));this.isActivated=!1,this.animator.isStarted||(this.updateStyle.update.call(this,c),this.isDynamicChanged=!0)},restore:function(){this.animator.isStarted||(this.updateStyle.restore.call(this),this.isDynamicChanged=!1)},activate:function(a){this.isActivated=!0,this.activeTime=(new Date).getTime()+1e3*this.interval,!1!==a&&this.group.container.activateDynamicTile(this)}},d.prototype={constructor:d,initialize:function(b,d){var e=[],f=this;this.container=d,b.forEach(function(a){var b=new c(a,f);b.isDynamic&&f.container.putDynamicTile(b),e.push(b)}),a.ArrayLike.prototype.setArray.call(this,e),this.titleHeight=48,this._render()},_render:function(){var a,c;for(this.groupPanel=b("<div class='ui-tile-group' />"),this.groupPanel.css("visibility","hidden"),this.groupTitle=b("<div class='ui-tile-group-title' />"),this.groupContent=b("<div class='ui-tile-group-content' />"),this.groupPanel.append(this.groupTitle).append(this.groupContent),a=0,c=this.length;a<c;a++)this.groupContent.append(this[a].tilePanel)},_calculatePosition:function(a,b,c,d,e){var f,h,i,j,k,l,m,n,o,p;for(i=c.x,j=c.y;;){for(h=0;h<e;h++)b[j+h]||(b[j+h]=new Array(a*g.medium.countX));for(o=i,p=j,m=j,n=j+e;m<n;m++){for(f=b[m];;){if(k=i,(l=i+d)>f.length||k>=f.length){o=-1;break}for(;k<l;k++)if(f[k]){i=k+1,o=-1;break}if(-1!==o)break;o=i}if(-1===o)break}if(-1!==o&&-1!==p){for(c.x=o,c.y=p,m=p,n=p+e;m<n;m++)for(f=b[m],k=o,l=o+d;k<l;k++)f[k]=!0;return}i=0,j+=2}},arrange:function(b){var c,d,e,f,h,i,j,k,l,m;if(!a.core.isNumber(b)||b<=0)throw new TypeError("the arguments size: "+b+" is invalid.");for(e=g.medium,k=[],l={x:0,y:0},c=0,d=this.length;c<d;)if(m=this[c],m.countX<=e.countX&&m.countY<=e.countY?this._calculatePosition(b,k,l,e.countX,e.countY):this._calculatePosition(b,k,l,m.countX,m.countY),"small"===m.type){for(f=g.medium.countX*g.medium.countY,h=l.x,i=l.y,j=1;j<=f&&(m=this[c])&&"small"===m.type;)m.tilePanel.css({top:i*(g.small.height+4)+"px",left:h*(g.small.width+4)+"px"}),j++,h%g.medium.countX==0?h=l.x+1:(h=l.x,i=l.y+Math.floor(j/g.medium.countX)),c++;l.x+=g.medium.countX}else m.tilePanel.css({top:l.y*(g.small.height+4)+"px",left:l.x*(g.small.width+4)+"px"}),l.x+=m.countX,c++;d=k[0].length,this.width=d*g.small.width+4*(d-1),d=k.length,this.height=d*g.small.height+4*(d-1),this.groupContent.css("height",this.height+"px"),this.height+=this.titleHeight,this.groupPanel.css({width:this.width+"px",height:this.height+"px"})},addTile:function(b){var d=new c(b);a.ArrayLike.prototype.push.call(this,d),this.container._registerLayoutTask()},removeTile:function(a){var b,d;if(a instanceof c){for(d=-1,b=this.length-1;b>=0;b--)if(this[b]===a){d=b;break}-1!==d&&this.removeAt(d)}},removeAt:function(b){if(!a.core.isNumber(b))throw new TypeError("the arguments index is not a number.");b<0||b>=this.length||(a.ArrayLike.prototype.splice.call(this,b,1),this.container._registerLayoutTask())}},e.prototype={constructor:e,initialize:function(c){this.groups=[],this.dynamicTiles=a.KeyArray(),this.dynamicTiles.activeCount=0,this.container=a.getJQueryElement(c),this.container?this.container.addClass("ui-tile-container"):this.container=b("<div class='ui-tile-container' />"),a.core.isTouchAvailable()&&this.container.css("-webkit-overflow-scrolling","touch"),this.containerWidth=this.container.width(),this.containerHeight=this.container.height(),this.tileMargin=b("<div class='tile-margin' />"),this.container.append(this.tileMargin)},_register:function(b){var c;this.dynamicTiles.activeCount<=0||this.dynamicDelayHandler||((!a.core.isNumber(b)||b<=0)&&(b=1e3),c=this,this.dynamicDelayHandler=setTimeout(function(){var b,d,e,f;if(f=(new Date).getTime(),c.dynamicDelayHandler=null,c.dynamicTiles.activeCount>0){for(b=0,d=c.dynamicTiles.length;b<d;b++)if(e=c.dynamicTiles[b],e.isActivated&&f>e.activeTime){e.isActivated=!1,c.dynamicTiles.activeCount--;try{e.updateFn.call(c,e)}catch(b){a.handleError(b)}}c.dynamicTiles.activeCount>0&&c._register()}},b))},_calculateGroupLayoutInfo:function(a,b){var c,d,e,f;return d=g.medium,c=4,f=c*d.width+4*(c-1),e=Math.floor((a-48)/(f+48)),e>1&&b>0&&(e=b<e?b:e),e<1?(c=Math.floor(a/(d.width+48)))<2&&(c=2):1===e&&(c+=Math.floor((a-48-f)/(d.width+48)))%2&&c--,{groupCount:e||1,groupSize:c}},_registerLayoutTask:function(){a.core.isNumber(this._layoutTaskHandler)||(this._layoutTaskHandler=a.setMicroTask(function(){this._layoutTaskHandler=null,this.layout(this.containerWidth,this.containerHeight)}.bind(this)))},layout:function(b,c){var d,e,f,g,h,i,j,k,l,m,n;if(!a.core.isNumber(b)||b<=0)throw new TypeError("the arguments containerWidth: "+b+" is invalid.");if(!a.core.isNumber(c)||c<=0)throw new TypeError("the arguments containerHeight: "+c+" is invalid.");if(0!==(j=this.groups.length)){for(this.containerWidth=b,this.containerHeight=c,d=this._calculateGroupLayoutInfo(b,j),f=[],l=0;l<j;)for(n=0,m=d.groupCount;n<m&&!(l>=j);n++)i=this.groups[l],i.arrange(d.groupSize),f[n]||(f[n]=0),f[n]+=i.height,l++;for(n=0,l=0,m=f.length;l<m;l++)n<f[l]&&(n=f[l]);for(f=n,f+=48,h=0,f>c&&(h=a.scrollbarWidth),e=this.groups[0].width*d.groupCount+48*(d.groupCount-1),g=(b-h-e)/2,k={},l=0;l<j;)for(k.left=g,n=0,m=d.groupCount;n<m&&!(l>=j);n++)i=this.groups[l],void 0===k[n]&&(k[n]=0),i.left=k.left,i.top=k[n],i.groupPanel.css({left:i.left+"px",top:i.top+"px",visibility:"visible"}),k.left+=i.width+48,k[n]+=i.height,l++;this.tileMargin.css("top",f+"px")}},addGroup:function(a,b){var c;Array.isArray(a)&&(b=a,a=null),Array.isArray(b)&&0!==b.length&&(c=new d(b,this),a&&c.groupTitle.html("<span>"+a+"</span>"),this.groups.push(c),this.container.append(c.groupPanel))},putDynamicTile:function(a){var b;if(!(b=a.name))throw new TypeError("tileName can not be null");if(this.dynamicTiles.hasOwnProperty(b))throw new TypeError("The dynamicTile is exist which name is '"+b+"'");this.dynamicTiles.set(b,a),a.activate()},getDynamicTileByName:function(a){return this.dynamicTiles.get(a+"")||null},activateDynamicTile:function(a){this.dynamicTiles.activeCount++,this._register()}},a.TileContainer=e}(ui,ui.$),function(a,b){function c(a){return a<10?"0"+a:""+a}function d(){var a;return a=new Date,{year:a.getFullYear(),month:c(a.getMonth()+1),day:a.getDate().toString(),week:"星期"+f.charAt(a.getDay())}}var e,f;a.tiles||(a.tiles={}),f="日一二三四五六",e={medium:function(a){var b,c;b=d(),c=[],c.push("<span class='day-text'>",b.day,"</span>"),c.push("<span class='week-text'>",b.week,"</span>"),c.push("<span class='year-month-text'>",b.year,".",b.month,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},wide:function(a){var b,c;b=d(),c=[],c.push("<span class='day-text'>",b.day,"</span>"),c.push("<span class='week-text'>",b.week,"</span>"),c.push("<span class='year-month-text'>",b.year,".",b.month,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},large:function(a){e.wide.apply(this,arguments)}},a.tiles.calendar=function(a){var b;e[a.type].apply(this,arguments),b=new Date,b=60*b.getHours()*60+60*b.getMinutes()+b.getSeconds(),a.interval=86400-b,a.activate()}}(ui,ui.$),function(a,b){function c(a){return a<10?"0"+a:""+a}function d(){var a;return a=new Date,{hour:c(a.getHours()),minute:c(a.getMinutes()),spliter:":"}}var e;a.tiles||(a.tiles={}),e={medium:function(a){var b,c;b=d(),c=[],c.push("<span class='clock-hour'>",b.hour,"</span>"),c.push("<span class='clock-minute'>",b.minute,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.updatePanel.css({"text-align":"center",height:a.height+"px"}),a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},wide:function(a){var b,c;b=d(),c=[],c.push("<span class='clock-hour'>",b.hour,"</span>"),c.push("<span class='clock-spliter'></span>"),c.push("<span class='clock-minute'>",b.minute,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.updatePanel.css({"text-align":"center","line-height":a.height-8+"px",height:a.height+"px"}),a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},large:function(a){e.wide.apply(this,arguments)}},a.tiles.clock=function(a){e[a.type].apply(this,arguments),a.activate()}}(ui,ui.$),function(a,b){function c(a){var c;c=a.pictureContext,c.currentImagePanel=b("<div class='tile-picture-container' />"),c.currentImage=b("<img class='tile-picture' />"),c.currentImagePanel.append(c.currentImage),c.nextImagePanel=b("<div class='tile-picture-container' />"),c.nextImagePanel.css("display","none"),c.nextImage=b("<img class='tile-picture' />"),c.nextImagePanel.append(c.nextImage),a.updatePanel.append(c.currentImagePanel).append(c.nextImagePanel)}function d(b){b.pictureContext.switchAnimator=a.animator({ease:a.AnimationStyle.easeTo,duration:500,begin:0,end:-b.height,onChange:function(a){this.target.css("top",a+"px")}}).add({ease:a.AnimationStyle.easeTo,duration:500,begin:b.height,end:0,onChange:function(a){this.target.css("top",a+"px")}})}function e(b,c,d){var f,g,i;g=b.pictureContext,0!==g.images.length&&(f=g.images[g.currentIndex],i=function(a){c.css(a),c.prop("src",f),d(b)},g.imageSizeCache.hasOwnProperty(f)?i(g.imageSizeCache[f]):g.imageLoader.load(f,b.width,b.height,a.ImageLoader.centerCrop).then(function(a){var b={width:a.displayWidth+"px",height:a.displayHeight+"px",top:a.marginTop+"px",left:a.marginLeft+"px"};g.imageSizeCache[f]=b,i(b)},function(){g.images.splice(index,1),g.images.length>0&&(h(b),e(b,c,d))}))}function f(a){var b=a.pictureContext;a.update(),setTimeout(function(){b.currentImage.addClass("tile-picture-play")},1e3),setTimeout(function(){b.images.length>1&&(h(a),e(a,b.nextImage,g))},1e4)}function g(a){var b,c,d;c=a.pictureContext,b=c.currentImagePanel,c.currentImagePanel=c.nextImagePanel,c.nextImagePanel=b,b=c.currentImage,c.currentImage=c.nextImage,c.nextImage=b,d=c.switchAnimator[0],d.target=c.nextImagePanel,d=c.switchAnimator[1],d.target=c.currentImagePanel,d.target.css({top:a.height+"px",display:"block"}),c.switchAnimator.start().then(function(){c.nextImagePanel.css("display","none"),c.nextImage.removeClass("tile-picture-play"),setTimeout(function(){c.currentImage.addClass("tile-picture-play"),setTimeout(function(){c.images.length>1&&(h(a),e(a,c.nextImage,g))},1e4)},500)})}function h(a){var b,c;b=a.pictureContext,c=b.currentIndex+1,c>=b.images.length&&(c=0),b.currentIndex=c}a.tiles||(a.tiles={}),a.tiles.picture=function(b,g){var h,i,j;if(Array.isArray(g)){for(j=[],h=0,i=g.length;h<i;h++)g[h]&&j.push(g[h]);0!==j.length&&(b.pictureContext={images:j,currentIndex:0,imageSizeCache:{},imageLoader:new a.ImageLoader},c(b),d(b),e(b,b.pictureContext.currentImage,f))}}}(ui,ui.$),function(a,b){function c(b){var c,d,e,f,g=null;if(Array.isArray(b))for(f=new Date,c=0,d=b.length;c<d;c++)e=b[c],e.date=a.date.parseJSON(e.date),e.date&&e.date.getFullYear()===f.getFullYear()&&e.date.getMonth()===f.getMonth()&&e.date.getDate()===f.getDate()&&(g=e);return g}function d(a){var b=a.getMonth()+1,c=a.getDate();return(b<10?"0"+b:b)+"/"+(c<10?"0"+c:c)}function e(a){var b,c,d=new Date;return d=new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0),a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),b=parseInt(a.getTime()/1e3/60/60/24-d.getTime()/1e3/60/60/24,10),c=function(a){return"周"+"日一二三四五六".charAt(a)},b<-1?c(a.getDay()):b<0?"昨天":b<1?"今天":b<2?"明天":c(a.getDay())}function f(a){return"晴朗"}function g(a){return{htmlBuilder:[],weatherData:a,weatherToday:c(a.days),graph:h,info:i,days:j,build:k}}function h(){var a=this.htmlBuilder;return a.push("<div class='weather-graph'>"),l.apply(this,arguments),a.push("</div>"),this}function i(){var a=this.htmlBuilder;return a.push("<div class='weather-info'>"),l.apply(this,arguments),a.push("</div>"),this}function j(){var b,c,g,h=this.htmlBuilder,i=this.weatherData;if(Array.isArray(i.days)){for(h.push("<ul class='weather-days'>"),c=0,g=i.days.length;c<g;c++)b=i.days[c],h.push("<li class='weather-day'",0===c?" style='height:150px'":"",">"),h.push("<div class='weather-item'",0===c?" style='opacity:1'":"",">"),this.graph(),this.weatherToday=b,this.info(m,n,o,p),h.push("</div>"),h.push("<div class='weather-handle",0===c?" weather-current-handle":"","'>"),h.push("<span class='weather-text'>",a.str.format("{0}&nbsp;({1})&nbsp;{2}&nbsp;&nbsp;{3}",d(b.date),e(b.date),a.str.format("{0}℃ - {1}℃",b.low,b.high),f(i.type)),"</span>"),h.push("</div>"),h.push("</li>");h.push("</ul>")}return this}function k(){return this.htmlBuilder.join("")}function l(){var b,c,d;for(d=this.weatherToday,b=0,c=arguments.length;b<c;b++)a.core.isFunction(arguments[b])&&arguments[b].call(this,d)}function m(a){var b=this.htmlBuilder,c=this.weatherData;b.push("<h6 class='weather-city'>",c.city,"</h6>")}function n(a){var b=this.htmlBuilder;b.push("<h3 class='weather-temperature'>"),a.temperature&&b.push("<span class='weather-curr-temp'>",a.temperature,"<span style='font-size:22px;'>℃</span>","</span>"),b.push("<span class='weather-low-high'>",a.low,"℃ / ",a.high,"℃","</span>"),b.push("</h3>")}function o(a){this.htmlBuilder.push("<h6 class='weather-description'>",a.description,"</h6>")}function p(a){this.htmlBuilder.push("<h6 class='weather-wind'>",a.windDirection,"</h6>")}function q(c){var d,e;d=c.weatherContext,d.changeDayAnimator=a.animator({ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("height",a+"px"),this.original.css("height",this.end-(a-this.begin)+"px")}}).add({ease:a.AnimationStyle.easeTo,onChange:function(a){this.target.css("opacity",a/100),this.original.css("opacity",(this.end-a)/100)}}),d.changeDayAnimator.duration=500,e=d.parent.children(".weather-days"),d.current=b(e.children()[0]),e.on("click",r.bind(c))}function r(a){var c,d,e,f,g,h,i;for(d=b(a.target);!d.hasClass("weather-handle");){if("LI"===(f=d.nodeName())||"UL"===f)return;d=d.parent()}c=this.weatherContext,d.parent()[0]!==c.current[0]&&(c.changeDayAnimator.isStarted||(g=c.current,e=g.children(".weather-item"),e.removeClass("active-dynamic"),g.children(".weather-handle").removeClass("weather-current-handle"),h=d.parent(),h.children(".weather-handle").addClass("weather-current-handle"),c.current=h,i=c.changeDayAnimator[0],i.original=g,i.target=h,i.begin=22,i.end=150,i=c.changeDayAnimator[1],i.original=e,i.target=h.children(".weather-item"),i.begin=0,i.end=100,e=c.current.children(".weather-item"),c.changeDayAnimator.start().then(function(){e.addClass("active-dynamic")})))}var s;a.tiles||(a.tiles={}),s={medium:function(a,b){var c;c=g(b).graph().info(n,o).build(),a.weatherContext.parent.html(c),a.update()},wide:function(a,b){var c;c=g(b).graph().info(m,n,o,p).build(),a.weatherContext.parent.html(c),a.update()},large:function(a,b){var c;c=g(b).days().build(),a.weatherContext.parent.html(c),setTimeout(function(){q(a)},1e3),a.update()}},a.tiles.weather=function(a,b){a.weatherContext={weatherData:b},"moveup"===a.tileInfo.updateStyle?(a.weatherContext.parent=a.updatePanel,a.smallIconImg.remove(),a.titlePanel.remove()):a.weatherContext.parent=a.tileInnerBack,s[a.type].apply(this,arguments)}}(ui,ui.$),function(a,b){function c(a){if(!(this instanceof c))return new c(a);this.initialize(a)}c.prototype={constructor:c,initialize:function(c){if(c||(c={}),this.toolbarPanel=a.getJQueryElement(c.toolbarId),this.toolbarPanel){this.height=this.toolbarPanel.height(),this.tools=this.toolbarPanel.children(".tools"),this.extendPanel=this.toolbarPanel.children(".toolbar-extend"),this.extendPanel.length>0&&(this.defaultExtendShow=!!c.defaultExtendShow,this._initExtendPanel());for(var d,e=0,f=this.tools.length;e<f;e++)d=b(this.tools[e]).children(".action-buttons"),d.length>0&&d.children(".tool-action-button").addClass("font-highlight-hover")}},_initExtendPanel:function(){this.extendHeight=parseFloat(this.extendPanel.css("height")),this._wrapExtendPanel(),this._createExtendAnimator(),this._initExtendButton(),this._initPinButton(),this.defaultExtendShow&&(this.showExtend(!1),this.pinExtend())},_wrapExtendPanel:function(){var a=this.toolbarPanel.css("position");"absolute"!==a&&"relative"!==a&&"fixed"!==a&&this.toolbarPanel.css("position","relative"),this.extendWrapPanel=b("<div style='position:absolute;height:0px;width:100%;display:none;overflow:hidden;'/>"),this.extendWrapPanel.css("top",this.height+"px"),this.extendPanel.css("top",-this.extendHeight+"px"),this.extendPanel.addClass("clear"),this.extendWrapPanel.append(this.extendPanel),this.toolbarPanel.append(this.extendWrapPanel)},_createExtendAnimator:function(){this.extendAnimator=a.animator({target:this.extendPanel,ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("top",a+"px")}}).add({target:this.extendWrapPanel,ease:a.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("height",a+"px")}}),this.extendAnimator.duration=300},_initExtendButton:function(){this.extendButton=this.toolbarPanel.find(".tool-extend-button");var a,c;0===this.extendButton.length&&(a=b("<ul class='tools' style='float:right;margin-left:0px;'></ul>"),c=b("<li class='tool-item action-buttons'></li>"),a.append(c),0===this.tools.length?this.extendPanel.parent().before(a):b(this.tools[0]).before(a),this.tools=this.toolbarPanel.children(".tools"),this.extendButton=b("<a class='tool-action-button tool-extend-button' href='javascript:void(0)' title='更多'><i class='far fa-ellipsis-h'></i></a>"),c.append(this.extendButton));var d=this;this.extendButton.on("click",function(a){d.isExtendShow()?d.hideExtend():d.showExtend()})},_initPinButton:function(){this.pinButton=b("<a class='tool-extend-pin-button font-highlight-hover' href='javascript:void(0)' title='固定扩展区域'><i class='far fa-thumbtack'></i></a>"),this.extendWrapPanel.append(this.pinButton);var a=this;this.pinButton.on("click",function(b){a.isExtendPin()?a.unpinExtend():a.pinExtend()})},isExtendShow:function(){return this.extendButton.hasClass("extend-show")},showExtend:function(a){var b;this.extendAnimator.isStarted||(this.extendButton.addClass("extend-show").removeClass("font-highlight-hover").addClass("background-highlight"),this._cssOverflow=this.toolbarPanel.css("overflow"),this.toolbarPanel.css("overflow","visible"),!1===a?(this.extendWrapPanel.css({height:this.extendHeight+"px",display:"block"}),this.extendPanel.css("top","0px")):(b=this.extendAnimator[0],b.begin=-this.extendHeight,b.end=0,b=this.extendAnimator[1],b.begin=0,b.end=this.extendHeight,b.target.css({height:"0px",display:"block"}),this.extendAnimator.start()))},hideExtend:function(a){var b,c;this.extendAnimator.isStarted||(this.extendButton.removeClass("extend-show").addClass("font-highlight-hover").removeClass("background-highlight"),!1===a?(this.extendWrapPanel.css({height:"0px",display:"none"}),this.extendPanel.css("top",-this.extendHeight+"px"),this.toolbarPanel.css("overflow",this._cssOverflow)):(c=this,b=this.extendAnimator[0],b.begin=0,b.end=-this.extendHeight,b=this.extendAnimator[1],b.begin=this.extendHeight,b.end=0,this.extendAnimator.start().then(function(){c.toolbarPanel.css("overflow",c._cssOverflow),b.target.css("display","none")})))},_fireResize:function(){a.page.fire("resize")},isExtendPin:function(){return this.pinButton.hasClass("extend-pin")},pinExtend:function(){this.pinButton.addClass("extend-pin"),this.pinButton.children("i").removeClass("fa-thumbtack").addClass("fa-angle-up"),this.extendButton.css("display","none"),this.height=this.height+this.extendHeight,this.toolbarPanel.css("height",this.height+"px"),this._fireResize()},unpinExtend:function(){this.pinButton.removeClass("extend-pin"),this.pinButton.children("i").removeClass("fa-angle-up").addClass("fa-thumbtack"),this.extendButton.css("display","inline-block"),this.height=this.height-this.extendHeight,this.toolbarPanel.css("height",this.height+"px"),this._fireResize(),this.hideExtend()}},a.Toolbar=c}(ui,ui.$),"function"==typeof define&&define.amd&&define("SOONUI",[],function(){return ui}),ui});